/**
 * Mars3D平台插件, Next版本新功能测试包  mars3d-next
 *
 * 版本信息：v3.5.0
 * 编译日期：2023-03-29 12:38:26
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：next测试插件 ，2023-03-18
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory((window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.mars3d));
})(this, (function (mars3d) { 
'use strict';var _0x3455a5=_0x1184;(function(_0x568bd0,_0x430604){var _0x53ca5c=_0x1184,_0x555e7f=_0x568bd0();while(!![]){try{var _0x3574b2=parseInt(_0x53ca5c(0x23b))/0x1+-parseInt(_0x53ca5c(0x28c))/0x2+parseInt(_0x53ca5c(0x1fc))/0x3*(-parseInt(_0x53ca5c(0x23a))/0x4)+-parseInt(_0x53ca5c(0x203))/0x5+-parseInt(_0x53ca5c(0x210))/0x6*(parseInt(_0x53ca5c(0x22d))/0x7)+parseInt(_0x53ca5c(0x213))/0x8*(parseInt(_0x53ca5c(0x228))/0x9)+parseInt(_0x53ca5c(0x252))/0xa;if(_0x3574b2===_0x430604)break;else _0x555e7f['push'](_0x555e7f['shift']());}catch(_0x3c55e6){_0x555e7f['push'](_0x555e7f['shift']());}}}(_0x3318,0x5a4cb));function _interopNamespace(_0x4b51b0){var _0x12de74=_0x1184;if(_0x4b51b0&&_0x4b51b0[_0x12de74(0x25a)])return _0x4b51b0;var _0xbacf58=Object['create'](null);return _0x4b51b0&&Object['keys'](_0x4b51b0)[_0x12de74(0x22f)](function(_0x4ba278){if(_0x4ba278!=='default'){var _0xe2d4c4=Object['getOwnPropertyDescriptor'](_0x4b51b0,_0x4ba278);Object['defineProperty'](_0xbacf58,_0x4ba278,_0xe2d4c4['get']?_0xe2d4c4:{'enumerable':!![],'get':function(){return _0x4b51b0[_0x4ba278];}});}}),_0xbacf58['default']=_0x4b51b0,_0xbacf58;}var mars3d__namespace=_interopNamespace(mars3d);function ownKeys(_0x2574ec,_0x3011a8){var _0x39bdc3=_0x1184,_0x2fa198=Object['keys'](_0x2574ec);if(Object['getOwnPropertySymbols']){var _0x3dcd28=Object['getOwnPropertySymbols'](_0x2574ec);_0x3011a8&&(_0x3dcd28=_0x3dcd28[_0x39bdc3(0x237)](function(_0x5d9f1e){var _0x3c16c2=_0x39bdc3;return Object[_0x3c16c2(0x26f)](_0x2574ec,_0x5d9f1e)[_0x3c16c2(0x21b)];})),_0x2fa198['push'][_0x39bdc3(0x26b)](_0x2fa198,_0x3dcd28);}return _0x2fa198;}function _objectSpread2(_0x15e6c1){var _0x3ad1d1=_0x1184;for(var _0x3dc061=0x1;_0x3dc061<arguments[_0x3ad1d1(0x221)];_0x3dc061++){var _0x5327fc=null!=arguments[_0x3dc061]?arguments[_0x3dc061]:{};_0x3dc061%0x2?ownKeys(Object(_0x5327fc),!0x0)['forEach'](function(_0x220040){_defineProperty(_0x15e6c1,_0x220040,_0x5327fc[_0x220040]);}):Object[_0x3ad1d1(0x219)]?Object['defineProperties'](_0x15e6c1,Object['getOwnPropertyDescriptors'](_0x5327fc)):ownKeys(Object(_0x5327fc))['forEach'](function(_0x3801ea){var _0x47e0c2=_0x3ad1d1;Object['defineProperty'](_0x15e6c1,_0x3801ea,Object[_0x47e0c2(0x26f)](_0x5327fc,_0x3801ea));});}return _0x15e6c1;}function _classCallCheck(_0xa2e411,_0x22a781){var _0x333a20=_0x1184;if(!(_0xa2e411 instanceof _0x22a781))throw new TypeError(_0x333a20(0x27d));}function _defineProperties(_0x571f40,_0x39fd86){var _0x29c6ac=_0x1184;for(var _0x4fa21a=0x0;_0x4fa21a<_0x39fd86['length'];_0x4fa21a++){var _0xffd459=_0x39fd86[_0x4fa21a];_0xffd459['enumerable']=_0xffd459['enumerable']||![],_0xffd459['configurable']=!![];if('value'in _0xffd459)_0xffd459[_0x29c6ac(0x1ff)]=!![];Object['defineProperty'](_0x571f40,_toPropertyKey(_0xffd459['key']),_0xffd459);}}function _createClass(_0xcf43ce,_0x3f0650,_0x4515cf){var _0x10c306=_0x1184;if(_0x3f0650)_defineProperties(_0xcf43ce[_0x10c306(0x282)],_0x3f0650);if(_0x4515cf)_defineProperties(_0xcf43ce,_0x4515cf);return Object['defineProperty'](_0xcf43ce,'prototype',{'writable':![]}),_0xcf43ce;}function _defineProperty(_0x403d84,_0x155739,_0x462973){return _0x155739=_toPropertyKey(_0x155739),_0x155739 in _0x403d84?Object['defineProperty'](_0x403d84,_0x155739,{'value':_0x462973,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x403d84[_0x155739]=_0x462973,_0x403d84;}function _inherits(_0x4029cd,_0x1cf4f3){var _0x171e62=_0x1184;if(typeof _0x1cf4f3!==_0x171e62(0x279)&&_0x1cf4f3!==null)throw new TypeError(_0x171e62(0x274));_0x4029cd['prototype']=Object['create'](_0x1cf4f3&&_0x1cf4f3['prototype'],{'constructor':{'value':_0x4029cd,'writable':!![],'configurable':!![]}}),Object['defineProperty'](_0x4029cd,_0x171e62(0x282),{'writable':![]});if(_0x1cf4f3)_setPrototypeOf(_0x4029cd,_0x1cf4f3);}function _getPrototypeOf(_0x1b226b){var _0x3bf07d=_0x1184;return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf'][_0x3bf07d(0x259)]():function _0x427fc6(_0x276b1d){var _0x246c74=_0x3bf07d;return _0x276b1d['__proto__']||Object[_0x246c74(0x257)](_0x276b1d);},_getPrototypeOf(_0x1b226b);}function _setPrototypeOf(_0x463bbb,_0x4ef425){var _0x1aa0a1=_0x1184;return _setPrototypeOf=Object['setPrototypeOf']?Object['setPrototypeOf'][_0x1aa0a1(0x259)]():function _0x380d43(_0x2002c4,_0x57d93e){return _0x2002c4['__proto__']=_0x57d93e,_0x2002c4;},_setPrototypeOf(_0x463bbb,_0x4ef425);}function _isNativeReflectConstruct(){if(typeof Reflect==='undefined'||!Reflect['construct'])return![];if(Reflect['construct']['sham'])return![];if(typeof Proxy==='function')return!![];try{return Boolean['prototype']['valueOf']['call'](Reflect['construct'](Boolean,[],function(){})),!![];}catch(_0x176c29){return![];}}function _assertThisInitialized(_0x31ca05){if(_0x31ca05===void 0x0)throw new ReferenceError('this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called');return _0x31ca05;}function _possibleConstructorReturn(_0x5df9ce,_0x207427){if(_0x207427&&(typeof _0x207427==='object'||typeof _0x207427==='function'))return _0x207427;else{if(_0x207427!==void 0x0)throw new TypeError('Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined');}return _assertThisInitialized(_0x5df9ce);}function _createSuper(_0x6e9cd5){var _0x16c106=_isNativeReflectConstruct();return function _0x4a7485(){var _0x2f7048=_0x1184,_0x4ea501=_getPrototypeOf(_0x6e9cd5),_0x25238d;if(_0x16c106){var _0x258e3b=_getPrototypeOf(this)['constructor'];_0x25238d=Reflect['construct'](_0x4ea501,arguments,_0x258e3b);}else _0x25238d=_0x4ea501[_0x2f7048(0x26b)](this,arguments);return _possibleConstructorReturn(this,_0x25238d);};}function _superPropBase(_0x4ce5a6,_0x107cb3){var _0x2a3b9f=_0x1184;while(!Object[_0x2a3b9f(0x282)]['hasOwnProperty']['call'](_0x4ce5a6,_0x107cb3)){_0x4ce5a6=_getPrototypeOf(_0x4ce5a6);if(_0x4ce5a6===null)break;}return _0x4ce5a6;}function _0x3318(){var _0x21ffef=['filter','Cartesian3','ymin','676408Vnpurk','324777irMNkq','addPositionsHeight','Cartesian4','_removedHook','set','UNSIGNED_BYTE','aspectRatio','style','shadowMaps','_visibleAreaColor','texture3D','viewer','defined','outerCone','push','_position','\x0a\x20\x20\x20\x20\x20\x20\x20\x20int\x20frustumVisibility','_light_type','_isPointVisibility','Cartographic','_hiddenAreaColor','longitude','update','16804990ZEcuhy','primitiveCollection','shadowMap','uniform\x20samplerCube\x20lightShadowMapCube','steps','getPrototypeOf','multiply','bind','__esModule','setView','colorsKey','WHITE','replace','yCut','@@toPrimitive\x20must\x20return\x20a\x20primitive\x20value.','shaderProgram','subtract','PixelFormat','lights','string','position','Camera','fromCache','getCesiumColor','contains','apply','boundingSphere','precision\x20highp\x20float;\x0aprecision\x20highp\x20sampler3D;\x0a\x0auniform\x20sampler3D\x20map;\x0auniform\x20float\x20threshold;\x0auniform\x20float\x20steps;\x0auniform\x20float\x20xCut;\x0auniform\x20float\x20yCut;\x0auniform\x20float\x20zCut;\x0auniform\x20vec4\x20colors[Mars3D_TotalColors];\x0auniform\x20float\x20colorsKey[Mars3D_TotalColors];\x0a\x0ain\x20vec3\x20vOrigin;\x0ain\x20vec3\x20vDirection;\x0a\x0avec2\x20hitBoxMars3D(vec3\x20orig,\x20vec3\x20dir)\x20{\x0a\x20\x20const\x20vec3\x20box_min\x20=\x20vec3(-0.5);\x0a\x20\x20const\x20vec3\x20box_max\x20=\x20vec3(0.5);\x0a\x20\x20vec3\x20inv_dir\x20=\x201.0\x20/\x20dir;\x0a\x20\x20vec3\x20tmin_tmp\x20=\x20(box_min\x20-\x20orig)\x20*\x20inv_dir;\x0a\x20\x20vec3\x20tmax_tmp\x20=\x20(box_max\x20-\x20orig)\x20*\x20inv_dir;\x0a\x20\x20vec3\x20tmin\x20=\x20min(tmin_tmp,\x20tmax_tmp);\x0a\x20\x20vec3\x20tmax\x20=\x20max(tmin_tmp,\x20tmax_tmp);\x0a\x20\x20float\x20t0\x20=\x20max(tmin.x,\x20max(tmin.y,\x20tmin.z));\x0a\x20\x20float\x20t1\x20=\x20min(tmax.x,\x20min(tmax.y,\x20tmax.z));\x0a\x20\x20return\x20vec2(t0,\x20t1);\x0a}\x0a\x0afloat\x20sampleMars3D(vec3\x20p)\x20{\x0a\x20\x20return\x20texture(map,\x20p).a;\x0a}\x0a\x0a//\x20获取颜色的方法\x0avec4\x20getColorMars3D(float\x20value)\x20{\x0a\x0a\x20\x20float\x20originalValue\x20=\x20value\x20*\x20255.0;\x0a\x0a\x20\x20vec4\x20color1\x20=\x20vec4(0.0);\x0a\x20\x20vec4\x20color2\x20=\x20vec4(0.0);\x0a\x20\x20float\x20key1\x20=\x200.0;\x0a\x20\x20float\x20key2\x20=\x200.0;\x0a\x0a\x20\x20//\x20计算当前值在哪一个区间\x0a\x20\x20for(int\x20i\x20=\x200;\x20i\x20<\x20Mars3D_TotalColors;\x20i++)\x20{\x0a\x20\x20\x20//\x20获取到最小的大于当前值的位置\x0a\x20\x20\x20\x20if(originalValue\x20<\x20colorsKey[i])\x20{\x0a\x20\x20\x20\x20\x20\x20//\x20如果是第一位，则无法插值\x0a\x20\x20\x20\x20\x20\x20if(i\x20==\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20break;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20key1\x20=\x20colorsKey[i\x20-\x201];\x0a\x20\x20\x20\x20\x20\x20key2\x20=\x20colorsKey[i];\x0a\x20\x20\x20\x20\x20\x20color1\x20=\x20colors[i\x20-\x201];\x0a\x20\x20\x20\x20\x20\x20color2\x20=\x20colors[i];\x0a\x20\x20\x20\x20\x20\x20break;\x0a\x20\x20\x20\x20}\x0a\x20\x20}\x0a\x0a\x20\x20//\x20确定两个颜色区间之间的混合程度\x0a\x20\x20float\x20mixValue\x20=\x20(originalValue\x20-\x20key1)\x20/\x20(key2\x20-\x20key1);\x0a\x0a\x20\x20//\x20计算当前颜色\x0a\x20\x20vec4\x20finalColor\x20=\x20mix(color1,\x20color2,\x20mixValue);\x0a\x0a\x20\x20return\x20finalColor;\x0a}\x0a\x0avec4\x20alphaBlendingMars3D(vec4\x20color1,\x20vec4\x20color2)\x20{\x0a\x20\x20float\x20a1\x20=\x20color1.a;\x0a\x20\x20float\x20a2\x20=\x20color2.a;\x0a\x20\x20float\x20a\x20=\x201.0\x20-\x20(1.0\x20-\x20a1)\x20*\x20(1.0\x20-\x20a2);\x0a\x0a\x20\x20float\x20R\x20=\x20(a1\x20*\x20color1.r\x20+\x20(1.0\x20-\x20a1)\x20*\x20a2\x20*\x20color2.r)\x20/\x20a;\x0a\x20\x20float\x20G\x20=\x20(a1\x20*\x20color1.g\x20+\x20(1.0\x20-\x20a1)\x20*\x20a2\x20*\x20color2.g)\x20/\x20a;\x0a\x20\x20float\x20B\x20=\x20(a1\x20*\x20color1.b\x20+\x20(1.0\x20-\x20a1)\x20*\x20a2\x20*\x20color2.b)\x20/\x20a;\x0a\x0a\x20\x20return\x20vec4(R,\x20G,\x20B,\x20a);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20//\x20初始化色带\x0a\x20\x20vec4\x20color\x20=\x20vec4(0.0);\x0a\x20\x20vec3\x20rayDir\x20=\x20normalize(vDirection);\x0a\x20\x20vec2\x20bounds\x20=\x20hitBoxMars3D(vOrigin,\x20rayDir);\x0a\x0a\x20\x20if(bounds.x\x20>\x20bounds.y)\x0a\x20\x20\x20\x20discard;\x0a\x0a\x20\x20bounds.x\x20=\x20max(bounds.x,\x200.0);\x0a\x20\x20vec3\x20p\x20=\x20vOrigin\x20+\x20bounds.x\x20*\x20rayDir;\x0a\x20\x20vec3\x20inc\x20=\x201.0\x20/\x20abs(rayDir);\x0a\x20\x20float\x20delta\x20=\x20min(inc.x,\x20min(inc.y,\x20inc.z));\x0a\x20\x20delta\x20/=\x20steps;\x0a\x0a\x20\x20for(float\x20t\x20=\x20bounds.x;\x20t\x20<\x20bounds.y;\x20t\x20+=\x20delta)\x20{\x0a\x20\x20\x20\x20if(p.x\x20>\x20xCut\x20&&\x20p.y\x20>\x20yCut\x20&&\x20p.z\x20<\x20zCut)\x20{\x0a\x20\x20\x20\x20\x20\x20float\x20value\x20=\x20sampleMars3D(p\x20+\x200.5);\x0a\x20\x20\x20\x20\x20\x20if(value\x20<\x20threshold)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20if(color.a\x20>=\x201.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20break;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20color\x20=\x20alphaBlendingMars3D(color,\x20getColorMars3D(value));\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20p\x20+=\x20rayDir\x20*\x20delta;\x0a\x20\x20}\x0a\x20\x20out_FragColor\x20=\x20color;\x0a}\x0a','_map','getOwnPropertyDescriptor','zCut','_textureSize','_color','call','Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function','terrainShadows','Math','Mars3D_LightNumValue','visibleAreaColor','function','hiddenAreaColor','add','_clearDraw','Cannot\x20call\x20a\x20class\x20as\x20a\x20function','graphic','replaceAll','_layer','getAddHeight','prototype','_shadowMap','BasePointPrimitive','eastNorthUpToFixedFrame','scene','PostProcessStage','Texture3','SphereOutlineGeometry','visibilitys','_drawCommands','507632GDpHBy','toRadians','PixelDatatype','PointUtil','_postProcessStage','ShaderProgram','targetPosition','_createShadowMap','ShadowMap','angle','GeometryInstance','uniformShader','threshold','northwest','_updateDraw','Matrix4','_visibility_type','show','lightShadowMapCube','concat','heights','fov','Mars3D_ShadowVisibilityShader','colors','vertexArray','context','createDrawCommand','12lusWOI','range','options','writable','_pointBias','postProcessStages','\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20inside\x20+=\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20if\x20(pointLightVisibility','2434760KBuHHQ','_updateSphereOutline','heading','_shadowMapTexture','GraphicUtil','values','frustum','_camera','fromDegrees','_mountedHook','far','depthBiasStep','_updatePositionsHook','70014yXXFLk','opacity','_primitiveBias','104368JbxzmO','innerCone','ZERO','_noDestroy','normalize','Util','getOwnPropertyDescriptors','color','enumerable','remove','register','default','fromRadians','_getDrawPointEntityClass','length','near','radius','DrawCommand','center','Color','spotLight','99rWDKBE','distance','pitch','_cameraSphere','Rectangle','217cGAMQK','uniform\x20sampler2D\x20lightShadowMap2D','forEach','xCut','latitude','next','roll','angle2','commandList','LightShadowMapsShader'];_0x3318=function(){return _0x21ffef;};return _0x3318();}function _get(){return typeof Reflect!=='undefined'&&Reflect['get']?_get=Reflect['get']['bind']():_get=function _0x4a045f(_0x2b9733,_0x724858,_0x240367){var _0x3b02d6=_0x1184,_0x3499f9=_superPropBase(_0x2b9733,_0x724858);if(!_0x3499f9)return;var _0x581d53=Object[_0x3b02d6(0x26f)](_0x3499f9,_0x724858);if(_0x581d53['get'])return _0x581d53['get']['call'](arguments['length']<0x3?_0x2b9733:_0x240367);return _0x581d53['value'];},_get['apply'](this,arguments);}function _toPrimitive(_0x3eccab,_0x35da80){var _0x1aabbd=_0x1184;if(typeof _0x3eccab!=='object'||_0x3eccab===null)return _0x3eccab;var _0x44b62b=_0x3eccab[Symbol['toPrimitive']];if(_0x44b62b!==undefined){var _0x5b72eb=_0x44b62b['call'](_0x3eccab,_0x35da80||_0x1aabbd(0x21e));if(typeof _0x5b72eb!=='object')return _0x5b72eb;throw new TypeError(_0x1aabbd(0x260));}return(_0x35da80===_0x1aabbd(0x265)?String:Number)(_0x3eccab);}function _toPropertyKey(_0x38b8e1){var _0x78cd17=_toPrimitive(_0x38b8e1,'string');return typeof _0x78cd17==='symbol'?_0x78cd17:String(_0x78cd17);}var MultipleLightShader='uniform\x20sampler2D\x20colorTexture;\x0auniform\x20sampler2D\x20depthTexture;\x0a\x0aconst\x20int\x20LightNum\x20=\x20Mars3D_LightNumValue;\x0auniform\x20vec4\x20lightPositionEC[LightNum];\x0auniform\x20float\x20intensity[LightNum];\x0auniform\x20vec3\x20lightColor[LightNum];\x0auniform\x20vec3\x20direction[LightNum];\x0auniform\x20float\x20outerConeCos[LightNum];\x0auniform\x20float\x20innerConeCos[LightNum];\x0auniform\x20mat4\x20shadowMapMatrix[LightNum];\x0auniform\x20vec4\x20shadowMapTexelSizeDepthBiasAndNormalShadingSmooth[LightNum];\x0auniform\x20vec2\x20shadowMapDarknessType[LightNum];\x0a\x0aMars3D_LightShadowMapsShader\x20in\x20vec2\x20v_textureCoordinates;\x0a\x0aconst\x20float\x20M_PI\x20=\x203.141592653589793;\x0a\x0avec3\x20getEyeCoordinate3FromWindowCoordinateMars3D(vec2\x20fragCoord,\x20float\x20logDepthOrDepth)\x20{\x0avec4\x20eyeCoordinate\x20=\x20czm_windowToEyeCoordinates(fragCoord,\x20logDepthOrDepth);\x0areturn\x20eyeCoordinate.xyz\x20/\x20eyeCoordinate.w;\x0a}\x0a\x0avec3\x20vectorFromOffsetMars3D(vec4\x20eyeCoordinate,\x20vec2\x20positiveOffset)\x20{\x0avec2\x20glFragCoordXY\x20=\x20v_textureCoordinates.xy\x20*\x20czm_viewport.zw;\x0afloat\x20upOrRightLogDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20(glFragCoordXY\x20+\x20positiveOffset)\x20/\x20czm_viewport.zw));\x0afloat\x20downOrLeftLogDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20(glFragCoordXY\x20-\x20positiveOffset)\x20/\x20czm_viewport.zw));\x0a\x0abvec2\x20upOrRightInBounds\x20=\x20lessThan(glFragCoordXY\x20+\x20positiveOffset,\x20czm_viewport.zw);\x0afloat\x20useUpOrRight\x20=\x20float(upOrRightLogDepth\x20>\x200.0\x20&&\x20upOrRightInBounds.x\x20&&\x20upOrRightInBounds.y);\x0afloat\x20useDownOrLeft\x20=\x20float(useUpOrRight\x20==\x200.0);\x0avec3\x20upOrRightEC\x20=\x20getEyeCoordinate3FromWindowCoordinateMars3D(glFragCoordXY\x20+\x20positiveOffset,\x20upOrRightLogDepth);\x0avec3\x20downOrLeftEC\x20=\x20getEyeCoordinate3FromWindowCoordinateMars3D(glFragCoordXY\x20-\x20positiveOffset,\x20downOrLeftLogDepth);\x0areturn\x20(upOrRightEC\x20-\x20(eyeCoordinate.xyz\x20/\x20eyeCoordinate.w))\x20*\x20useUpOrRight\x20+\x20((eyeCoordinate.xyz\x20/\x20eyeCoordinate.w)\x20-\x20downOrLeftEC)\x20*\x20useDownOrLeft;\x0a}\x0a\x0afloat\x20getRangeAttenuationMars3D(float\x20range,\x20float\x20d)\x20{\x0aif(range\x20<=\x200.0)\x20{\x0areturn\x201.0\x20/\x20pow(d,\x202.0);\x0a}\x0areturn\x20max(min(1.0\x20-\x20pow(d\x20/\x20range,\x204.0),\x201.0),\x200.0)\x20/\x20pow(d,\x202.0);\x0a}\x0a\x0afloat\x20getSpotAttenuationMars3D(vec3\x20pointToLight,\x20vec3\x20direction,\x20float\x20outerConeCos,\x20float\x20innerConeCos)\x20{\x0afloat\x20actualCos\x20=\x20dot(normalize(direction),\x20normalize(-\x20pointToLight));\x0aif(actualCos\x20>\x20outerConeCos)\x20{\x0aif(actualCos\x20<\x20innerConeCos)\x20{\x0areturn\x20smoothstep(outerConeCos,\x20innerConeCos,\x20actualCos);\x0a}\x0areturn\x201.0;\x0a}\x0areturn\x200.0;\x0a}\x0a\x0avec3\x20getLightIntensityMars3D(vec3\x20color,\x20float\x20intensity,\x20float\x20type,\x20float\x20range,\x20vec3\x20pointToLight,\x20vec3\x20direction,\x20float\x20outerConeCos,\x20float\x20innerConeCos)\x20{\x0afloat\x20rangeAttenuation\x20=\x201.0;\x0afloat\x20spotAttenuation\x20=\x201.0;\x0arangeAttenuation\x20=\x20getRangeAttenuationMars3D(range,\x20length(pointToLight));\x0aif(type\x20==\x202.0)\x20{\x0aspotAttenuation\x20=\x20getSpotAttenuationMars3D(pointToLight,\x20direction,\x20outerConeCos,\x20innerConeCos);\x0a}\x0areturn\x20rangeAttenuation\x20*\x20spotAttenuation\x20*\x20intensity\x20*\x20color;\x0a}\x0a\x0afloat\x20czm_private_shadowVisibility(float\x20visibility,\x20float\x20nDotL,\x20float\x20normalShadingSmooth,\x20float\x20darkness)\x20{\x0afloat\x20strength\x20=\x20clamp(nDotL\x20/\x20normalShadingSmooth,\x200.0,\x201.0);\x0avisibility\x20*=\x20strength;\x0avisibility\x20=\x20max(visibility,\x20darkness);\x0areturn\x20visibility;\x0a}\x0a\x0astruct\x20my_shadowParameters\x20{\x0avec3\x20texCoordsCube;\x0avec2\x20texCoords;\x0afloat\x20depthBias;\x0afloat\x20depth;\x0afloat\x20nDotL;\x0avec2\x20texelStepSize;\x0afloat\x20normalShadingSmooth;\x0afloat\x20darkness;\x0a};\x0a\x0afloat\x20shadowVisibilityCubeMars3D(samplerCube\x20shadowMap,\x20my_shadowParameters\x20shadowParameters)\x20{\x0afloat\x20depthBias\x20=\x20shadowParameters.depthBias;\x0afloat\x20depth\x20=\x20shadowParameters.depth;\x0afloat\x20nDotL\x20=\x20shadowParameters.nDotL;\x0afloat\x20normalShadingSmooth\x20=\x20shadowParameters.normalShadingSmooth;\x0afloat\x20darkness\x20=\x20shadowParameters.darkness;\x0avec3\x20uvw\x20=\x20shadowParameters.texCoordsCube;\x0a\x0adepth\x20-=\x20depthBias;\x0areturn\x20czm_shadowDepthCompare(shadowMap,\x20uvw,\x20depth);\x0a}\x0afloat\x20shadowVisibility2D(sampler2D\x20shadowMap,\x20my_shadowParameters\x20shadowParameters)\x20{\x0afloat\x20depthBias\x20=\x20shadowParameters.depthBias;\x0afloat\x20depth\x20=\x20shadowParameters.depth;\x0afloat\x20nDotL\x20=\x20shadowParameters.nDotL;\x0afloat\x20normalShadingSmooth\x20=\x20shadowParameters.normalShadingSmooth;\x0afloat\x20darkness\x20=\x20shadowParameters.darkness;\x0avec2\x20uv\x20=\x20shadowParameters.texCoords;\x0a\x0adepth\x20-=\x20depthBias;\x0areturn\x20czm_shadowDepthCompare(shadowMap,\x20uv,\x20depth);\x0a}\x0a\x0avec3\x20getPointLightTotalColorMars3D(vec3\x20normalEC,\x20vec3\x20positionEC,\x20int\x20i,\x20samplerCube\x20lightShadowMapCube)\x20{\x0avec4\x20lightPEC\x20=\x20lightPositionEC[i];\x0avec2\x20shadowMapDT\x20=\x20shadowMapDarknessType[i];\x0avec3\x20pointToLightEC\x20=\x20positionEC\x20-\x20lightPEC.xyz;\x0afloat\x20pointToLightECLength\x20=\x20length(pointToLightEC);\x0avec3\x20l\x20=\x20normalize(pointToLightEC);\x0afloat\x20NdotL\x20=\x20clamp(dot(-\x20normalEC,\x20l),\x200.0,\x201.0);\x0a\x0afloat\x20visibility\x20=\x200.0;\x0afloat\x20radius\x20=\x20lightPEC.w;\x0afloat\x20type\x20=\x20shadowMapDT.y;\x0a\x0aif(pointToLightECLength\x20<=\x20radius)\x20{\x0avec4\x20shadowMapTSDBANSS\x20=\x20shadowMapTexelSizeDepthBiasAndNormalShadingSmooth[i];\x0a\x0amy_shadowParameters\x20shadowParameters;\x0ashadowParameters.texelStepSize\x20=\x20shadowMapTSDBANSS.xy;\x0ashadowParameters.depthBias\x20=\x20shadowMapTSDBANSS.z;\x0ashadowParameters.normalShadingSmooth\x20=\x20shadowMapTSDBANSS.w;\x0ashadowParameters.darkness\x20=\x20shadowMapDT.x;\x0ashadowParameters.depth\x20=\x20pointToLightECLength\x20/\x20radius;\x0ashadowParameters.nDotL\x20=\x20NdotL;\x0ashadowParameters.texCoordsCube\x20=\x20czm_inverseViewRotation\x20*\x20l;\x0avisibility\x20=\x20shadowVisibilityCubeMars3D(lightShadowMapCube,\x20shadowParameters);\x0a}\x0a\x0aif(visibility\x20==\x201.0)\x20{\x0avec3\x20colorIntensity\x20=\x20getLightIntensityMars3D(lightColor[i],\x20intensity[i],\x20type,\x20lightPEC.w,\x20pointToLightEC,\x20direction[i],\x20outerConeCos[i],\x20innerConeCos[i]);\x0areturn\x20NdotL\x20*\x20colorIntensity;\x0a}\x0areturn\x20vec3(0.0);\x0a}\x0a\x0avec3\x20getSpotLightTotalColorMars3D(vec3\x20normalEC,\x20vec3\x20positionEC,\x20int\x20i,\x20sampler2D\x20lightShadowMap2D)\x20{\x0avec4\x20lightPEC\x20=\x20lightPositionEC[i];\x0avec2\x20shadowMapDT\x20=\x20shadowMapDarknessType[i];\x0avec3\x20pointToLightEC\x20=\x20positionEC\x20-\x20lightPEC.xyz;\x0avec3\x20l\x20=\x20normalize(pointToLightEC);\x0afloat\x20NdotL\x20=\x20clamp(dot(-\x20normalEC,\x20l),\x200.0,\x201.0);\x0a\x0afloat\x20visibility\x20=\x200.0;\x0afloat\x20type\x20=\x20shadowMapDT.y;\x0a\x0avec4\x20shadowPosition\x20=\x20shadowMapMatrix[i]\x20*\x20vec4(positionEC,\x201.0);\x0ashadowPosition\x20/=\x20shadowPosition.w;\x0aif(!\x20(any(lessThan(shadowPosition.xyz,\x20vec3(0.0)))\x20||\x20any(greaterThan(shadowPosition.xyz,\x20vec3(1.0)))))\x20{\x0avec4\x20shadowMapTSDBANSS\x20=\x20shadowMapTexelSizeDepthBiasAndNormalShadingSmooth[i];\x0amy_shadowParameters\x20shadowParameters;\x0ashadowParameters.texelStepSize\x20=\x20shadowMapTSDBANSS.xy;\x0ashadowParameters.depthBias\x20=\x20shadowMapTSDBANSS.z;\x0ashadowParameters.normalShadingSmooth\x20=\x20shadowMapTSDBANSS.w;\x0ashadowParameters.darkness\x20=\x20shadowMapDT.x;\x0ashadowParameters.texCoords\x20=\x20shadowPosition.xy;\x0ashadowParameters.depth\x20=\x20shadowPosition.z;\x0ashadowParameters.nDotL\x20=\x20NdotL;\x0avisibility\x20=\x20shadowVisibility2D(lightShadowMap2D,\x20shadowParameters);\x0a}\x0a\x0aif(visibility\x20==\x201.0)\x20{\x0avec3\x20colorIntensity\x20=\x20getLightIntensityMars3D(lightColor[i],\x20intensity[i],\x20type,\x20lightPEC.w,\x20pointToLightEC,\x20direction[i],\x20outerConeCos[i],\x20innerConeCos[i]);\x0areturn\x20NdotL\x20*\x20colorIntensity;\x0a}\x0areturn\x20vec3(0.0);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20color\x20=\x20texture(colorTexture,\x20v_textureCoordinates);\x0a\x20\x20float\x20logDepthOrDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20v_textureCoordinates));\x0a\x20\x20if(logDepthOrDepth\x20>=\x201.0)\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20color;\x0a\x20\x20\x20\x20return;\x0a\x20\x20}\x0a\x0a\x20\x20vec4\x20eyeCoordinate\x20=\x20czm_windowToEyeCoordinates(v_textureCoordinates.xy\x20*\x20czm_viewport.zw,\x20logDepthOrDepth);\x0a\x20\x20vec3\x20downUp\x20=\x20vectorFromOffsetMars3D(eyeCoordinate,\x20vec2(0.0,\x201.0));\x0a\x20\x20vec3\x20leftRight\x20=\x20vectorFromOffsetMars3D(eyeCoordinate,\x20vec2(1.0,\x200.0));\x0a\x20\x20vec3\x20normalEC\x20=\x20normalize(cross(leftRight,\x20downUp));\x0a\x20\x20vec3\x20positionEC\x20=\x20eyeCoordinate.xyz\x20/\x20eyeCoordinate.w;\x0a\x0a\x20\x20vec3\x20totalColor\x20=\x20vec3(0.0);\x0a\x0a\x20\x20Mars3D_ShadowVisibilityShader\x20out_FragColor\x20=\x20vec4(color.xyz\x20+\x20totalColor,\x201.0);\x0a}\x0a',MultipleLightNoShadowShader='uniform\x20sampler2D\x20colorTexture;\x0auniform\x20sampler2D\x20depthTexture;\x0a\x0aconst\x20int\x20LightNum\x20=\x20Mars3D_LightNumValue;\x0auniform\x20vec4\x20lightPositionEC[LightNum];\x0auniform\x20float\x20intensity[LightNum];\x0auniform\x20vec3\x20lightColor[LightNum];\x0auniform\x20vec3\x20direction[LightNum];\x0auniform\x20float\x20outerConeCos[LightNum];\x0auniform\x20float\x20innerConeCos[LightNum];\x0auniform\x20vec2\x20shadowMapDarknessType[LightNum];\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0aconst\x20float\x20M_PI\x20=\x203.141592653589793;\x0a\x0avec3\x20getEyeCoordinate3FromWindowCoordinateMars3D(vec2\x20fragCoord,\x20float\x20logDepthOrDepth)\x20{\x0a\x20\x20vec4\x20eyeCoordinate\x20=\x20czm_windowToEyeCoordinates(fragCoord,\x20logDepthOrDepth);\x0a\x20\x20return\x20eyeCoordinate.xyz\x20/\x20eyeCoordinate.w;\x0a}\x0a\x0avec3\x20vectorFromOffsetMars3D(vec4\x20eyeCoordinate,\x20vec2\x20positiveOffset)\x20{\x0a\x20\x20vec2\x20glFragCoordXY\x20=\x20v_textureCoordinates.xy\x20*\x20czm_viewport.zw;\x0a\x20\x20float\x20upOrRightLogDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20(glFragCoordXY\x20+\x20positiveOffset)\x20/\x20czm_viewport.zw));\x0a\x20\x20float\x20downOrLeftLogDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20(glFragCoordXY\x20-\x20positiveOffset)\x20/\x20czm_viewport.zw));\x0a\x0a\x20\x20bvec2\x20upOrRightInBounds\x20=\x20lessThan(glFragCoordXY\x20+\x20positiveOffset,\x20czm_viewport.zw);\x0a\x20\x20float\x20useUpOrRight\x20=\x20float(upOrRightLogDepth\x20>\x200.0\x20&&\x20upOrRightInBounds.x\x20&&\x20upOrRightInBounds.y);\x0a\x20\x20float\x20useDownOrLeft\x20=\x20float(useUpOrRight\x20==\x200.0);\x0a\x20\x20vec3\x20upOrRightEC\x20=\x20getEyeCoordinate3FromWindowCoordinateMars3D(glFragCoordXY\x20+\x20positiveOffset,\x20upOrRightLogDepth);\x0a\x20\x20vec3\x20downOrLeftEC\x20=\x20getEyeCoordinate3FromWindowCoordinateMars3D(glFragCoordXY\x20-\x20positiveOffset,\x20downOrLeftLogDepth);\x0a\x20\x20return\x20(upOrRightEC\x20-\x20(eyeCoordinate.xyz\x20/\x20eyeCoordinate.w))\x20*\x20useUpOrRight\x20+\x20((eyeCoordinate.xyz\x20/\x20eyeCoordinate.w)\x20-\x20downOrLeftEC)\x20*\x20useDownOrLeft;\x0a}\x0a\x0afloat\x20getRangeAttenuationMars3D(float\x20range,\x20float\x20d)\x20{\x0a\x20\x20if(range\x20<=\x200.0)\x20{\x0a\x20\x20\x20\x20return\x201.0\x20/\x20pow(d,\x202.0);\x0a\x20\x20}\x0a\x20\x20return\x20max(min(1.0\x20-\x20pow(d\x20/\x20range,\x204.0),\x201.0),\x200.0)\x20/\x20pow(d,\x202.0);\x0a}\x0a\x0afloat\x20getSpotAttenuationMars3D(vec3\x20pointToLight,\x20vec3\x20direction,\x20float\x20outerConeCos,\x20float\x20innerConeCos)\x20{\x0a\x20\x20float\x20actualCos\x20=\x20dot(normalize(direction),\x20normalize(-pointToLight));\x0a\x20\x20if(actualCos\x20>\x20outerConeCos)\x20{\x0a\x20\x20\x20\x20if(actualCos\x20<\x20innerConeCos)\x20{\x0a\x20\x20\x20\x20\x20\x20return\x20smoothstep(outerConeCos,\x20innerConeCos,\x20actualCos);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20return\x201.0;\x0a\x20\x20}\x0a\x20\x20return\x200.0;\x0a}\x0a\x0avec3\x20getLightIntensityMars3D(vec3\x20color,\x20float\x20intensity,\x20float\x20type,\x20float\x20range,\x20vec3\x20pointToLight,\x20vec3\x20direction,\x20float\x20outerConeCos,\x20float\x20innerConeCos)\x20{\x0a\x20\x20float\x20rangeAttenuation\x20=\x201.0;\x0a\x20\x20float\x20spotAttenuation\x20=\x201.0;\x0a\x20\x20rangeAttenuation\x20=\x20getRangeAttenuationMars3D(range,\x20length(pointToLight));\x0a\x20\x20if(type\x20==\x202.0)\x20{\x0a\x20\x20\x20\x20spotAttenuation\x20=\x20getSpotAttenuationMars3D(pointToLight,\x20direction,\x20outerConeCos,\x20innerConeCos);\x0a\x20\x20}\x0a\x20\x20return\x20rangeAttenuation\x20*\x20spotAttenuation\x20*\x20intensity\x20*\x20color;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20color\x20=\x20texture(colorTexture,\x20v_textureCoordinates);\x0a\x20\x20float\x20logDepthOrDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20v_textureCoordinates));\x0a\x20\x20if(logDepthOrDepth\x20>=\x201.0)\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20color;\x0a\x20\x20\x20\x20return;\x0a\x20\x20}\x0a\x0a\x20\x20vec4\x20eyeCoordinate\x20=\x20czm_windowToEyeCoordinates(v_textureCoordinates.xy\x20*\x20czm_viewport.zw,\x20logDepthOrDepth);\x0a\x20\x20vec3\x20downUp\x20=\x20vectorFromOffsetMars3D(eyeCoordinate,\x20vec2(0.0,\x201.0));\x0a\x20\x20vec3\x20leftRight\x20=\x20vectorFromOffsetMars3D(eyeCoordinate,\x20vec2(1.0,\x200.0));\x0a\x20\x20vec3\x20normalEC\x20=\x20normalize(cross(leftRight,\x20downUp));\x0a\x20\x20vec3\x20positionEC\x20=\x20eyeCoordinate.xyz\x20/\x20eyeCoordinate.w;\x0a\x0a\x20\x20vec3\x20totalColor\x20=\x20vec3(0.0);\x0a\x0a\x20\x20for(int\x20i\x20=\x200;\x20i\x20<\x2010000;\x20i++)\x20{\x0a\x20\x20\x20\x20if(i\x20>=\x20LightNum)\x0a\x20\x20\x20\x20\x20\x20break;\x0a\x20\x20\x20\x20vec4\x20lightPEC\x20=\x20lightPositionEC[i];\x0a\x20\x20\x20\x20vec2\x20shadowMapDT\x20=\x20shadowMapDarknessType[i];\x0a\x0a\x20\x20\x20\x20vec3\x20pointToLightEC\x20=\x20positionEC\x20-\x20lightPEC.xyz;\x0a\x20\x20\x20\x20float\x20pointToLightECLength\x20=\x20length(pointToLightEC);\x0a\x20\x20\x20\x20vec3\x20l\x20=\x20normalize(pointToLightEC);\x0a\x20\x20\x20\x20float\x20NdotL\x20=\x20clamp(dot(-normalEC,\x20l),\x200.0,\x201.0);\x0a\x0a\x20\x20\x20\x20float\x20type\x20=\x20shadowMapDT.y;\x0a\x20\x20\x20\x20vec3\x20colorIntensity\x20=\x20getLightIntensityMars3D(lightColor[i],\x20intensity[i],\x20type,\x20lightPEC.w,\x20pointToLightEC,\x20direction[i],\x20outerConeCos[i],\x20innerConeCos[i]);\x0a\x20\x20\x20\x20totalColor\x20+=\x20NdotL\x20*\x20colorIntensity;\x0a\x20\x20}\x0a\x0a\x20\x20out_FragColor\x20=\x20vec4(color.xyz\x20+\x20totalColor,\x201.0);\x0a}\x0a',Cesium$4=mars3d__namespace['Cesium'],BasePointPrimitive$1=mars3d__namespace[_0x3455a5(0x27e)]['BasePointPrimitive'],register$4=mars3d__namespace['GraphicUtil'][_0x3455a5(0x21d)],getCesiumColor$2=mars3d__namespace['Util']['getCesiumColor'],addPositionsHeight$3=mars3d__namespace['PointUtil']['addPositionsHeight'],DEF_STYLE$3={'color':Cesium$4['Color']['WHITE'],'intensity':0xa,'radius':0x3e8},PointLight=function(_0x2561ff){var _0x1ce55d=_0x3455a5;_inherits(_0x49d202,_0x2561ff);var _0x2fc530=_createSuper(_0x49d202);function _0x49d202(){var _0x19fa36=_0x1184,_0x521135,_0x268bb3=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{},_0x5bf361=arguments['length']>0x1&&arguments[0x1]!==undefined?arguments[0x1]:!![];return _classCallCheck(this,_0x49d202),_0x5bf361&&(_0x268bb3['style']=_objectSpread2(_objectSpread2({},DEF_STYLE$3),_0x268bb3['style']||{})),_0x521135=_0x2fc530[_0x19fa36(0x273)](this,_0x268bb3),_0x521135[_0x19fa36(0x24c)]=0x1,_0x521135['_color']=getCesiumColor$2(_0x521135[_0x19fa36(0x242)][_0x19fa36(0x21a)],Cesium$4[_0x19fa36(0x226)]['WHITE']),_0x521135;}return _createClass(_0x49d202,[{'key':'czmObject','get':function _0x4321f0(){var _0x5eb232=_0x1184;return this[_0x5eb232(0x20a)];}},{'key':'lights','get':function _0xaca00d(){var _0x413256=_0x1184,_0x54da1d;return(_0x54da1d=this[_0x413256(0x26e)])===null||_0x54da1d===void 0x0?void 0x0:_0x54da1d['_lights'];}},{'key':'intensity','get':function _0x410345(){var _0x2f02e8=_0x1184;return this[_0x2f02e8(0x242)]['intensity'];},'set':function _0xc69fe4(_0x4d5889){var _0x17c688=_0x1184;this[_0x17c688(0x242)]['intensity']=_0x4d5889;}},{'key':'color','get':function _0x2ef343(){return this['_color'];},'set':function _0x5f2785(_0x309c13){this['_color']=getCesiumColor$2(_0x309c13,Cesium$4['Color']['WHITE']);}},{'key':_0x1ce55d(0x254),'get':function _0x287a1a(){return this['_shadowMap'];}},{'key':'camera','get':function _0x574391(){return this['_camera'];}},{'key':'_updatePositionsHook','value':function _0x7d0e4b(){var _0xca3b79=_0x1ce55d,_0x1fb83e=this['_position'];if(this[_0xca3b79(0x20a)]&&_0x1fb83e){var _0x1dafea=this['getAddHeight']();_0x1dafea!==0x0&&(_0x1fb83e=addPositionsHeight$3(_0x1fb83e,_0x1dafea)),this['_camera']['position']=_0x1fb83e,this['_camera']['up']=Cesium$4['Cartesian3']['normalize'](_0x1fb83e,new Cesium$4['Cartesian3']());}}},{'key':'_addedHook','value':function _0x2984c0(_0x32591a){var _0x50fc04=_0x1ce55d;this['_shadowMap']=this[_0x50fc04(0x293)](),this['_position']&&this['_updatePositionsHook'](),this['primitiveCollection'][_0x50fc04(0x27b)](this),this['lights'][_0x50fc04(0x23f)](this['id'],this),this[_0x50fc04(0x1ef)]();}},{'key':'_createShadowMap','value':function _0xe0a858(){var _0x20dea3=_0x1ce55d;return this['_shadowMap']&&(this['_shadowMap']['destroy'](),delete this[_0x20dea3(0x283)]),this['_camera']=new Cesium$4[(_0x20dea3(0x267))](this['_map'][_0x20dea3(0x286)]),new Cesium$4['ShadowMap']({'lightCamera':this['_camera'],'enable':![],'darkness':0x1,'isPointLight':!![],'isSpotLight':![],'cascadesEnabled':![],'context':this['_map']['scene']['context'],'pointLightRadius':this['style']['radius'],'fromLightSource':![]});}},{'key':_0x1ce55d(0x23e),'value':function _0x595295(){var _0x12705c=_0x1ce55d;this['_shadowMap']&&(this['_shadowMap']['destroy'](),delete this[_0x12705c(0x283)]),this['primitiveCollection']&&this['primitiveCollection']['contains'](this)&&(this['_noDestroy']=!![],this['primitiveCollection']['remove'](this),this['_noDestroy']=![]),this[_0x12705c(0x264)]['remove'](this['id']),this[_0x12705c(0x1ef)]();}},{'key':'update','value':function _0x133bdb(_0x5a8cc4){var _0xea9be3=_0x1ce55d;this[_0xea9be3(0x283)]&&_0x5a8cc4['shadowMaps']['push'](this['_shadowMap']);}},{'key':'_updateStyleHook','value':function _0x4878e0(_0x3e9abb,_0xf9ccfa){var _0x590e75=_0x1ce55d;Cesium$4[_0x590e75(0x247)](_0xf9ccfa['color'])&&(this[_0x590e75(0x272)]=getCesiumColor$2(_0xf9ccfa['color'],Cesium$4['Color'][_0x590e75(0x25d)])),(Cesium$4['defined'](_0xf9ccfa['addHeight'])||Cesium$4['defined'](_0xf9ccfa['heading'])||Cesium$4[_0x590e75(0x247)](_0xf9ccfa['pitch'])||Cesium$4['defined'](_0xf9ccfa[_0x590e75(0x233)]))&&this[_0x590e75(0x20f)](),Cesium$4['defined'](_0xf9ccfa['radius'])&&this['_shadowMap']&&(this['_shadowMap']=this['_createShadowMap'](),this[_0x590e75(0x24a)]&&this[_0x590e75(0x20f)]());}},{'key':'_clearDraw','value':function _0x2c1c92(){var _0x4c77c1=_0x1ce55d;if(!this['_map'])return;this['lights']['_postProcessStage']&&(this['_map']['scene']['postProcessStages']['remove'](this[_0x4c77c1(0x264)]['_postProcessStage']),delete this['lights']['_postProcessStage']);}},{'key':'_updateDraw','value':function _0x378383(){var _0x2a9fff=_0x1ce55d;if(!this[_0x2a9fff(0x26e)])return;this['_clearDraw']();var _0x3e3ac9=this['lights'];if(_0x3e3ac9['length']===0x0)return;var _0x3ade79,_0x1cb10c,_0x37835e,_0x1f23b8,_0x2cbd5b,_0x400abf,_0xa0e31,_0x3ecaef,_0x5ed744,_0x2d8b83,_0x1a2a87;function _0x24081(){_0x37835e=[],_0x1f23b8=[],_0x2cbd5b=[],_0x400abf=[],_0xa0e31=[],_0x3ecaef=[],_0x5ed744=[],_0x2d8b83=[],_0x1a2a87=[],_0x3e3ac9['forEach'](function(_0x5cd361){var _0x36a18a=_0x1184,_0x128387=_0x5cd361['shadowMap'];if(!_0x128387)return;_0x1f23b8[_0x36a18a(0x249)](_0x5cd361['intensity']),_0x2cbd5b['push'](_0x5cd361[_0x36a18a(0x21a)]),_0x37835e['push'](_0x128387['_lightPositionEC']),_0x400abf['push'](_0x128387['_shadowMapMatrix']);var _0x1b4ef0=_0x128387['_isPointLight']?_0x128387['_pointBias']:_0x128387[_0x36a18a(0x212)];_0xa0e31['push'](Cesium$4[_0x36a18a(0x23d)]['fromElements'](0x1/_0x128387[_0x36a18a(0x271)]['x'],0x1/_0x128387['_textureSize']['y'],_0x1b4ef0['depthBias'],_0x1b4ef0['normalShadingSmooth'])),_0x3ecaef[_0x36a18a(0x249)](new Cesium$4['Cartesian2'](_0x128387['_darkness'],_0x5cd361[_0x36a18a(0x24c)])),_0x5cd361[_0x36a18a(0x24c)]===0x2?(_0x5ed744['push'](_0x128387['_lightDirectionEC']),_0x2d8b83['push'](Math['cos'](Cesium$4['Math'][_0x36a18a(0x28d)](_0x5cd361['outerCone']))),_0x1a2a87['push'](Math['cos'](Cesium$4[_0x36a18a(0x276)]['toRadians'](_0x5cd361[_0x36a18a(0x214)])))):(_0x5ed744['push'](Cesium$4['Cartesian3'][_0x36a18a(0x215)]),_0x2d8b83[_0x36a18a(0x249)](0x0),_0x1a2a87[_0x36a18a(0x249)](0x0));});}_0x24081();if(this['_map']['hasShadow']){_0x3ade79={'lightPositionEC':function _0x11f2be(){return _0x24081(),_0x37835e;},'intensity':function _0x3822bd(){return _0x1f23b8;},'lightColor':function _0x391190(){return _0x2cbd5b;},'shadowMapMatrix':function _0x53015c(){return _0x400abf;},'shadowMapTexelSizeDepthBiasAndNormalShadingSmooth':function _0x558299(){return _0xa0e31;},'shadowMapDarknessType':function _0x4500de(){return _0x3ecaef;},'direction':function _0x25feb1(){return _0x5ed744;},'outerConeCos':function _0x58e017(){return _0x2d8b83;},'innerConeCos':function _0x24f849(){return _0x1a2a87;}};var _0x315c5b=getLightShadowMaps(_0x3e3ac9,_0x3ade79),_0x285b14=_0x315c5b['uniformShader'],_0x29ef95=_0x315c5b['shadowVisibilityShader'];_0x1cb10c=MultipleLightShader['replace'](_0x2a9fff(0x277),_0x3e3ac9['length']),_0x1cb10c=_0x1cb10c[_0x2a9fff(0x25e)]('Mars3D_LightShadowMapsShader',_0x285b14),_0x1cb10c=_0x1cb10c[_0x2a9fff(0x25e)](_0x2a9fff(0x1f7),_0x29ef95);}else _0x3ade79={'lightPositionEC':function _0x547319(){return _0x24081(),_0x37835e;},'intensity':function _0x4f4648(){return _0x1f23b8;},'lightColor':function _0x52cc7e(){return _0x2cbd5b;},'shadowMapDarknessType':function _0x33f3fa(){return _0x3ecaef;},'direction':function _0x2b9d9c(){return _0x5ed744;},'outerConeCos':function _0x55041c(){return _0x2d8b83;},'innerConeCos':function _0x4d6b51(){return _0x1a2a87;}},_0x1cb10c=MultipleLightNoShadowShader['replace']('Mars3D_LightNumValue',_0x3e3ac9['length']);this['lights']['_postProcessStage']=new Cesium$4[(_0x2a9fff(0x287))]({'sampleMode':Cesium$4['PostProcessStageSampleMode']['NEAREST'],'fragmentShader':_0x1cb10c,'uniforms':_0x3ade79}),this['_map']['scene']['postProcessStages']['add'](this['lights'][_0x2a9fff(0x290)]);}},{'key':'_getDrawEntityClass','value':function _0x26c67a(_0x2445ad,_0x53f8d8){return this['_getDrawPointEntityClass'](_0x2445ad,_0x53f8d8);}}]),_0x49d202;}(BasePointPrimitive$1);register$4('pointLight',PointLight,!![]);function getLightShadowMaps(_0xf5e892,_0x574c27){var _0x2c7b54='',_0x4c9b5d='';return _0xf5e892['forEach'](function(_0x42dd6d,_0x53b130){var _0x3deffd=_0x1184;switch(_0x42dd6d['_light_type']){case 0x1:_0x2c7b54+=_0x3deffd(0x255)[_0x3deffd(0x1f4)](_0x53b130,';\x0a'),_0x4c9b5d+='totalColor\x20+=\x20getPointLightTotalColorMars3D(normalEC,\x20positionEC,\x20'[_0x3deffd(0x1f4)](_0x53b130,',\x20lightShadowMapCube')[_0x3deffd(0x1f4)](_0x53b130,');\x0a'),_0x574c27[_0x3deffd(0x1f3)[_0x3deffd(0x1f4)](_0x53b130)]=function(){var _0x3969b6=_0x3deffd;return _0x42dd6d[_0x3969b6(0x254)][_0x3969b6(0x206)];};break;case 0x2:_0x2c7b54+='uniform\x20sampler2D\x20lightShadowMap2D'['concat'](_0x53b130,';\x0a'),_0x4c9b5d+='totalColor\x20+=\x20getSpotLightTotalColorMars3D(normalEC,\x20positionEC,\x20'[_0x3deffd(0x1f4)](_0x53b130,',\x20lightShadowMap2D')[_0x3deffd(0x1f4)](_0x53b130,');\x0a'),_0x574c27['lightShadowMap2D'[_0x3deffd(0x1f4)](_0x53b130)]=function(){var _0x1aff07=_0x3deffd;return _0x42dd6d[_0x1aff07(0x254)][_0x1aff07(0x206)];};break;}}),{'uniformShader':_0x2c7b54,'shadowVisibilityShader':_0x4c9b5d};}var Cesium$3=mars3d__namespace['Cesium'],register$3=mars3d__namespace['GraphicUtil']['register'],addPositionsHeight$2=mars3d__namespace[_0x3455a5(0x28f)]['addPositionsHeight'],DEF_STYLE$2={'color':Cesium$3['Color'][_0x3455a5(0x25d)],'intensity':0xa,'radius':0x3e8,'innerCone':0xa,'outerCone':0x2d},SpotLight=function(_0x5d70f1){_inherits(_0x4b54e5,_0x5d70f1);var _0x5e3178=_createSuper(_0x4b54e5);function _0x4b54e5(){var _0x1fbcb2=_0x1184,_0x164ef3,_0x1cce7e=arguments[_0x1fbcb2(0x221)]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{},_0x16b10d=arguments['length']>0x1&&arguments[0x1]!==undefined?arguments[0x1]:!![];return _classCallCheck(this,_0x4b54e5),_0x16b10d&&(_0x1cce7e[_0x1fbcb2(0x242)]=_objectSpread2(_objectSpread2({},DEF_STYLE$2),_0x1cce7e['style']||{})),_0x164ef3=_0x5e3178[_0x1fbcb2(0x273)](this,_0x1cce7e),_0x164ef3['_light_type']=0x2,_0x164ef3;}return _createClass(_0x4b54e5,[{'key':'outerCone','get':function _0x1a2b58(){return this['style']['outerCone'];},'set':function _0x5b8b91(_0x3e3e9e){var _0x566bf9=_0x1184;this['style'][_0x566bf9(0x248)]=_0x3e3e9e,this['_camera']['frustum'][_0x566bf9(0x1f6)]=Cesium$3[_0x566bf9(0x276)][_0x566bf9(0x28d)](this['style']['outerCone']*0x2),this['_camera']['frustum']['far']=this[_0x566bf9(0x1fd)];}},{'key':'innerCone','get':function _0x13f7bc(){return this['style']['innerCone'];},'set':function _0x5cb86d(_0x511a56){this['style']['innerCone']=_0x511a56;}},{'key':'_updatePositionsHook','value':function _0x2a81b8(){var _0x310ec6=_0x1184,_0x1519d8=this[_0x310ec6(0x24a)];if(this[_0x310ec6(0x20a)]&&_0x1519d8){var _0xee3279=this['getAddHeight']();_0xee3279!==0x0&&(_0x1519d8=addPositionsHeight$2(_0x1519d8,_0xee3279));this[_0x310ec6(0x20a)][_0x310ec6(0x266)]=_0x1519d8;var _0x21588b=new Cesium$3['HeadingPitchRoll'](Cesium$3[_0x310ec6(0x276)]['toRadians'](this['heading']),Cesium$3['Math'][_0x310ec6(0x28d)](this['pitch']),Cesium$3['Math']['toRadians'](this['roll']));this[_0x310ec6(0x20a)][_0x310ec6(0x25b)]({'destination':_0x1519d8,'orientation':{'heading':_0x21588b['heading'],'pitch':_0x21588b['pitch'],'roll':_0x21588b[_0x310ec6(0x233)]}});}}},{'key':'_createShadowMap','value':function _0x5dfd8a(){var _0x522519=_0x1184;return this['_camera']=new Cesium$3['Camera'](this['_map'][_0x522519(0x286)]),this['_camera']['frustum'][_0x522519(0x241)]=0x1,this['_camera'][_0x522519(0x209)]['fov']=Cesium$3['Math']['toRadians'](this['style']['outerCone']*0x2),this['_camera'][_0x522519(0x209)]['near']=0.1,this['_camera']['frustum']['far']=this[_0x522519(0x242)][_0x522519(0x223)],new Cesium$3['ShadowMap']({'lightCamera':this['_camera'],'enable':![],'darkness':0x1,'isPointLight':![],'isSpotLight':!![],'cascadesEnabled':![],'context':this[_0x522519(0x26e)]['scene']['context'],'pointLightRadius':this['style']['radius'],'fromLightSource':![]});}}]),_0x4b54e5;}(PointLight);register$3(_0x3455a5(0x227),SpotLight,!![]);function _0x1184(_0x327f80,_0x4a0d1e){var _0x3318fb=_0x3318();return _0x1184=function(_0x118480,_0x9b5824){_0x118480=_0x118480-0x1ef;var _0xe1b767=_0x3318fb[_0x118480];return _0xe1b767;},_0x1184(_0x327f80,_0x4a0d1e);}var VolumeCloudFS=_0x3455a5(0x26d),VolumeCloudVS='in\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec3\x20vOrigin;\x0aout\x20vec3\x20vDirection;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vOrigin\x20=\x20czm_encodedCameraPositionMCHigh\x20+\x20czm_encodedCameraPositionMCLow;\x0a\x20\x20vDirection\x20=\x20position\x20-\x20vOrigin;\x0a\x20\x20gl_Position\x20=\x20czm_modelViewProjection\x20*\x20vec4(position,\x201.0);\x0a}\x0a',Cesium$2=mars3d__namespace['Cesium'],Texture3=mars3d__namespace[_0x3455a5(0x288)],BasePrimitive=mars3d__namespace['graphic']['BasePrimitive'],register$2=mars3d__namespace[_0x3455a5(0x207)]['register'],getCesiumColor$1=mars3d__namespace[_0x3455a5(0x218)][_0x3455a5(0x269)],VolumeCloud=function(_0x5da98d){var _0x5be7bd=_0x3455a5;_inherits(_0x1a5a02,_0x5da98d);var _0x1306c0=_createSuper(_0x1a5a02);function _0x1a5a02(){var _0x4ab5f0=_0x1184,_0x5dfe15,_0x33a16b,_0x4019a,_0x3c2b63,_0x1d357f,_0x592aa7,_0xb522fb=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x1a5a02),_0x592aa7=_0x1306c0['call'](this,_0xb522fb),_0x592aa7[_0x4ab5f0(0x298)]=(_0x5dfe15=_0x592aa7['options']['threshold'])!==null&&_0x5dfe15!==void 0x0?_0x5dfe15:0x41/0xff,_0x592aa7[_0x4ab5f0(0x256)]=(_0x33a16b=_0x592aa7['options'][_0x4ab5f0(0x256)])!==null&&_0x33a16b!==void 0x0?_0x33a16b:0x258,_0x592aa7['xCut']=(_0x4019a=_0x592aa7['options'][_0x4ab5f0(0x230)])!==null&&_0x4019a!==void 0x0?_0x4019a:-0.5,_0x592aa7[_0x4ab5f0(0x25f)]=(_0x3c2b63=_0x592aa7['options'][_0x4ab5f0(0x25f)])!==null&&_0x3c2b63!==void 0x0?_0x3c2b63:-0.5,_0x592aa7['zCut']=(_0x1d357f=_0x592aa7['options'][_0x4ab5f0(0x270)])!==null&&_0x1d357f!==void 0x0?_0x1d357f:0.5,_0x592aa7;}return _createClass(_0x1a5a02,[{'key':'czmObject','get':function _0x538189(){var _0xe1c3f5=_0x1184;return this[_0xe1c3f5(0x283)];}},{'key':'updateData','value':function _0x4f9c82(_0x4f408b){var _0x278ab7=_0x1184;this['texture3D']&&(this['texture3D']['destroy'](),delete this['texture3D']);for(var _0x42c18a=0x0,_0x1bbfcd=_0x4f408b[_0x278ab7(0x208)]['length'];_0x42c18a<_0x1bbfcd;_0x42c18a++){_0x4f408b[_0x278ab7(0x208)][_0x42c18a]=Math['abs'](_0x4f408b['values'][_0x42c18a]);}this['texture3D']=new Texture3({'context':this[_0x278ab7(0x26e)]['scene']['context'],'source':{'width':_0x4f408b['rows'],'height':_0x4f408b['cols'],'depth':_0x4f408b['heights'],'arrayBufferView':new Uint8Array(_0x4f408b['values'])},'pixelFormat':Cesium$2[_0x278ab7(0x263)]['ALPHA'],'pixelDatatype':Cesium$2[_0x278ab7(0x28e)]['UNSIGNED_BYTE']});}},{'key':_0x5be7bd(0x20c),'value':function _0x590bd3(){var _0x3d6de3=_0x5be7bd,_0x3b1214=this[_0x3d6de3(0x1fe)]['data'];this['texture3D']=new Texture3({'context':this[_0x3d6de3(0x26e)]['scene']['context'],'source':{'width':_0x3b1214['rows'],'height':_0x3b1214['cols'],'depth':_0x3b1214[_0x3d6de3(0x1f5)],'arrayBufferView':new Uint8Array(_0x3b1214['values'])},'pixelFormat':Cesium$2['PixelFormat']['ALPHA'],'pixelDatatype':Cesium$2[_0x3d6de3(0x28e)][_0x3d6de3(0x240)]});var _0x45318a=this['options']['colors'],_0x531469=[];_0x45318a['forEach'](function(_0x53a484){var _0x5f4261=_0x3d6de3;_0x531469[_0x5f4261(0x249)](getCesiumColor$1(_0x53a484));}),this[_0x3d6de3(0x1f8)]=_0x531469,this[_0x3d6de3(0x25c)]=this['options'][_0x3d6de3(0x25c)];var _0x4fe82c=Cesium$2['Cartographic'][_0x3d6de3(0x20b)](_0x3b1214['xmin'],_0x3b1214[_0x3d6de3(0x239)],_0x3b1214['zmin']),_0x3f05af=Cesium$2['Cartographic'][_0x3d6de3(0x20b)](_0x3b1214['xmax'],_0x3b1214['ymax'],_0x3b1214['zmax']),_0x16a162=Cesium$2['Rectangle']['fromRadians'](_0x4fe82c['longitude'],_0x4fe82c['latitude'],_0x3f05af[_0x3d6de3(0x250)],_0x3f05af['latitude']);this['_rectangle']=_0x16a162;var _0x33a93f=Cesium$2['Rectangle'][_0x3d6de3(0x225)](_0x16a162),_0x36cd16=Cesium$2['Cartographic']['toCartesian'](Cesium$2['Rectangle']['northeast'](_0x16a162)),_0x2e35b4=Cesium$2[_0x3d6de3(0x24e)]['toCartesian'](Cesium$2[_0x3d6de3(0x22c)][_0x3d6de3(0x299)](_0x16a162)),_0x42f511=Cesium$2['Cartographic']['toCartesian'](Cesium$2['Rectangle']['southeast'](_0x16a162)),_0x5b2506=Cesium$2['Cartesian3']['distance'](_0x36cd16,_0x2e35b4),_0x148a39=Cesium$2['Cartesian3'][_0x3d6de3(0x229)](_0x36cd16,_0x42f511),_0x4bbff0=(_0x3f05af['height']+_0x4fe82c['height'])/0x2,_0x268183=Cesium$2['Cartesian3'][_0x3d6de3(0x21f)](_0x33a93f['longitude'],_0x33a93f[_0x3d6de3(0x231)],_0x4bbff0),_0x32eabb=_0x5b2506>_0x148a39?_0x5b2506:_0x148a39;_0x32eabb=_0x32eabb>_0x4bbff0?_0x32eabb:_0x4bbff0;var _0x5b5f3b=Cesium$2['Transforms'][_0x3d6de3(0x285)](_0x268183),_0x387a9f=Cesium$2[_0x3d6de3(0x1f0)]['fromScale'](new Cesium$2['Cartesian3'](_0x5b2506,_0x148a39,_0x4bbff0*0x2));this[_0x3d6de3(0x26c)]=new Cesium$2['BoundingSphere'](_0x268183,_0x32eabb),this['_modelMatrix']=Cesium$2[_0x3d6de3(0x1f0)][_0x3d6de3(0x258)](_0x5b5f3b,_0x387a9f,_0x5b5f3b);}},{'key':'_addedHook','value':function _0x946f5a(_0x3ecf12){this['primitiveCollection']['add'](this);}},{'key':_0x5be7bd(0x23e),'value':function _0x344a8f(){var _0x40399b=_0x5be7bd;this['primitiveCollection'][_0x40399b(0x26a)](this)&&(this[_0x40399b(0x216)]=!![],this[_0x40399b(0x253)]['remove'](this),this['_noDestroy']=![]),this['texture3D']&&(this['texture3D']['destroy'](),delete this['texture3D']),this['_clearDrawCommand']();}},{'key':'update','value':function _0x3c4eab(_0x3fc5e7){var _0x53ded2=_0x5be7bd;!this['_drawCommands']&&this[_0x53ded2(0x1fb)](_0x3fc5e7[_0x53ded2(0x1fa)]),_0x3fc5e7[_0x53ded2(0x235)][_0x53ded2(0x249)](this['_drawCommands']);}},{'key':_0x5be7bd(0x1fb),'value':function _0x2fb930(_0x1a055a){var _0xbf9c90=_0x5be7bd,_0xf80779=this;this['_clearDrawCommand']();var _0x1b6515=Cesium$2['BoxGeometry']['createGeometry'](Cesium$2['BoxGeometry']['fromDimensions']({'vertexFormat':Cesium$2['VertexFormat']['POSITION_AND_ST'],'dimensions':new Cesium$2['Cartesian3'](0x1,0x1,0x1)})),_0x2f2989=Cesium$2['RenderState']['fromCache']({'depthTest':{'enabled':!![]},'cull':{'enabled':![]}}),_0x3bc460=Cesium$2['GeometryPipeline']['createAttributeLocations'](_0x1b6515),_0x2ecac0=Cesium$2['VertexArray']['fromGeometry']({'context':_0x1a055a,'geometry':_0x1b6515,'attributes':_0x3bc460}),_0x35da33=Cesium$2[_0xbf9c90(0x291)][_0xbf9c90(0x268)]({'boundingSphere':_0x1b6515['boundingSphere'],'context':_0x1a055a,'vertexShaderSource':VolumeCloudVS,'fragmentShaderSource':VolumeCloudFS[_0xbf9c90(0x27f)]('Mars3D_TotalColors',this[_0xbf9c90(0x1f8)]['length']),'attributeLocations':_0x3bc460});this['_drawCommands']=new Cesium$2[(_0xbf9c90(0x224))]({'boundingVolume':this['boundingSphere'],'modelMatrix':this['_modelMatrix'],'pass':Cesium$2['Pass']['TRANSLUCENT'],'shaderProgram':_0x35da33,'renderState':_0x2f2989,'vertexArray':_0x2ecac0,'uniformMap':{'map':function _0x1114c9(){var _0x19543f=_0xbf9c90;return _0xf80779[_0x19543f(0x245)];},'threshold':function _0xb763b0(){return _0xf80779['threshold'];},'steps':function _0x4c02dc(){var _0x1d868a=_0xbf9c90;return _0xf80779[_0x1d868a(0x256)];},'xCut':function _0x3beae3(){return _0xf80779['xCut'];},'yCut':function _0x40caac(){return _0xf80779['yCut'];},'zCut':function _0x146364(){return _0xf80779['zCut'];},'colors':function _0x19137f(){return _0xf80779['colors'];},'colorsKey':function _0x59480a(){return _0xf80779['colorsKey'];}}});}},{'key':'_clearDrawCommand','value':function _0x1a7cf4(){var _0x19a8bc=_0x5be7bd;this[_0x19a8bc(0x28b)]&&(this['_drawCommands'][_0x19a8bc(0x1f9)]&&this['_drawCommands'][_0x19a8bc(0x1f9)]['destroy'](),this[_0x19a8bc(0x28b)][_0x19a8bc(0x261)]&&this[_0x19a8bc(0x28b)][_0x19a8bc(0x261)]['destroy'](),delete this['_drawCommands']);}}]),_0x1a5a02;}(BasePrimitive);register$2('volumeCloud',VolumeCloud,!![]);var MultipleVisibilityShader='\x0auniform\x20sampler2D\x20colorTexture;\x0auniform\x20sampler2D\x20depthTexture;\x0a\x0auniform\x20float\x20mars3d_opacity;\x0auniform\x20vec3\x20mars3d_visibleAreaColor;\x0auniform\x20vec3\x20mars3d_hiddenAreaColor;\x0a\x0a\x0aconst\x20int\x20LightNum\x20=\x20LightNumVlaue;\x0auniform\x20vec4\x20lightPositionEC[LightNum];\x0auniform\x20mat4\x20shadowMapMatrix[LightNum];\x0auniform\x20vec4\x20shadowMapTexelSizeDepthBiasAndNormalShadingSmooth[LightNum];\x0auniform\x20vec2\x20shadowMapDarknessType[LightNum];\x0a\x0aLightShadowMapsShader\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec3\x20getEyeCoordinate3FromWindowCoordinate(vec2\x20fragCoord,\x20float\x20logDepthOrDepth)\x20{\x0a\x20\x20vec4\x20eyeCoordinate\x20=\x20czm_windowToEyeCoordinates(fragCoord,\x20logDepthOrDepth);\x0a\x20\x20return\x20eyeCoordinate.xyz\x20/\x20eyeCoordinate.w;\x0a}\x0a\x0avec3\x20vectorFromOffset(vec4\x20eyeCoordinate,\x20vec2\x20positiveOffset)\x20{\x0a\x20\x20vec2\x20glFragCoordXY\x20=\x20v_textureCoordinates.xy\x20*\x20czm_viewport.zw;\x0a\x20\x20float\x20upOrRightLogDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20(glFragCoordXY\x20+\x20positiveOffset)\x20/\x20czm_viewport.zw));\x0a\x20\x20float\x20downOrLeftLogDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20(glFragCoordXY\x20-\x20positiveOffset)\x20/\x20czm_viewport.zw));\x0a\x0a\x20\x20bvec2\x20upOrRightInBounds\x20=\x20lessThan(glFragCoordXY\x20+\x20positiveOffset,\x20czm_viewport.zw);\x0a\x20\x20float\x20useUpOrRight\x20=\x20float(upOrRightLogDepth\x20>\x200.0\x20&&\x20upOrRightInBounds.x\x20&&\x20upOrRightInBounds.y);\x0a\x20\x20float\x20useDownOrLeft\x20=\x20float(useUpOrRight\x20==\x200.0);\x0a\x20\x20vec3\x20upOrRightEC\x20=\x20getEyeCoordinate3FromWindowCoordinate(glFragCoordXY\x20+\x20positiveOffset,\x20upOrRightLogDepth);\x0a\x20\x20vec3\x20downOrLeftEC\x20=\x20getEyeCoordinate3FromWindowCoordinate(glFragCoordXY\x20-\x20positiveOffset,\x20downOrLeftLogDepth);\x0a\x20\x20return\x20(upOrRightEC\x20-\x20(eyeCoordinate.xyz\x20/\x20eyeCoordinate.w))\x20*\x20useUpOrRight\x20+\x20((eyeCoordinate.xyz\x20/\x20eyeCoordinate.w)\x20-\x20downOrLeftEC)\x20*\x20useDownOrLeft;\x0a}\x0a\x0astruct\x20my_shadowParameters\x0a{\x0a\x20\x20\x20\x20vec3\x20texCoordsCube;\x0a\x20\x20\x20\x20vec2\x20texCoords;\x0a\x20\x20\x20\x20float\x20depthBias;\x0a\x20\x20\x20\x20float\x20depth;\x0a\x20\x20\x20\x20float\x20nDotL;\x0a\x20\x20\x20\x20vec2\x20texelStepSize;\x0a\x20\x20\x20\x20float\x20normalShadingSmooth;\x0a\x20\x20\x20\x20float\x20darkness;\x0a};\x0a\x0afloat\x20shadowVisibilityCube(samplerCube\x20shadowMap,\x20my_shadowParameters\x20shadowParameters){\x0a\x20\x20\x20\x20float\x20depthBias\x20=\x20shadowParameters.depthBias;\x0a\x20\x20\x20\x20float\x20depth\x20=\x20shadowParameters.depth;\x0a\x20\x20\x20\x20float\x20nDotL\x20=\x20shadowParameters.nDotL;\x0a\x20\x20\x20\x20float\x20normalShadingSmooth\x20=\x20shadowParameters.normalShadingSmooth;\x0a\x20\x20\x20\x20float\x20darkness\x20=\x20shadowParameters.darkness;\x0a\x20\x20\x20\x20vec3\x20uvw\x20=\x20shadowParameters.texCoordsCube;\x0a\x0a\x20\x20\x20\x20depth\x20-=\x20depthBias;\x0a\x20\x20\x20\x20return\x20czm_shadowDepthCompare(shadowMap,\x20uvw,\x20depth);\x0a}\x0afloat\x20shadowVisibility2D(sampler2D\x20shadowMap,\x20my_shadowParameters\x20shadowParameters)\x0a{\x0a\x20\x20\x20\x20float\x20depthBias\x20=\x20shadowParameters.depthBias;\x0a\x20\x20\x20\x20float\x20depth\x20=\x20shadowParameters.depth;\x0a\x20\x20\x20\x20float\x20nDotL\x20=\x20shadowParameters.nDotL;\x0a\x20\x20\x20\x20float\x20normalShadingSmooth\x20=\x20shadowParameters.normalShadingSmooth;\x0a\x20\x20\x20\x20float\x20darkness\x20=\x20shadowParameters.darkness;\x0a\x20\x20\x20\x20vec2\x20uv\x20=\x20shadowParameters.texCoords;\x0a\x0a\x20\x20\x20\x20depth\x20-=\x20depthBias;\x0a\x20\x20\x20\x20return\x20czm_shadowDepthCompare(shadowMap,\x20uv,\x20depth);\x0a}\x0a\x0aint\x20getPointVisibility(vec3\x20normalEC,\x20vec3\x20positionEC,\x20int\x20i,\x20samplerCube\x20lightShadowMapCube){\x0a\x20\x20vec4\x20lightPEC\x20=\x20lightPositionEC[i];\x0a\x20\x20vec2\x20shadowMapDT\x20=\x20shadowMapDarknessType[i];\x0a\x20\x20vec3\x20pointToLightEC\x20=\x20positionEC\x20-\x20lightPEC.xyz;\x0a\x20\x20float\x20pointToLightECLength\x20=\x20length(pointToLightEC);\x0a\x20\x20vec3\x20l\x20=\x20normalize(pointToLightEC);\x0a\x20\x20float\x20NdotL\x20=\x20clamp(dot(-normalEC,\x20l),\x200.0,\x201.0);\x0a\x0a\x20\x20float\x20visibility\x20=\x200.0;\x0a\x20\x20float\x20radius\x20=\x20lightPEC.w;\x0a\x20\x20float\x20type\x20=\x20shadowMapDT.y;\x0a\x0a\x20\x20if(pointToLightECLength\x20<=\x20radius){\x0a\x20\x20\x20\x20vec4\x20shadowMapTSDBANSS\x20=\x20shadowMapTexelSizeDepthBiasAndNormalShadingSmooth[i];\x0a\x0a\x20\x20\x20\x20my_shadowParameters\x20shadowParameters;\x0a\x20\x20\x20\x20shadowParameters.texelStepSize\x20=\x20shadowMapTSDBANSS.xy;\x0a\x20\x20\x20\x20shadowParameters.depthBias\x20=\x20shadowMapTSDBANSS.z;\x0a\x20\x20\x20\x20shadowParameters.normalShadingSmooth\x20=\x20shadowMapTSDBANSS.w;\x0a\x20\x20\x20\x20shadowParameters.darkness\x20=\x20shadowMapDT.x;\x0a\x20\x20\x20\x20shadowParameters.depth\x20=\x20pointToLightECLength\x20/\x20radius;\x0a\x20\x20\x20\x20shadowParameters.nDotL\x20=\x20NdotL;\x0a\x20\x20\x20\x20shadowParameters.texCoordsCube\x20=\x20czm_inverseViewRotation\x20*\x20l;\x0a\x20\x20\x20\x20visibility\x20=\x20shadowVisibilityCube(lightShadowMapCube,\x20shadowParameters);\x0a\x20\x20\x20\x20if(visibility\x20==\x201.0){\x0a\x20\x20\x20\x20\x20\x20return\x200;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20return\x201;\x0a\x20\x20\x20\x20}\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20return\x202;\x0a\x20\x20}\x0a}\x0a\x0aint\x20getFrustumVisibility(vec3\x20normalEC,\x20vec3\x20positionEC,\x20int\x20i,\x20sampler2D\x20lightShadowMap2D){\x0a\x20\x20vec4\x20lightPEC\x20=\x20lightPositionEC[i];\x0a\x20\x20vec2\x20shadowMapDT\x20=\x20shadowMapDarknessType[i];\x0a\x20\x20vec3\x20pointToLightEC\x20=\x20positionEC\x20-\x20lightPEC.xyz;\x0a\x20\x20vec3\x20l\x20=\x20normalize(pointToLightEC);\x0a\x20\x20float\x20NdotL\x20=\x20clamp(dot(-normalEC,\x20l),\x200.0,\x201.0);\x0a\x0a\x20\x20float\x20visibility\x20=\x200.0;\x0a\x20\x20float\x20type\x20=\x20shadowMapDT.y;\x0a\x0a\x20\x20vec4\x20shadowPosition\x20=\x20shadowMapMatrix[i]\x20*\x20vec4(positionEC,\x201.0);\x0a\x20\x20shadowPosition\x20/=\x20shadowPosition.w;\x0a\x20\x20if\x20(any(lessThan(shadowPosition.xyz,\x20vec3(0.0)))\x20||\x20any(greaterThan(shadowPosition.xyz,\x20vec3(1.0))))\x20{\x0a\x20\x20\x20\x20return\x202;\x0a\x20\x20}\x0a\x0a\x0a\x0a\x20\x20vec4\x20shadowMapTSDBANSS\x20=\x20shadowMapTexelSizeDepthBiasAndNormalShadingSmooth[i];\x0a\x20\x20my_shadowParameters\x20shadowParameters;\x0a\x20\x20shadowParameters.texelStepSize\x20=\x20shadowMapTSDBANSS.xy;\x0a\x20\x20shadowParameters.depthBias\x20=\x20shadowMapTSDBANSS.z;\x0a\x20\x20shadowParameters.normalShadingSmooth\x20=\x20shadowMapTSDBANSS.w;\x0a\x20\x20shadowParameters.darkness\x20=\x20shadowMapDT.x;\x0a\x20\x20shadowParameters.texCoords\x20=\x20shadowPosition.xy;\x0a\x20\x20shadowParameters.depth\x20=\x20shadowPosition.z;\x0a\x20\x20shadowParameters.nDotL\x20=\x20NdotL;\x0a\x0a\x20\x20visibility\x20=\x20shadowVisibility2D(lightShadowMap2D,\x20shadowParameters);\x0a\x20\x20if(visibility\x20==\x201.0){\x0a\x20\x20\x20\x20return\x200;\x0a\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20return\x201;\x0a\x20\x20}\x0a\x0a}\x0a\x0a\x0avoid\x20main()\x20{\x0a\x20\x20vec4\x20color\x20=\x20texture(colorTexture,\x20v_textureCoordinates);\x0a\x20\x20float\x20logDepthOrDepth\x20=\x20czm_unpackDepth(texture(depthTexture,\x20v_textureCoordinates));\x0a\x20\x20if(logDepthOrDepth\x20>=\x201.0){\x0a\x20\x20\x20\x20out_FragColor\x20=\x20color;\x0a\x20\x20\x20\x20return;\x0a\x20\x20}\x0a\x0a\x20\x20vec4\x20eyeCoordinate\x20=\x20czm_windowToEyeCoordinates(v_textureCoordinates.xy\x20*\x20czm_viewport.zw,\x20logDepthOrDepth);\x0a\x20\x20vec3\x20downUp\x20=\x20vectorFromOffset(eyeCoordinate,\x20vec2(0.0,\x201.0));\x0a\x20\x20vec3\x20leftRight\x20=\x20vectorFromOffset(eyeCoordinate,\x20vec2(1.0,\x200.0));\x0a\x20\x20vec3\x20normalEC\x20=\x20normalize(cross(leftRight,\x20downUp));\x0a\x20\x20vec3\x20positionEC\x20=\x20eyeCoordinate.xyz\x20/\x20eyeCoordinate.w;\x0a\x0a\x20\x20int\x20visibility\x20=\x200;\x0a\x20\x20int\x20inside\x20=\x200;\x0a\x20\x20vec3\x20totalColor\x20=\x20vec3(0.0);\x0a\x0a\x20\x20ShadowVisibilityShader\x0a\x0a\x20\x20if(visibility\x20>\x200){\x0a\x20\x20\x20\x20totalColor\x20=\x20mars3d_visibleAreaColor;\x0a\x20\x20}\x20else\x20if(inside\x20>\x200)\x20{\x0a\x20\x20\x20\x20totalColor\x20=\x20mars3d_hiddenAreaColor;\x0a\x20\x20}\x0a\x20\x20out_FragColor\x20=\x20vec4(color.xyz\x20+\x20totalColor,\x20mars3d_opacity);\x0a}\x0a',Cesium$1=mars3d__namespace['Cesium'],BasePointPrimitive=mars3d__namespace['graphic'][_0x3455a5(0x284)],register$1=mars3d__namespace['GraphicUtil']['register'],getCesiumColor=mars3d__namespace[_0x3455a5(0x218)]['getCesiumColor'],addPositionsHeight$1=mars3d__namespace['PointUtil'][_0x3455a5(0x23c)],DEF_STYLE$1={'opacity':0.6,'radius':0x3e8,'showFrustum':![]},PointVisibility=function(_0x2e7298){var _0x52fc73=_0x3455a5;_inherits(_0x6565ec,_0x2e7298);var _0x17e9a8=_createSuper(_0x6565ec);function _0x6565ec(){var _0x4619a2=_0x1184,_0x5751fd,_0x1a973f,_0x1d6838=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{},_0x522cfc=arguments['length']>0x1&&arguments[0x1]!==undefined?arguments[0x1]:!![];return _classCallCheck(this,_0x6565ec),_0x522cfc&&(_0x1d6838[_0x4619a2(0x242)]=_objectSpread2(_objectSpread2({},DEF_STYLE$1),_0x1d6838[_0x4619a2(0x242)]||{})),_0x1a973f=_0x17e9a8['call'](this,_0x1d6838),_0x1a973f[_0x4619a2(0x1f1)]=0x1,_0x1a973f['_visibleAreaColor']=getCesiumColor(_0x1a973f[_0x4619a2(0x242)]['visibleAreaColor'],new Cesium$1[(_0x4619a2(0x226))](0x0,0x1,0x0)),_0x1a973f['_hiddenAreaColor']=getCesiumColor(_0x1a973f['style']['hiddenAreaColor'],new Cesium$1[(_0x4619a2(0x226))](0x1,0x0,0x0)),_0x1a973f['_hasTerrainShadows']=(_0x5751fd=_0x1a973f[_0x4619a2(0x1fe)]['terrain'])!==null&&_0x5751fd!==void 0x0?_0x5751fd:!![],_0x1a973f;}return _createClass(_0x6565ec,[{'key':'czmObject','get':function _0x29ff9f(){return this['_camera'];}},{'key':'visibilitys','get':function _0x267cd4(){var _0x3b9116;return(_0x3b9116=this['_map'])===null||_0x3b9116===void 0x0?void 0x0:_0x3b9116['_visibilitys'];}},{'key':'opacity','get':function _0x207878(){var _0x3095a7=_0x1184;return this[_0x3095a7(0x242)]['opacity'];},'set':function _0x107fd6(_0x24e1ab){this['style']['opacity']=_0x24e1ab;}},{'key':'visibleAreaColor','get':function _0x4afb48(){var _0x17408e=_0x1184;return this[_0x17408e(0x244)];},'set':function _0x131b3a(_0x277e70){var _0x2f1cc4=_0x1184;this[_0x2f1cc4(0x244)]=getCesiumColor(_0x277e70);}},{'key':'hiddenAreaColor','get':function _0x29e2f9(){var _0x34c2f4=_0x1184;return this[_0x34c2f4(0x24f)];},'set':function _0x37528b(_0x43c908){this['_hiddenAreaColor']=getCesiumColor(_0x43c908);}},{'key':_0x52fc73(0x254),'get':function _0x38f2a8(){var _0x3a7299=_0x52fc73;return this[_0x3a7299(0x283)];}},{'key':'camera','get':function _0x317028(){return this['_camera'];}},{'key':'_updatePositionsHook','value':function _0x4f2339(){var _0x3dba02=_0x52fc73,_0x2e7012=this['_position'];if(this['_camera']&&_0x2e7012){var _0x11259f=this[_0x3dba02(0x281)]();_0x11259f!==0x0&&(_0x2e7012=addPositionsHeight$1(_0x2e7012,_0x11259f)),this['_camera']['position']=_0x2e7012,this['_camera']['up']=Cesium$1['Cartesian3'][_0x3dba02(0x217)](_0x2e7012,new Cesium$1['Cartesian3']());}}},{'key':'_addedHook','value':function _0x5b00c1(_0x2d3d00){var _0x3bfecb=_0x52fc73;this['_hasTerrainShadows']&&(this['_map'][_0x3bfecb(0x246)][_0x3bfecb(0x275)]=Cesium$1['ShadowMode']['ENABLED']),this['_shadowMap']=this['_createShadowMap'](),this['_position']&&this['_updatePositionsHook'](),this['primitiveCollection'][_0x3bfecb(0x27b)](this),this['visibilitys']['set'](this['id'],this),this['_updateDraw'](),this['_updateSphereOutline']();}},{'key':'_createShadowMap','value':function _0xc0a0d9(){var _0x2cf978=_0x52fc73;return this['_shadowMap']&&(this['_shadowMap']['destroy'](),delete this['_shadowMap']),this['_camera']=new Cesium$1['Camera'](this['_map'][_0x2cf978(0x286)]),new Cesium$1[(_0x2cf978(0x294))]({'lightCamera':this['_camera'],'enable':![],'darkness':0x1,'isPointLight':!![],'isSpotLight':![],'cascadesEnabled':![],'context':this['_map']['scene']['context'],'pointLightRadius':this['style']['radius'],'fromLightSource':![]});}},{'key':_0x52fc73(0x23e),'value':function _0xca6b8e(){var _0x2fba5f=_0x52fc73;this['_hasTerrainShadows']&&(this[_0x2fba5f(0x26e)]['terrainShadows']=Cesium$1['ShadowMode']['DISABLED']),this['_shadowMap']&&(this[_0x2fba5f(0x283)]['destroy'](),delete this[_0x2fba5f(0x283)]),this['primitiveCollection']&&this[_0x2fba5f(0x253)][_0x2fba5f(0x26a)](this)&&(this['_noDestroy']=!![],this['primitiveCollection']['remove'](this),this[_0x2fba5f(0x216)]=![]),this['visibilitys']['remove'](this['id']),this['_updateDraw']();}},{'key':_0x52fc73(0x251),'value':function _0x3b9461(_0x217ce4){var _0x75704e=_0x52fc73;this[_0x75704e(0x283)]&&_0x217ce4[_0x75704e(0x243)][_0x75704e(0x249)](this['_shadowMap']);}},{'key':'_updateStyleHook','value':function _0xe10962(_0x5a235d,_0x1dce52){var _0x14a0d3=_0x52fc73;Cesium$1[_0x14a0d3(0x247)](_0x1dce52[_0x14a0d3(0x278)])&&(this['_visibleAreaColor']=getCesiumColor(this[_0x14a0d3(0x242)]['visibleAreaColor'],new Cesium$1['Color'](0x0,0x1,0x0))),Cesium$1['defined'](_0x1dce52['hiddenAreaColor'])&&(this[_0x14a0d3(0x24f)]=getCesiumColor(this['style'][_0x14a0d3(0x27a)],new Cesium$1[(_0x14a0d3(0x226))](0x1,0x0,0x0))),(Cesium$1['defined'](_0x1dce52['addHeight'])||Cesium$1['defined'](_0x1dce52['heading'])||Cesium$1['defined'](_0x1dce52['pitch'])||Cesium$1[_0x14a0d3(0x247)](_0x1dce52[_0x14a0d3(0x233)]))&&this['_updatePositionsHook'](),Cesium$1['defined'](_0x1dce52['radius'])&&this['_shadowMap']&&(this['_shadowMap']=this['_createShadowMap'](),this['_position']&&this['_updatePositionsHook']());}},{'key':_0x52fc73(0x27c),'value':function _0x1c762c(){var _0x668e89=_0x52fc73;if(!this['_map'])return;this[_0x668e89(0x28a)][_0x668e89(0x290)]&&(this['_map'][_0x668e89(0x286)][_0x668e89(0x201)]['remove'](this['visibilitys'][_0x668e89(0x290)]),delete this['visibilitys'][_0x668e89(0x290)]);}},{'key':_0x52fc73(0x1ef),'value':function _0x3b38dd(){var _0x2f30f0=_0x52fc73,_0xc7199a=this;if(!this['_map'])return;this['_clearDraw']();var _0x11286e=this['visibilitys'];if(_0x11286e[_0x2f30f0(0x221)]===0x0)return;var _0x420bc8,_0xde5920,_0x11de75,_0x40ebe2,_0x29f957;function _0x40443e(){var _0x410000=_0x2f30f0;_0x420bc8=[],_0xde5920=[],_0x11de75=[],_0x40ebe2=[],_0x29f957=[],_0x11286e[_0x410000(0x22f)](function(_0xf88252){var _0x14ab23=_0x410000,_0x23c2a7=_0xf88252['shadowMap'];if(!_0x23c2a7)return;_0xde5920['push'](_0xf88252[_0x14ab23(0x21a)]),_0x420bc8[_0x14ab23(0x249)](_0x23c2a7['_lightPositionEC']),_0x11de75['push'](_0x23c2a7['_shadowMapMatrix']);var _0x5b255f=_0x23c2a7[_0x14ab23(0x24d)]?_0x23c2a7[_0x14ab23(0x200)]:_0x23c2a7[_0x14ab23(0x212)];_0x40ebe2['push'](Cesium$1[_0x14ab23(0x23d)]['fromElements'](0x1/_0x23c2a7['_textureSize']['x'],0x1/_0x23c2a7['_textureSize']['y'],_0x5b255f['depthBias'],_0x5b255f['normalShadingSmooth'])),_0x29f957['push'](new Cesium$1['Cartesian2'](_0x23c2a7['_darkness'],_0xf88252['_visibility_type']));});}_0x40443e();var _0x371965={'lightPositionEC':function _0x12c8db(){return _0x40443e(),_0x420bc8;},'shadowMapMatrix':function _0x480776(){return _0x11de75;},'shadowMapTexelSizeDepthBiasAndNormalShadingSmooth':function _0x498bcd(){return _0x40ebe2;},'shadowMapDarknessType':function _0x53bbd3(){return _0x29f957;},'mars3d_opacity':function _0x4a3ff1(){var _0x2a89f7=_0x2f30f0;return _0xc7199a[_0x2a89f7(0x211)];},'mars3d_visibleAreaColor':function _0x45148b(){return _0xc7199a['visibleAreaColor'];},'mars3d_hiddenAreaColor':function _0x3b95ea(){return _0xc7199a['hiddenAreaColor'];}},_0x44128a=getVisibilityShadowMaps(_0x11286e,_0x371965),_0x54bac2=_0x44128a[_0x2f30f0(0x297)],_0x16c7ee=_0x44128a['shadowVisibilityShader'],_0x7f01e5=MultipleVisibilityShader['replace']('LightNumVlaue',_0x11286e[_0x2f30f0(0x221)]);_0x7f01e5=_0x7f01e5['replace'](_0x2f30f0(0x236),_0x54bac2),_0x7f01e5=_0x7f01e5['replace']('ShadowVisibilityShader',_0x16c7ee),this['visibilitys']['_postProcessStage']=new Cesium$1['PostProcessStage']({'sampleMode':Cesium$1['PostProcessStageSampleMode']['NEAREST'],'fragmentShader':_0x7f01e5,'uniforms':_0x371965}),this['_map']['scene']['postProcessStages']['add'](this['visibilitys']['_postProcessStage']);}},{'key':'_updateSphereOutline','value':function _0x453b61(){var _0x7e14b6=_0x52fc73;this['_cameraSphere']&&this[_0x7e14b6(0x280)]['primitiveCollection']['remove'](this[_0x7e14b6(0x22b)]);if(!this['position'])return;var _0x122cea=Cesium$1['Transforms']['eastNorthUpToFixedFrame'](this[_0x7e14b6(0x266)]),_0x25197f=new Cesium$1[(_0x7e14b6(0x296))]({'geometry':new Cesium$1[(_0x7e14b6(0x289))]({'radius':this['style'][_0x7e14b6(0x223)]}),'modelMatrix':_0x122cea,'attributes':{'color':Cesium$1['ColorGeometryInstanceAttribute']['fromColor'](Cesium$1[_0x7e14b6(0x226)]['WHITE'])}});this[_0x7e14b6(0x22b)]=this[_0x7e14b6(0x280)]['primitiveCollection'][_0x7e14b6(0x27b)](new Cesium$1['Primitive']({'geometryInstances':_0x25197f,'asynchronous':![],'appearance':new Cesium$1['PerInstanceColorAppearance']({'flat':!![],'renderState':{'lineWidth':0x1}})}));}},{'key':'_getDrawEntityClass','value':function _0x4406de(_0x2fd965,_0x4fb6cd){var _0x386c18=_0x52fc73;return this[_0x386c18(0x220)](_0x2fd965,_0x4fb6cd);}}]),_0x6565ec;}(BasePointPrimitive);register$1('pointVisibility',PointVisibility,!![]);function getVisibilityShadowMaps(_0x4c4004,_0x47edd){var _0x223608='',_0x14f3db='';return _0x4c4004['forEach'](function(_0x3c030c,_0x52f24e){var _0x971921=_0x1184;switch(_0x3c030c['_visibility_type']){case 0x1:_0x223608+=_0x971921(0x255)['concat'](_0x52f24e,';\x0a'),_0x14f3db+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20int\x20pointLightVisibility'['concat'](_0x52f24e,'\x20=\x20getPointVisibility(normalEC,\x20positionEC,\x20')['concat'](_0x52f24e,',\x20lightShadowMapCube')['concat'](_0x52f24e,');\x0a\x20\x20\x20\x20\x20\x20\x20\x20if(pointLightVisibility')['concat'](_0x52f24e,_0x971921(0x202))['concat'](_0x52f24e,'\x20==\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20visibility\x20+=\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'),_0x47edd['lightShadowMapCube'[_0x971921(0x1f4)](_0x52f24e)]=function(){var _0x32c6b3=_0x971921;return _0x3c030c[_0x32c6b3(0x254)][_0x32c6b3(0x206)];};break;case 0x2:_0x223608+=_0x971921(0x22e)['concat'](_0x52f24e,';\x0a'),_0x14f3db+=_0x971921(0x24b)['concat'](_0x52f24e,'\x20=\x20getFrustumVisibility(normalEC,\x20positionEC,\x20')['concat'](_0x52f24e,',\x20lightShadowMap2D')['concat'](_0x52f24e,');\x0a\x20\x20\x20\x20\x20\x20\x20\x20if(frustumVisibility')[_0x971921(0x1f4)](_0x52f24e,'\x20==\x201)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20inside\x20+=\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20if\x20(frustumVisibility')[_0x971921(0x1f4)](_0x52f24e,'\x20==\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20visibility\x20+=\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'),_0x47edd['lightShadowMap2D'[_0x971921(0x1f4)](_0x52f24e)]=function(){var _0x2bd136=_0x971921;return _0x3c030c[_0x2bd136(0x254)]['_shadowMapTexture'];};break;}}),{'uniformShader':_0x223608,'shadowVisibilityShader':_0x14f3db};}var Cesium=mars3d__namespace['Cesium'],LngLatPoint=mars3d__namespace['LngLatPoint'],ArcFrustum=mars3d__namespace['graphic']['ArcFrustum'],register=mars3d__namespace['GraphicUtil']['register'],addPositionsHeight=mars3d__namespace['PointUtil']['addPositionsHeight'],DEF_STYLE={'angle':0x3c,'angle2':0x2d,'radius':0x3e8,'showFrustum':![],'opacity':0.6},ConeVisibility=function(_0x1260a9){var _0x346d40=_0x3455a5;_inherits(_0x318257,_0x1260a9);var _0x44187e=_createSuper(_0x318257);function _0x318257(){var _0x35a543=_0x1184,_0x1faf12,_0x4dfca1=arguments[_0x35a543(0x221)]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{},_0x368a19=arguments['length']>0x1&&arguments[0x1]!==undefined?arguments[0x1]:!![];return _classCallCheck(this,_0x318257),_0x368a19&&(_0x4dfca1[_0x35a543(0x242)]=_objectSpread2(_objectSpread2({},DEF_STYLE),_0x4dfca1['style']||{})),_0x1faf12=_0x44187e[_0x35a543(0x273)](this,_0x4dfca1),_0x1faf12['_visibility_type']=0x2,_0x1faf12;}return _createClass(_0x318257,[{'key':_0x346d40(0x295),'get':function _0x6b8a9e(){var _0x44f2f2=_0x346d40;return this[_0x44f2f2(0x242)]['angle'];},'set':function _0x36a445(_0x336ef5){var _0x388e77=_0x346d40;this[_0x388e77(0x242)]['angle']=_0x336ef5,this[_0x388e77(0x1ef)]();}},{'key':_0x346d40(0x234),'get':function _0xc17aed(){var _0x443d8f=_0x346d40,_0xb11730;return(_0xb11730=this['style']['angle2'])!==null&&_0xb11730!==void 0x0?_0xb11730:this[_0x443d8f(0x242)]['angle'];},'set':function _0x2c8dee(_0x4a74c6){this['style']['angle2']=_0x4a74c6,this['_updateDraw']();}},{'key':'targetPosition','get':function _0x23a617(){var _0x5b95c1=_0x346d40;return this[_0x5b95c1(0x1fe)]['targetPosition'];},'set':function _0x458e52(_0x1ba5c8){var _0x3ea24f=_0x346d40,_0x40d6d4;this['options']['targetPosition']=_0x1ba5c8;if(!this['_map'])return;var _0xecb7fd=this['position'];if(!_0xecb7fd)return;var _0x21a06d=LngLatPoint['toCartesian'](_0x1ba5c8,(_0x40d6d4=this['_map'])===null||_0x40d6d4===void 0x0?void 0x0:_0x40d6d4['currentTime']);this['distance']=Cesium['Cartesian3']['distance'](_0xecb7fd,_0x21a06d);var _0xd55749=Cesium[_0x3ea24f(0x238)]['normalize'](Cesium['Cartesian3'][_0x3ea24f(0x262)](_0x21a06d,_0xecb7fd,new Cesium['Cartesian3']()),new Cesium['Cartesian3']()),_0x58f75a=Cesium[_0x3ea24f(0x238)][_0x3ea24f(0x217)](_0xecb7fd,new Cesium[(_0x3ea24f(0x238))]()),_0x1ce1fe=new Cesium['Camera'](this['_map']['scene']);_0x1ce1fe[_0x3ea24f(0x266)]=_0xecb7fd,_0x1ce1fe['direction']=_0xd55749,_0x1ce1fe['up']=_0x58f75a,this['style'][_0x3ea24f(0x205)]=Cesium[_0x3ea24f(0x276)]['toDegrees'](_0x1ce1fe[_0x3ea24f(0x205)]),this['style'][_0x3ea24f(0x22a)]=Cesium['Math']['toDegrees'](_0x1ce1fe[_0x3ea24f(0x22a)]),this[_0x3ea24f(0x1ef)]();}},{'key':'_mountedHook','value':function _0x375d07(){var _0x505bfe=_0x346d40;this['options'][_0x505bfe(0x292)]&&(this[_0x505bfe(0x292)]=this[_0x505bfe(0x1fe)]['targetPosition']),_get(_getPrototypeOf(_0x318257['prototype']),_0x505bfe(0x20c),this)[_0x505bfe(0x273)](this);}},{'key':_0x346d40(0x20f),'value':function _0x9333e0(){var _0x4dc4d8=_0x346d40,_0x4507b7=this[_0x4dc4d8(0x24a)];if(this['_camera']&&_0x4507b7){var _0x43a83e=this['getAddHeight']();_0x43a83e!==0x0&&(_0x4507b7=addPositionsHeight(_0x4507b7,_0x43a83e));this[_0x4dc4d8(0x20a)][_0x4dc4d8(0x266)]=_0x4507b7,this['_camera']['frustum']['fov']=Cesium['Math']['toRadians'](this['angle']*0x2),this['_camera']['frustum']['aspectRatio']=this[_0x4dc4d8(0x295)]/this['angle2'],this['_camera']['frustum'][_0x4dc4d8(0x20d)]=this[_0x4dc4d8(0x242)]['radius'];var _0x197ab0=new Cesium['HeadingPitchRoll'](Cesium['Math']['toRadians'](this['heading']),Cesium[_0x4dc4d8(0x276)][_0x4dc4d8(0x28d)](this['pitch']),Cesium['Math']['toRadians'](this['roll']));this['_camera'][_0x4dc4d8(0x25b)]({'destination':_0x4507b7,'orientation':{'heading':_0x197ab0['heading'],'pitch':_0x197ab0['pitch'],'roll':_0x197ab0['roll']}});}}},{'key':'_createShadowMap','value':function _0x1dd565(){var _0x28204b=_0x346d40,_0x527755;return this[_0x28204b(0x20a)]=new Cesium['Camera'](this['_map']['scene']),this['_camera']['frustum']['aspectRatio']=this['angle']/this[_0x28204b(0x234)],this[_0x28204b(0x20a)][_0x28204b(0x209)]['fov']=Cesium[_0x28204b(0x276)][_0x28204b(0x28d)](this['angle']*0x2),this['_camera']['frustum'][_0x28204b(0x222)]=0.01,this['_camera']['frustum']['far']=this['style']['radius'],new Cesium[(_0x28204b(0x294))]({'lightCamera':this['_camera'],'enable':![],'darkness':0x1,'isPointLight':![],'isSpotLight':!![],'cascadesEnabled':![],'context':this['_map']['scene'][_0x28204b(0x1fa)],'pointLightRadius':this[_0x28204b(0x242)]['radius'],'fromLightSource':![],'depthBiasStep':(_0x527755=this[_0x28204b(0x1fe)][_0x28204b(0x20e)])!==null&&_0x527755!==void 0x0?_0x527755:0x64});}},{'key':_0x346d40(0x204),'value':function _0x24376f(){var _0x5c141b=_0x346d40;this['_cameraSphere']&&this['_layer'][_0x5c141b(0x253)][_0x5c141b(0x21c)](this['_cameraSphere']),this['_frustumPrimitive']=new ArcFrustum({'modelMatrix':this['_camera']['inverseViewMatrix'],'style':{'angle':this['angle'],'angle2':this['angle2'],'distance':this[_0x5c141b(0x242)][_0x5c141b(0x223)]+0x1},'show':this['showFrustum']&&this[_0x5c141b(0x1f2)],'private':!![]}),this['_layer']['addGraphic'](this['_frustumPrimitive']);}}]),_0x318257;}(PointVisibility);register('coneVisibility',ConeVisibility,!![]);var next={'__proto__':null,'PointLight':PointLight,'SpotLight':SpotLight,'VolumeCloud':VolumeCloud,'PointVisibility':PointVisibility,'ConeVisibility':ConeVisibility};mars3d__namespace[_0x3455a5(0x232)]=next;
}));
