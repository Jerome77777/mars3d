/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.5.1
 * 编译日期：2023-03-29 10:02:24
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x1a8bc1=_0x265e;(function(_0x12ac27,_0x512fc7){var _0x3a1599=_0x265e,_0x4f1501=_0x12ac27();while(!![]){try{var _0xd4195e=-parseInt(_0x3a1599(0x28b))/0x1*(-parseInt(_0x3a1599(0x2b3))/0x2)+parseInt(_0x3a1599(0x204))/0x3+-parseInt(_0x3a1599(0x26e))/0x4*(parseInt(_0x3a1599(0x290))/0x5)+-parseInt(_0x3a1599(0x208))/0x6+-parseInt(_0x3a1599(0x249))/0x7*(-parseInt(_0x3a1599(0x2da))/0x8)+-parseInt(_0x3a1599(0x1f0))/0x9*(parseInt(_0x3a1599(0x29c))/0xa)+parseInt(_0x3a1599(0x24e))/0xb;if(_0xd4195e===_0x512fc7)break;else _0x4f1501['push'](_0x4f1501['shift']());}catch(_0xa856ba){_0x4f1501['push'](_0x4f1501['shift']());}}}(_0x3efc,0x7ae30));function _interopNamespace(_0x4505ef){if(_0x4505ef&&_0x4505ef['__esModule'])return _0x4505ef;var _0x34fb77=Object['create'](null);return _0x4505ef&&Object['keys'](_0x4505ef)['forEach'](function(_0x4be4cf){var _0x2a51fc=_0x265e;if(_0x4be4cf!==_0x2a51fc(0x2b4)){var _0x1a33a3=Object['getOwnPropertyDescriptor'](_0x4505ef,_0x4be4cf);Object[_0x2a51fc(0x2b6)](_0x34fb77,_0x4be4cf,_0x1a33a3['get']?_0x1a33a3:{'enumerable':!![],'get':function(){return _0x4505ef[_0x4be4cf];}});}}),_0x34fb77['default']=_0x4505ef,_0x34fb77;}function _0x3efc(){var _0x57c1e2=['destroy','RGBA','BoundingSphere','PixelDatatype','getUVByPoint','dimensions','getParticles','particleSystem','colorTable','LUMINANCE','0px','outputTexture','toRadians','_drawLines','Compute','ShaderProgram','age','fromGeometry','uniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0auniform\x20float\x20dropRate;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0auniform\x20float\x20dropRateBump;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0,\x201.0);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0);\x0a\x20\x20\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20lev);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20\x20\x20return\x20particle.y\x20<\x20-90.0\x20||\x20particle.y\x20>\x2090.0;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20nextSpeed.a;\x0a\x0a\x20\x20\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20\x20\x20if\x20(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(randomParticle,\x201.0);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a\x20\x20\x20\x20}\x0a}\x0a','primitives','LayerUtil','STATIC_DRAW','particlesComputing','_data','canvasHeight','_updateIng','clientWidth','tlng','pixelSize','getColorTexture','defined','windField','frameTime','randomBetween','function','commandList','lev','_addedHook','colors','apply','clientHeight','this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called','fromCssColorString','latRange','fillRect','log','reverse','DISABLE_GL_POSITION_LOG_DEPTH','xmin','TextureMinificationFilter','now','none','mod','register','lonRange','segmentsDepth','configurable','_setOptionsHook','viewport','Pass','19537MHzdsv','nextParticlesPosition','EventType','_map','show','15384424LWpxHI','length','createRenderingFramebuffers','geometry','drawingBufferWidth','style','segments','textures','cols','globalCompositeOperation','randomizeParticles','tlat','toGridXY','_onMap_preRenderEvent','lat','_randomParticle','pointerEvents','particlesTextureSize','primitiveType','blending','_calcUV','array','reverseY','shaderProgram','fromCache','setOptions','fixedHeight','vdata','getOptions','_tomap','Framebuffer','clampToLatitudeRange','2349124KPTEhP','OPAQUE','100%','createParticlesTextures','BufferUsage','layer','_onMouseUpEvent','initWorker','max','ymin','atan2','vertexShaderSource','levmax','speedRate','refreshTimer','addEventListener','Math','Sampler','clearFramebuffers','nextTrailsColor','mouseMove','globeBoundingSphere','refreshParticles','clear','requestAnimationFrame','toDegrees','CanvasWindLayer','createFramebuffer','udata','1277gkhVQn','autoClear','lng','uniformMap','commandToExecute','5PYBbka','attributeLocations','preRender','_onMouseDownEvent','TWO_PI','THREE_PI_OVER_TWO','particlesTextures','setDate','segmentsColor','particlesNumber','cos','currentTrails','170fYjKRd','GeometryAttribute','lineWidth','PrimitiveType','createRenderingTextures','Cartesian2','redraw','off','nextTrailsDepth','getWind','visibility','rows','postMessage','fromDegrees','uniform\x20sampler2D\x20colorTable;\x0a\x0ain\x20float\x20speedNormalization;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x200.0));\x0a}\x0a','container','nextTrails','worker','canvasContext','keys','filter','getOwnPropertySymbols','getOwnPropertyDescriptors','1214FZLqeU','default','mouseUp','defineProperty','particles','framebuffers','context','mouse_move','particlesRendering','@@iterator','createTexture','color','getPixelSize','options','preExecute','DEPTH_COMPONENT','undefined','mouse_down','postProcessingPosition','TextureMagnificationFilter','createRenderingPrimitives','enumerable','_pointerEvents','createRawRenderState','FLOAT','PI_OVER_THREE','abs','getContext','dropRate','windTextures','setData','resize','ComputeCommand','getUVByXY','xmax','min','scene','animateFrame','fadeOpacity','192cPjPTS','EllipsoidalOccluder','screen','uniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20\x20\x20float\x20term1\x20=\x20111132.92;\x0a\x20\x20\x20\x20float\x20term2\x20=\x20559.82\x20*\x20cos(2.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term3\x20=\x201.175\x20*\x20cos(4.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term4\x20=\x200.0023\x20*\x20cos(6.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20\x20\x20float\x20term5\x20=\x20111412.84\x20*\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20term6\x20=\x2093.5\x20*\x20cos(3.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term7\x20=\x200.118\x20*\x20cos(5.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avoid\x20updatePosition(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20windVectorInLonLatLev;\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20speed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20updatePosition(lonLatLev,\x20speed);\x0a}\x0a','remove','umin','globe','arrayBufferView','visible','Map','height','updateSpeed','_updateIng2','framebuffer','grid','viewerParameters','VertexArray','_onMapWhellEvent','mouseDown','_calc_speedRate','ymax','canvas','create','mouseHidden','postProcessingSpeed','maxAge','clearCommand','camera','canvasWidth','execute','slice','random','updateViewerParameters','auto','_onMouseMoveEvent','ShaderSource','274563cLBvFA','call','floor','windData','maxParticles','updatePosition','ClearCommand','Appearance','string','construct','lon','WindLayer','DISABLE_LOG_DEPTH_FRAGMENT_WRITE','update','add','data','isPointVisible','Cartesian3','hidden','forEach','868596mzNhUl','push','round','isInExtent','5525970VMtkcq','ComponentDatatype','createComputingPrimitives','Cesium','_speedRate'];_0x3efc=function(){return _0x57c1e2;};return _0x3efc();}var mars3d__namespace=_interopNamespace(mars3d),Cesium$7=mars3d__namespace['Cesium'];function getU(_0x39b10b,_0x5d0b3e){var _0xcdfdbc=_0x265e,_0x1e5162=_0x39b10b*Math[_0xcdfdbc(0x29a)](Cesium$7['Math'][_0xcdfdbc(0x219)](_0x5d0b3e));return _0x1e5162;}function getV(_0xb1389a,_0x31667b){var _0x10bbb9=_0x265e,_0x26fb7e=_0xb1389a*Math['sin'](Cesium$7[_0x10bbb9(0x27e)]['toRadians'](_0x31667b));return _0x26fb7e;}function getSpeed(_0x2bfd97,_0x505720){var _0x35cb34=Math['sqrt'](Math['pow'](_0x2bfd97,0x2)+Math['pow'](_0x505720,0x2));return _0x35cb34;}function getDirection(_0x4ad211,_0x7a3732){var _0xa9c8d8=_0x265e,_0x1bf64b=Cesium$7[_0xa9c8d8(0x27e)]['toDegrees'](Math[_0xa9c8d8(0x278)](_0x7a3732,_0x4ad211));return _0x1bf64b+=_0x1bf64b<0x0?0x168:0x0,_0x1bf64b;}var WindUtil={'__proto__':null,'getU':getU,'getV':getV,'getSpeed':getSpeed,'getDirection':getDirection};function ownKeys(_0x50bdb4,_0x5786a3){var _0x2a3791=_0x265e,_0x2c388b=Object['keys'](_0x50bdb4);if(Object['getOwnPropertySymbols']){var _0x589edd=Object[_0x2a3791(0x2b1)](_0x50bdb4);_0x5786a3&&(_0x589edd=_0x589edd[_0x2a3791(0x2b0)](function(_0x45e98c){var _0x13172f=_0x2a3791;return Object['getOwnPropertyDescriptor'](_0x50bdb4,_0x45e98c)[_0x13172f(0x2c8)];})),_0x2c388b['push']['apply'](_0x2c388b,_0x589edd);}return _0x2c388b;}function _objectSpread2(_0x17dd99){var _0x43d5fe=_0x265e;for(var _0x1905a3=0x1;_0x1905a3<arguments[_0x43d5fe(0x24f)];_0x1905a3++){var _0x47fc09=null!=arguments[_0x1905a3]?arguments[_0x1905a3]:{};_0x1905a3%0x2?ownKeys(Object(_0x47fc09),!0x0)['forEach'](function(_0x5df942){_defineProperty(_0x17dd99,_0x5df942,_0x47fc09[_0x5df942]);}):Object[_0x43d5fe(0x2b2)]?Object['defineProperties'](_0x17dd99,Object[_0x43d5fe(0x2b2)](_0x47fc09)):ownKeys(Object(_0x47fc09))['forEach'](function(_0x528f0b){var _0x3e0a8f=_0x43d5fe;Object[_0x3e0a8f(0x2b6)](_0x17dd99,_0x528f0b,Object['getOwnPropertyDescriptor'](_0x47fc09,_0x528f0b));});}return _0x17dd99;}function _classCallCheck(_0x507e49,_0xf5a032){if(!(_0x507e49 instanceof _0xf5a032))throw new TypeError('Cannot\x20call\x20a\x20class\x20as\x20a\x20function');}function _defineProperties(_0xb9814c,_0x1df279){var _0x75b80b=_0x265e;for(var _0x203e40=0x0;_0x203e40<_0x1df279['length'];_0x203e40++){var _0x44e176=_0x1df279[_0x203e40];_0x44e176['enumerable']=_0x44e176['enumerable']||![],_0x44e176[_0x75b80b(0x245)]=!![];if('value'in _0x44e176)_0x44e176['writable']=!![];Object[_0x75b80b(0x2b6)](_0xb9814c,_0x44e176['key'],_0x44e176);}}function _createClass(_0x47e349,_0x385336,_0x35b110){if(_0x385336)_defineProperties(_0x47e349['prototype'],_0x385336);if(_0x35b110)_defineProperties(_0x47e349,_0x35b110);return Object['defineProperty'](_0x47e349,'prototype',{'writable':![]}),_0x47e349;}function _defineProperty(_0x3d589d,_0x57ba67,_0x435a14){var _0x1138c8=_0x265e;return _0x57ba67 in _0x3d589d?Object[_0x1138c8(0x2b6)](_0x3d589d,_0x57ba67,{'value':_0x435a14,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x3d589d[_0x57ba67]=_0x435a14,_0x3d589d;}function _inherits(_0x28ce7a,_0xafad2e){var _0x107ae0=_0x265e;if(typeof _0xafad2e!==_0x107ae0(0x22f)&&_0xafad2e!==null)throw new TypeError('Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function');_0x28ce7a['prototype']=Object[_0x107ae0(0x1e2)](_0xafad2e&&_0xafad2e['prototype'],{'constructor':{'value':_0x28ce7a,'writable':!![],'configurable':!![]}}),Object['defineProperty'](_0x28ce7a,'prototype',{'writable':![]});if(_0xafad2e)_setPrototypeOf(_0x28ce7a,_0xafad2e);}function _getPrototypeOf(_0x4427c2){return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf']:function _0x357b2d(_0x1cef46){return _0x1cef46['__proto__']||Object['getPrototypeOf'](_0x1cef46);},_getPrototypeOf(_0x4427c2);}function _setPrototypeOf(_0x2f61e5,_0x56d4b3){return _setPrototypeOf=Object['setPrototypeOf']||function _0x314444(_0x4e0628,_0x4cf191){return _0x4e0628['__proto__']=_0x4cf191,_0x4e0628;},_setPrototypeOf(_0x2f61e5,_0x56d4b3);}function _isNativeReflectConstruct(){var _0x342b03=_0x265e;if(typeof Reflect==='undefined'||!Reflect['construct'])return![];if(Reflect['construct']['sham'])return![];if(typeof Proxy==='function')return!![];try{return Boolean['prototype']['valueOf'][_0x342b03(0x1f1)](Reflect['construct'](Boolean,[],function(){})),!![];}catch(_0x27bae4){return![];}}function _assertThisInitialized(_0x2ac87a){var _0x5bf8d3=_0x265e;if(_0x2ac87a===void 0x0)throw new ReferenceError(_0x5bf8d3(0x236));return _0x2ac87a;}function _0x265e(_0xf6c9eb,_0x2ceaba){var _0x3efc6e=_0x3efc();return _0x265e=function(_0x265e45,_0x464129){_0x265e45=_0x265e45-0x1d9;var _0x4c4b46=_0x3efc6e[_0x265e45];return _0x4c4b46;},_0x265e(_0xf6c9eb,_0x2ceaba);}function _possibleConstructorReturn(_0x3d1aa5,_0x288d03){if(_0x288d03&&(typeof _0x288d03==='object'||typeof _0x288d03==='function'))return _0x288d03;else{if(_0x288d03!==void 0x0)throw new TypeError('Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined');}return _assertThisInitialized(_0x3d1aa5);}function _createSuper(_0x5642e3){var _0x3585e6=_isNativeReflectConstruct();return function _0x101257(){var _0x557388=_0x265e,_0x4cfbe8=_getPrototypeOf(_0x5642e3),_0x53a8ea;if(_0x3585e6){var _0x153e72=_getPrototypeOf(this)['constructor'];_0x53a8ea=Reflect[_0x557388(0x1f9)](_0x4cfbe8,arguments,_0x153e72);}else _0x53a8ea=_0x4cfbe8[_0x557388(0x234)](this,arguments);return _possibleConstructorReturn(this,_0x53a8ea);};}function _toConsumableArray(_0x44b4c1){return _arrayWithoutHoles(_0x44b4c1)||_iterableToArray(_0x44b4c1)||_unsupportedIterableToArray(_0x44b4c1)||_nonIterableSpread();}function _arrayWithoutHoles(_0x113dd2){if(Array['isArray'](_0x113dd2))return _arrayLikeToArray(_0x113dd2);}function _iterableToArray(_0x2a402c){var _0x255b18=_0x265e;if(typeof Symbol!==_0x255b18(0x2c3)&&_0x2a402c[Symbol['iterator']]!=null||_0x2a402c[_0x255b18(0x2bc)]!=null)return Array['from'](_0x2a402c);}function _unsupportedIterableToArray(_0xb9c426,_0x4c34e5){var _0x523da3=_0x265e;if(!_0xb9c426)return;if(typeof _0xb9c426===_0x523da3(0x1f8))return _arrayLikeToArray(_0xb9c426,_0x4c34e5);var _0x361303=Object['prototype']['toString']['call'](_0xb9c426)[_0x523da3(0x1ea)](0x8,-0x1);if(_0x361303==='Object'&&_0xb9c426['constructor'])_0x361303=_0xb9c426['constructor']['name'];if(_0x361303===_0x523da3(0x2e3)||_0x361303==='Set')return Array['from'](_0xb9c426);if(_0x361303==='Arguments'||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/['test'](_0x361303))return _arrayLikeToArray(_0xb9c426,_0x4c34e5);}function _arrayLikeToArray(_0x2c3a73,_0x2e161b){var _0xb799f=_0x265e;if(_0x2e161b==null||_0x2e161b>_0x2c3a73['length'])_0x2e161b=_0x2c3a73[_0xb799f(0x24f)];for(var _0x383505=0x0,_0x3f9f44=new Array(_0x2e161b);_0x383505<_0x2e161b;_0x383505++)_0x3f9f44[_0x383505]=_0x2c3a73[_0x383505];return _0x3f9f44;}function _nonIterableSpread(){throw new TypeError('Invalid\x20attempt\x20to\x20spread\x20non-iterable\x20instance.\x0aIn\x20order\x20to\x20be\x20iterable,\x20non-array\x20objects\x20must\x20have\x20a\x20[Symbol.iterator]()\x20method.');}var Cesium$6=mars3d__namespace['Cesium'],CustomPrimitive=(function(){function _0x56a90f(_0x256006){var _0x1b3e36=_0x265e,_0x1e8420;_classCallCheck(this,_0x56a90f),this['commandType']=_0x256006['commandType'],this[_0x1b3e36(0x251)]=_0x256006['geometry'],this[_0x1b3e36(0x291)]=_0x256006['attributeLocations'],this[_0x1b3e36(0x260)]=_0x256006['primitiveType'],this[_0x1b3e36(0x28e)]=_0x256006[_0x1b3e36(0x28e)],this['vertexShaderSource']=_0x256006[_0x1b3e36(0x279)],this['fragmentShaderSource']=_0x256006['fragmentShaderSource'],this['rawRenderState']=_0x256006['rawRenderState'],this['framebuffer']=_0x256006[_0x1b3e36(0x1d9)],this['outputTexture']=_0x256006['outputTexture'],this[_0x1b3e36(0x28c)]=(_0x1e8420=_0x256006['autoClear'])!==null&&_0x1e8420!==void 0x0?_0x1e8420:![],this['preExecute']=_0x256006['preExecute'],this['show']=!![],this['commandToExecute']=undefined,this['clearCommand']=undefined,this['autoClear']&&(this['clearCommand']=new Cesium$6[(_0x1b3e36(0x1f6))]({'color':new Cesium$6['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Cesium$6['Pass'][_0x1b3e36(0x26f)]}));}return _createClass(_0x56a90f,[{'key':'createCommand','value':function _0x2391c3(_0x2a1f26){var _0x20d814=_0x265e;switch(this['commandType']){case'Draw':{var _0x127168=Cesium$6['VertexArray']['fromGeometry']({'context':_0x2a1f26,'geometry':this['geometry'],'attributeLocations':this[_0x20d814(0x291)],'bufferUsage':Cesium$6['BufferUsage'][_0x20d814(0x222)]}),_0xf0833f=Cesium$6[_0x20d814(0x21c)][_0x20d814(0x266)]({'context':_0x2a1f26,'attributeLocations':this['attributeLocations'],'vertexShaderSource':this[_0x20d814(0x279)],'fragmentShaderSource':this['fragmentShaderSource']}),_0x219e54=Cesium$6['RenderState'][_0x20d814(0x266)](this['rawRenderState']);return new Cesium$6['DrawCommand']({'primitiveType':this[_0x20d814(0x260)],'shaderProgram':_0xf0833f,'vertexArray':_0x127168,'modelMatrix':Cesium$6['Matrix4']['IDENTITY'],'renderState':_0x219e54,'uniformMap':this['uniformMap'],'castShadows':![],'receiveShadows':![],'framebuffer':this[_0x20d814(0x1d9)],'pass':Cesium$6['Pass']['OPAQUE'],'pickOnly':!![],'owner':this});}case _0x20d814(0x21b):{return new Cesium$6[(_0x20d814(0x2d3))]({'owner':this,'fragmentShaderSource':this['fragmentShaderSource'],'uniformMap':this['uniformMap'],'outputTexture':this['outputTexture'],'persists':!![]});}}}},{'key':'setGeometry','value':function _0x3d8b9e(_0x197877,_0xf7d2a9){var _0x354d52=_0x265e;this['geometry']=_0xf7d2a9;var _0x32ed6d=Cesium$6[_0x354d52(0x1dc)][_0x354d52(0x21e)]({'context':_0x197877,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6[_0x354d52(0x272)]['STATIC_DRAW']});this['commandToExecute']['vertexArray']=_0x32ed6d;}},{'key':'update','value':function _0x35bee2(_0x2924c7){var _0x10667d=_0x265e;if(!this['show'])return;if(_0x2924c7['mode']!==Cesium$6['SceneMode']['SCENE3D'])return;!Cesium$6['defined'](this['commandToExecute'])&&(this[_0x10667d(0x28f)]=this['createCommand'](_0x2924c7['context'])),Cesium$6['defined'](this[_0x10667d(0x2c1)])&&this[_0x10667d(0x2c1)](),Cesium$6[_0x10667d(0x22b)](this['clearCommand'])&&_0x2924c7[_0x10667d(0x230)]['push'](this['clearCommand']),_0x2924c7[_0x10667d(0x230)]['push'](this['commandToExecute']);}},{'key':'isDestroyed','value':function _0x1026bc(){return![];}},{'key':'destroy','value':function _0x4730a2(){var _0x1e938b=_0x265e;if(this['clearCommand']){var _0x5304a2,_0x26e5dc;(_0x5304a2=this['clearCommand'])!==null&&_0x5304a2!==void 0x0&&_0x5304a2['vertexArray']&&this['clearCommand']['vertexArray']['destroy'](),(_0x26e5dc=this['clearCommand'])!==null&&_0x26e5dc!==void 0x0&&_0x26e5dc['shaderProgram']&&this['clearCommand'][_0x1e938b(0x265)]['destroy'](),delete this['clearCommand'];}return this['commandToExecute']&&(this['commandToExecute']['vertexArray']&&this[_0x1e938b(0x28f)]['vertexArray']['destroy'](),this['commandToExecute']['shaderProgram']&&this[_0x1e938b(0x28f)]['shaderProgram'][_0x1e938b(0x20d)](),delete this['commandToExecute']),Cesium$6['destroyObject'](this);}}]),_0x56a90f;}()),Cesium$5=mars3d__namespace['Cesium'],Util=(function(){var _0x243bc2=function _0x53c0d0(){var _0x156e4d=_0x265e,_0x30aee4=new Cesium$5['Geometry']({'attributes':new Cesium$5['GeometryAttributes']({'position':new Cesium$5[(_0x156e4d(0x29d))]({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype'][_0x156e4d(0x2cb)],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});return _0x30aee4;},_0x3790f6=function _0x244faf(_0x3bd413,_0x5ceb6e){var _0x48c1ed=_0x265e;if(Cesium$5['defined'](_0x5ceb6e)){var _0x677035={};_0x677035[_0x48c1ed(0x2e1)]=_0x5ceb6e,_0x3bd413['source']=_0x677035;}var _0x3558c6=new Cesium$5['Texture'](_0x3bd413);return _0x3558c6;},_0x5dab7a=function _0x410fde(_0x566dc8,_0x13c65c,_0x338d62){var _0x1263ea=_0x265e,_0x154f83=new Cesium$5[(_0x1263ea(0x26c))]({'context':_0x566dc8,'colorTextures':[_0x13c65c],'depthTexture':_0x338d62});return _0x154f83;},_0x26a165=function _0x5a32b5(_0x31839a){var _0x52f9d1=_0x265e,_0x1c6f89=!![],_0x1405ca=![],_0x5c57ed={'viewport':_0x31839a[_0x52f9d1(0x247)],'depthTest':_0x31839a['depthTest'],'depthMask':_0x31839a['depthMask'],'blending':_0x31839a[_0x52f9d1(0x261)]},_0x58f6d1=Cesium$5[_0x52f9d1(0x1f7)]['getDefaultRenderState'](_0x1c6f89,_0x1405ca,_0x5c57ed);return _0x58f6d1;},_0xfdf8cc=function _0x1201d9(_0x2f7ab0){var _0x55c822=_0x265e,_0x1f6280={},_0x173546=Cesium$5[_0x55c822(0x27e)]['mod'](_0x2f7ab0['west'],Cesium$5['Math'][_0x55c822(0x294)]),_0x354989=Cesium$5['Math'][_0x55c822(0x241)](_0x2f7ab0['east'],Cesium$5[_0x55c822(0x27e)][_0x55c822(0x294)]),_0x1d1d89=_0x2f7ab0['width'],_0x58558a,_0x30cdee;_0x1d1d89>Cesium$5[_0x55c822(0x27e)][_0x55c822(0x295)]?(_0x58558a=0x0,_0x30cdee=Cesium$5['Math']['TWO_PI']):_0x354989-_0x173546<_0x1d1d89?(_0x58558a=_0x173546,_0x30cdee=_0x173546+_0x1d1d89):(_0x58558a=_0x173546,_0x30cdee=_0x354989);_0x1f6280['lon']={'min':Cesium$5['Math']['toDegrees'](_0x58558a),'max':Cesium$5['Math']['toDegrees'](_0x30cdee)};var _0x313a26=_0x2f7ab0['south'],_0x86b143=_0x2f7ab0['north'],_0x1e6bec=_0x2f7ab0['height'],_0xb49bb4=_0x1e6bec>Cesium$5['Math']['PI']/0xc?_0x1e6bec/0x2:0x0,_0x1f1ebd=Cesium$5[_0x55c822(0x27e)][_0x55c822(0x26d)](_0x313a26-_0xb49bb4),_0x40f83f=Cesium$5[_0x55c822(0x27e)]['clampToLatitudeRange'](_0x86b143+_0xb49bb4);return _0x1f1ebd<-Cesium$5[_0x55c822(0x27e)][_0x55c822(0x2cc)]&&(_0x1f1ebd=-Cesium$5[_0x55c822(0x27e)]['PI_OVER_TWO']),_0x40f83f>Cesium$5['Math']['PI_OVER_THREE']&&(_0x40f83f=Cesium$5['Math']['PI_OVER_TWO']),_0x1f6280['lat']={'min':Cesium$5['Math']['toDegrees'](_0x1f1ebd),'max':Cesium$5['Math'][_0x55c822(0x287)](_0x40f83f)},_0x1f6280;};return{'getFullscreenQuad':_0x243bc2,'createTexture':_0x3790f6,'createFramebuffer':_0x5dab7a,'createRawRenderState':_0x26a165,'viewRectangleToLonLatRange':_0xfdf8cc};}()),segmentDraw_vert='in\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20normal\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20postProcessingSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0aout\x20float\x20speedNormalization;\x0a\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20\x20\x20float\x20a\x20=\x206378137.0;\x20//\x20Semi-major\x20axis\x0a\x20\x20\x20\x20float\x20b\x20=\x206356752.3142;\x20//\x20Semi-minor\x20axis\x0a\x20\x20\x20\x20float\x20e2\x20=\x206.69437999014e-3;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x0a\x20\x20\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calcProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0,\x20360.0)\x20-\x20180.0;\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0);\x0a\x20\x20\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calcOffset(vec4\x20currentProjectedCoordinate,\x20vec4\x20nextProjectedCoordinate,\x20float\x20offsetSign)\x20{\x0a\x20\x20\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0);\x0a\x20\x20\x20\x20vec2\x20currentXY\x20=\x20(currentProjectedCoordinate.xy\x20/\x20currentProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x20\x20\x20\x20vec2\x20nextXY\x20=\x20(nextProjectedCoordinate.xy\x20/\x20nextProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0;\x0a\x20\x20\x20\x20vec2\x20direction\x20=\x20normalize(nextXY\x20-\x20currentXY);\x0a\x20\x20\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0,\x200.0);\x0a\x20\x20\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20\x20\x20vec4\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex);\x0a\x0a\x20\x20\x20\x20vec4\x20currentProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20vec4\x20nextProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(nextPosition.w\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(nextPosition.xyz);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20float\x20pointToUse\x20=\x20normal.x;\x20//\x20-1\x20is\x20currentProjectedCoordinate\x20and\x20+1\x20is\x20nextProjectedCoordinate\x0a\x20\x20\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20pixelSize\x20*\x20calcOffset(currentProjectedCoordinate,\x20nextProjectedCoordinate,\x20offsetSign);\x0a\x20\x20\x20\x20if\x20(pointToUse\x20<\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20currentProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20nextProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20speedNormalization\x20=\x20texture(postProcessingSpeed,\x20particleIndex).a;\x0a}\x0a',segmentDraw_frag=_0x1a8bc1(0x2aa),fullscreen_vert='in\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(position,\x201.0);\x0a}\x0a',trailDraw_frag='uniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x0a\x20\x20\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0\x20*\x20trailsColor)\x20/\x20255.0;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20pointsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20trailsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a',screenDraw_frag='uniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20trailsColor;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x0a}\x0a',Cesium$4=mars3d__namespace['Cesium'],ParticlesRendering=(function(){var _0xd96b39=_0x1a8bc1;function _0xf84a2f(_0x3af34f,_0x26a2a6,_0x666d8,_0x225f7d,_0x1b3db4){var _0x22c4b3=_0x265e;_classCallCheck(this,_0xf84a2f),this['createRenderingTextures'](_0x3af34f,_0x26a2a6,_0x666d8['colors']),this[_0x22c4b3(0x250)](_0x3af34f),this['createRenderingPrimitives'](_0x3af34f,_0x666d8,_0x225f7d,_0x1b3db4);}return _createClass(_0xf84a2f,[{'key':_0xd96b39(0x2a0),'value':function _0x5607e3(_0x5b2487,_0x3cf0da,_0x7844f2){var _0x51061c=_0xd96b39,_0x104fd0={'context':_0x5b2487,'width':_0x5b2487['drawingBufferWidth'],'height':_0x5b2487['drawingBufferHeight'],'pixelFormat':Cesium$4['PixelFormat'][_0x51061c(0x20e)],'pixelDatatype':Cesium$4['PixelDatatype']['UNSIGNED_BYTE']},_0x5815b9={'context':_0x5b2487,'width':_0x5b2487['drawingBufferWidth'],'height':_0x5b2487['drawingBufferHeight'],'pixelFormat':Cesium$4['PixelFormat'][_0x51061c(0x2c2)],'pixelDatatype':Cesium$4[_0x51061c(0x210)]['UNSIGNED_INT']},_0x363e13=_0x7844f2['length'],_0x4383c7=new Float32Array(_0x363e13*0x3);for(var _0x94282b=0x0;_0x94282b<_0x363e13;_0x94282b++){var _0x3056af=Cesium$4['Color'][_0x51061c(0x237)](_0x7844f2[_0x94282b]);_0x4383c7[0x3*_0x94282b]=_0x3056af['red'],_0x4383c7[0x3*_0x94282b+0x1]=_0x3056af['green'],_0x4383c7[0x3*_0x94282b+0x2]=_0x3056af['blue'];}var _0x1f5cc9={'context':_0x5b2487,'width':_0x363e13,'height':0x1,'pixelFormat':Cesium$4['PixelFormat']['RGB'],'pixelDatatype':Cesium$4['PixelDatatype']['FLOAT'],'sampler':new Cesium$4[(_0x51061c(0x27f))]({'minificationFilter':Cesium$4[_0x51061c(0x23e)]['LINEAR'],'magnificationFilter':Cesium$4[_0x51061c(0x2c6)]['LINEAR']})};this['textures']={'segmentsColor':Util['createTexture'](_0x104fd0),'segmentsDepth':Util['createTexture'](_0x5815b9),'currentTrailsColor':Util['createTexture'](_0x104fd0),'currentTrailsDepth':Util['createTexture'](_0x5815b9),'nextTrailsColor':Util['createTexture'](_0x104fd0),'nextTrailsDepth':Util['createTexture'](_0x5815b9),'colorTable':Util[_0x51061c(0x2bd)](_0x1f5cc9,_0x4383c7)};}},{'key':_0xd96b39(0x250),'value':function _0x3521fd(_0x2e0b2a){var _0x38299b=_0xd96b39;this['framebuffers']={'segments':Util[_0x38299b(0x289)](_0x2e0b2a,this[_0x38299b(0x255)]['segmentsColor'],this['textures']['segmentsDepth']),'currentTrails':Util[_0x38299b(0x289)](_0x2e0b2a,this[_0x38299b(0x255)]['currentTrailsColor'],this[_0x38299b(0x255)]['currentTrailsDepth']),'nextTrails':Util['createFramebuffer'](_0x2e0b2a,this[_0x38299b(0x255)][_0x38299b(0x281)],this['textures'][_0x38299b(0x2a4)])};}},{'key':'createSegmentsGeometry','value':function _0x41d93d(_0x523a44){var _0x38c7ae=_0xd96b39,_0x40daf=0x4,_0x60e702=[];for(var _0x1a6d16=0x0;_0x1a6d16<_0x523a44['particlesTextureSize'];_0x1a6d16++){for(var _0x3b63f0=0x0;_0x3b63f0<_0x523a44['particlesTextureSize'];_0x3b63f0++){for(var _0x59b050=0x0;_0x59b050<_0x40daf;_0x59b050++){_0x60e702['push'](_0x1a6d16/_0x523a44[_0x38c7ae(0x25f)]),_0x60e702['push'](_0x3b63f0/_0x523a44['particlesTextureSize']);}}}_0x60e702=new Float32Array(_0x60e702);var _0xe8c467=[],_0x468dd6=[-0x1,0x1],_0x170e51=[-0x1,0x1];for(var _0x2817a7=0x0;_0x2817a7<_0x523a44['maxParticles'];_0x2817a7++){for(var _0x568876=0x0;_0x568876<_0x40daf/0x2;_0x568876++){for(var _0x302fa1=0x0;_0x302fa1<_0x40daf/0x2;_0x302fa1++){_0xe8c467['push'](_0x468dd6[_0x568876]),_0xe8c467[_0x38c7ae(0x205)](_0x170e51[_0x302fa1]),_0xe8c467['push'](0x0);}}}_0xe8c467=new Float32Array(_0xe8c467);var _0x3dd1c8=0x6*_0x523a44['maxParticles'],_0x2d9619=new Uint32Array(_0x3dd1c8);for(var _0x3d2ed0=0x0,_0x34c0f6=0x0,_0x3dd4da=0x0;_0x3d2ed0<_0x523a44['maxParticles'];_0x3d2ed0++){_0x2d9619[_0x34c0f6++]=_0x3dd4da+0x0,_0x2d9619[_0x34c0f6++]=_0x3dd4da+0x1,_0x2d9619[_0x34c0f6++]=_0x3dd4da+0x2,_0x2d9619[_0x34c0f6++]=_0x3dd4da+0x2,_0x2d9619[_0x34c0f6++]=_0x3dd4da+0x1,_0x2d9619[_0x34c0f6++]=_0x3dd4da+0x3,_0x3dd4da+=0x4;}var _0x5fe997=new Cesium$4['Geometry']({'attributes':new Cesium$4['GeometryAttributes']({'st':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype'][_0x38c7ae(0x2cb)],'componentsPerAttribute':0x2,'values':_0x60e702}),'normal':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4[_0x38c7ae(0x209)]['FLOAT'],'componentsPerAttribute':0x3,'values':_0xe8c467})}),'indices':_0x2d9619});return _0x5fe997;}},{'key':_0xd96b39(0x2c7),'value':function _0x81f84d(_0xb72158,_0x4f78a2,_0x527f40,_0x4b5698){var _0x3ee2c0=_0xd96b39,_0x27c352=this;this[_0x3ee2c0(0x220)]={'segments':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'st':0x0,'normal':0x1},'geometry':this['createSegmentsGeometry'](_0x4f78a2),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'currentParticlesPosition':function _0x454bd7(){var _0x36ccfd=_0x3ee2c0;return _0x4b5698[_0x36ccfd(0x296)]['currentParticlesPosition'];},'postProcessingPosition':function _0x1fec2f(){var _0x2f49d5=_0x3ee2c0;return _0x4b5698['particlesTextures'][_0x2f49d5(0x2c5)];},'postProcessingSpeed':function _0xcc3b4f(){var _0x1d5a43=_0x3ee2c0;return _0x4b5698['particlesTextures'][_0x1d5a43(0x1e4)];},'colorTable':function _0x18fa16(){var _0x571dd0=_0x3ee2c0;return _0x27c352['textures'][_0x571dd0(0x215)];},'aspect':function _0x252945(){return _0xb72158['drawingBufferWidth']/_0xb72158['drawingBufferHeight'];},'pixelSize':function _0x52e539(){var _0x5db74d=_0x3ee2c0;return _0x527f40[_0x5db74d(0x229)];},'lineWidth':function _0xf0b6d4(){return _0x4f78a2['lineWidth'];},'particleHeight':function _0x57fb1c(){return _0x4f78a2['particleHeight'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_frag]}),'rawRenderState':Util[_0x3ee2c0(0x2ca)]({'viewport':undefined,'depthTest':{'enabled':!![]},'depthMask':!![]}),'framebuffer':this['framebuffers']['segments'],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'segmentsColorTexture':function _0x3e7ddd(){var _0xf93ed2=_0x3ee2c0;return _0x27c352['textures'][_0xf93ed2(0x298)];},'segmentsDepthTexture':function _0x56cd71(){var _0x31dfab=_0x3ee2c0;return _0x27c352[_0x31dfab(0x255)][_0x31dfab(0x244)];},'currentTrailsColor':function _0xe619ef(){return _0x27c352['framebuffers']['currentTrails']['getColorTexture'](0x0);},'trailsDepthTexture':function _0x29a2ef(){return _0x27c352['framebuffers']['currentTrails']['depthTexture'];},'fadeOpacity':function _0x3eb03c(){var _0x4af25a=_0x3ee2c0;return _0x4f78a2[_0x4af25a(0x2d9)];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'defines':[_0x3ee2c0(0x23c)],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'defines':[_0x3ee2c0(0x1fc)],'sources':[trailDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4['DepthFunction']['ALWAYS']},'depthMask':!![]}),'framebuffer':this[_0x3ee2c0(0x2b8)]['nextTrails'],'autoClear':!![],'preExecute':function _0xd7e5ff(){var _0x4aadaf=_0x3ee2c0,_0x28e685=_0x27c352['framebuffers']['currentTrails'];_0x27c352['framebuffers'][_0x4aadaf(0x29b)]=_0x27c352['framebuffers']['nextTrails'],_0x27c352['framebuffers'][_0x4aadaf(0x2ac)]=_0x28e685,_0x27c352['primitives']['trails'][_0x4aadaf(0x28f)]['framebuffer']=_0x27c352[_0x4aadaf(0x2b8)]['nextTrails'],_0x27c352['primitives']['trails'][_0x4aadaf(0x1e6)]['framebuffer']=_0x27c352[_0x4aadaf(0x2b8)][_0x4aadaf(0x2ac)];}}),'screen':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4[_0x3ee2c0(0x29f)]['TRIANGLES'],'uniformMap':{'trailsColorTexture':function _0x5e9b94(){var _0xbff685=_0x3ee2c0;return _0x27c352['framebuffers'][_0xbff685(0x2ac)][_0xbff685(0x22a)](0x0);},'trailsDepthTexture':function _0x20ef24(){var _0x16adb2=_0x3ee2c0;return _0x27c352[_0x16adb2(0x2b8)]['nextTrails']['depthTexture'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_GL_POSITION_LOG_DEPTH'],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'defines':[_0x3ee2c0(0x1fc)],'sources':[screenDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':![]},'depthMask':!![],'blending':{'enabled':!![]}}),'framebuffer':undefined})};}}]),_0xf84a2f;}()),getWind_frag='//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x,\x20360.0);\x0a\x20\x20\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20-90.0,\x2090.0);\x0a\x0a\x20\x20\x20\x20vec3\x20index3D\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20index3D.z\x20=\x20(lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z;\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205],\x20width\x20=\x203,\x20height\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x203\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x202\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWind(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20\x20\x20float\x20result\x20=\x20texture(windTexture,\x20normalizedIndex2D).r;\x0a\x20\x20\x20\x20return\x20result;\x0a}\x0a\x0aconst\x20mat4\x20kernelMatrix\x20=\x20mat4(\x0a\x20\x20\x20\x200.0,\x20-1.0,\x202.0,\x20-1.0,\x20//\x20first\x20column\x0a\x20\x20\x20\x202.0,\x200.0,\x20-5.0,\x203.0,\x20//\x20second\x20column\x0a\x20\x20\x20\x200.0,\x201.0,\x204.0,\x20-3.0,\x20//\x20third\x20column\x0a\x20\x20\x20\x200.0,\x200.0,\x20-1.0,\x201.0\x20//\x20fourth\x20column\x0a);\x0afloat\x20oneDimensionInterpolation(float\x20t,\x20float\x20p0,\x20float\x20p1,\x20float\x20p2,\x20float\x20p3)\x20{\x0a\x20\x20\x20\x20vec4\x20tVec4\x20=\x20vec4(1.0,\x20t,\x20t\x20*\x20t,\x20t\x20*\x20t\x20*\x20t);\x0a\x20\x20\x20\x20tVec4\x20=\x20tVec4\x20/\x202.0;\x0a\x20\x20\x20\x20vec4\x20pVec4\x20=\x20vec4(p0,\x20p1,\x20p2,\x20p3);\x0a\x20\x20\x20\x20return\x20dot((tVec4\x20*\x20kernelMatrix),\x20pVec4);\x0a}\x0a\x0afloat\x20calculateB(sampler2D\x20windTexture,\x20float\x20t,\x20float\x20lon,\x20float\x20lat,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20float\x20lon0\x20=\x20floor(lon)\x20-\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon1\x20=\x20floor(lon);\x0a\x20\x20\x20\x20float\x20lon2\x20=\x20floor(lon)\x20+\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon3\x20=\x20floor(lon)\x20+\x202.0\x20*\x20interval.x;\x0a\x0a\x20\x20\x20\x20float\x20p0\x20=\x20getWind(windTexture,\x20vec3(lon0,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p1\x20=\x20getWind(windTexture,\x20vec3(lon1,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p2\x20=\x20getWind(windTexture,\x20vec3(lon2,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p3\x20=\x20getWind(windTexture,\x20vec3(lon3,\x20lat,\x20lev));\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(t,\x20p0,\x20p1,\x20p2,\x20p3);\x0a}\x0a\x0afloat\x20interpolateOneTexture(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20\x20\x20float\x20lat0\x20=\x20floor(lat)\x20-\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat1\x20=\x20floor(lat);\x0a\x20\x20\x20\x20float\x20lat2\x20=\x20floor(lat)\x20+\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat3\x20=\x20floor(lat)\x20+\x202.0\x20*\x20interval.y;\x0a\x0a\x20\x20\x20\x20vec2\x20coefficient\x20=\x20lonLatLev.xy\x20-\x20floor(lonLatLev.xy);\x0a\x20\x20\x20\x20float\x20b0\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat0,\x20lev);\x0a\x20\x20\x20\x20float\x20b1\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat1,\x20lev);\x0a\x20\x20\x20\x20float\x20b2\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat2,\x20lev);\x0a\x20\x20\x20\x20float\x20b3\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat3,\x20lev);\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(coefficient.y,\x20b0,\x20b1,\x20b2,\x20b3);\x0a}\x0a\x0avec3\x20bicubic(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bicubic_interpolation#Bicubic_convolution_algorithm\x0a\x20\x20\x20\x20float\x20u\x20=\x20interpolateOneTexture(U,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20v\x20=\x20interpolateOneTexture(V,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20bicubic(lonLatLev);\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(windVector,\x200.0);\x0a}\x0a',updateSpeed_frag='uniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0auniform\x20sampler2D\x20particlesWind;\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20speedFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec3\x20percent\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20\x20\x20float\x20normalization\x20=\x20length(percent);\x0a\x0a\x20\x20\x20\x20return\x20normalization;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20//\x20vec3\x20currentSpeed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20texture(particlesWind,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20vec4(speedFactor\x20*\x20pixelSize\x20*\x20windVector,\x20calculateWindNorm(windVector));\x0a\x20\x20\x20\x20out_FragColor\x20=\x20nextSpeed;\x0a}\x0a',updatePosition_frag=_0x1a8bc1(0x2dd),postProcessingPosition_frag=_0x1a8bc1(0x21f),postProcessingSpeed_frag='uniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20randomParticle\x20=\x20texture(postProcessingPosition,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20vec4\x20particleSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x0a\x20\x20\x20\x20if\x20(randomParticle.a\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20particleSpeed;\x0a\x20\x20\x20\x20}\x0a}\x0a',Cesium$3=mars3d__namespace[_0x1a8bc1(0x20b)],ParticlesComputing=(function(){var _0x307eab=_0x1a8bc1;function _0x18a8f8(_0x244e02,_0x5b7152,_0x3a30d1,_0x13b402){var _0x4442f3=_0x265e;_classCallCheck(this,_0x18a8f8),this[_0x4442f3(0x1ff)]=_0x5b7152,this['createWindTextures'](_0x244e02,_0x5b7152),this['createParticlesTextures'](_0x244e02,_0x3a30d1,_0x13b402),this[_0x4442f3(0x20a)](_0x5b7152,_0x3a30d1,_0x13b402);}return _createClass(_0x18a8f8,[{'key':'createWindTextures','value':function _0x485349(_0x29d6bc,_0x3ac261){var _0x71aafa=_0x265e,_0x1e2c4d={'context':_0x29d6bc,'width':_0x3ac261['dimensions']['lon'],'height':_0x3ac261['dimensions']['lat']*(_0x3ac261['dimensions'][_0x71aafa(0x231)]||0x1),'pixelFormat':Cesium$3['PixelFormat'][_0x71aafa(0x216)],'pixelDatatype':Cesium$3['PixelDatatype'][_0x71aafa(0x2cb)],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})};this['windTextures']={'U':Util['createTexture'](_0x1e2c4d,_0x3ac261['U'][_0x71aafa(0x263)]),'V':Util['createTexture'](_0x1e2c4d,_0x3ac261['V']['array'])};}},{'key':_0x307eab(0x271),'value':function _0xa4ef26(_0x6efeb0,_0x3d8f11,_0x5d8577){var _0xa717e9=_0x307eab,_0xbd7186={'context':_0x6efeb0,'width':_0x3d8f11['particlesTextureSize'],'height':_0x3d8f11['particlesTextureSize'],'pixelFormat':Cesium$3['PixelFormat'][_0xa717e9(0x20e)],'pixelDatatype':Cesium$3[_0xa717e9(0x210)]['FLOAT'],'flipY':![],'sampler':new Cesium$3[(_0xa717e9(0x27f))]({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3[_0xa717e9(0x2c6)]['NEAREST']})},_0x5403a8=this['randomizeParticles'](_0x3d8f11[_0xa717e9(0x1f4)],_0x5d8577),_0xd234f2=new Float32Array(0x4*_0x3d8f11[_0xa717e9(0x1f4)])['fill'](0x0);this[_0xa717e9(0x296)]={'particlesWind':Util['createTexture'](_0xbd7186),'currentParticlesPosition':Util['createTexture'](_0xbd7186,_0x5403a8),'nextParticlesPosition':Util['createTexture'](_0xbd7186,_0x5403a8),'currentParticlesSpeed':Util[_0xa717e9(0x2bd)](_0xbd7186,_0xd234f2),'nextParticlesSpeed':Util['createTexture'](_0xbd7186,_0xd234f2),'postProcessingPosition':Util['createTexture'](_0xbd7186,_0x5403a8),'postProcessingSpeed':Util[_0xa717e9(0x2bd)](_0xbd7186,_0xd234f2)};}},{'key':_0x307eab(0x258),'value':function _0x4fb2aa(_0x3205c2,_0xa9ead0){var _0x23d823=_0x307eab,_0x48a0ab=new Float32Array(0x4*_0x3205c2);for(var _0x4467d4=0x0;_0x4467d4<_0x3205c2;_0x4467d4++){_0x48a0ab[0x4*_0x4467d4]=Cesium$3['Math'][_0x23d823(0x22e)](_0xa9ead0['lonRange']['x'],_0xa9ead0[_0x23d823(0x243)]['y']),_0x48a0ab[0x4*_0x4467d4+0x1]=Cesium$3['Math']['randomBetween'](_0xa9ead0['latRange']['x'],_0xa9ead0[_0x23d823(0x238)]['y']),_0x48a0ab[0x4*_0x4467d4+0x2]=Cesium$3['Math'][_0x23d823(0x22e)](this['data']['lev']['min'],this['data'][_0x23d823(0x231)]['max']),_0x48a0ab[0x4*_0x4467d4+0x3]=0x0;}return _0x48a0ab;}},{'key':'destroyParticlesTextures','value':function _0x40b0cc(){var _0x74d0ed=_0x307eab,_0x1bfaa3=this;Object['keys'](this[_0x74d0ed(0x296)])['forEach'](function(_0x29aeac){_0x1bfaa3['particlesTextures'][_0x29aeac]['destroy']();});}},{'key':'createComputingPrimitives','value':function _0x2f0b0b(_0x1fcd0e,_0x395318,_0x58535b){var _0x589d0c=_0x307eab,_0x2072b1=new Cesium$3['Cartesian3'](_0x1fcd0e['dimensions']['lon'],_0x1fcd0e['dimensions']['lat'],_0x1fcd0e['dimensions'][_0x589d0c(0x231)]),_0xe56a13=new Cesium$3[(_0x589d0c(0x201))](_0x1fcd0e['lon']['min'],_0x1fcd0e['lat']['min'],_0x1fcd0e[_0x589d0c(0x231)][_0x589d0c(0x2d6)]),_0x137533=new Cesium$3['Cartesian3'](_0x1fcd0e[_0x589d0c(0x1fa)]['max'],_0x1fcd0e[_0x589d0c(0x25c)]['max'],_0x1fcd0e['lev']['max']),_0x8ca097=new Cesium$3['Cartesian3']((_0x137533['x']-_0xe56a13['x'])/(_0x2072b1['x']-0x1),(_0x137533['y']-_0xe56a13['y'])/(_0x2072b1['y']-0x1),_0x2072b1['z']>0x1?(_0x137533['z']-_0xe56a13['z'])/(_0x2072b1['z']-0x1):0x1),_0x3994d7=new Cesium$3['Cartesian2'](_0x1fcd0e['U']['min'],_0x1fcd0e['U']['max']),_0x19be86=new Cesium$3['Cartesian2'](_0x1fcd0e['V']['min'],_0x1fcd0e['V']['max']),_0x236556=this;this['primitives']={'getWind':new CustomPrimitive({'commandType':'Compute','uniformMap':{'U':function _0x1528e7(){return _0x236556['windTextures']['U'];},'V':function _0x19d694(){return _0x236556['windTextures']['V'];},'currentParticlesPosition':function _0x15d1bc(){return _0x236556['particlesTextures']['currentParticlesPosition'];},'dimension':function _0x19667a(){return _0x2072b1;},'minimum':function _0x505687(){return _0xe56a13;},'maximum':function _0x5b0d22(){return _0x137533;},'interval':function _0x5e595a(){return _0x8ca097;}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[getWind_frag]}),'outputTexture':this['particlesTextures']['particlesWind'],'preExecute':function _0x1b9463(){var _0x535206=_0x589d0c;_0x236556['primitives'][_0x535206(0x2a5)]['commandToExecute'][_0x535206(0x218)]=_0x236556['particlesTextures']['particlesWind'];}}),'updateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesSpeed':function _0x4b7fcb(){return _0x236556['particlesTextures']['currentParticlesSpeed'];},'particlesWind':function _0x27d0e1(){return _0x236556['particlesTextures']['particlesWind'];},'uSpeedRange':function _0x1a9819(){return _0x3994d7;},'vSpeedRange':function _0xb7685c(){return _0x19be86;},'pixelSize':function _0x3baffb(){return _0x58535b['pixelSize'];},'speedFactor':function _0x1263de(){return _0x395318['speedFactor'];}},'fragmentShaderSource':new Cesium$3[(_0x589d0c(0x1ef))]({'sources':[updateSpeed_frag]}),'outputTexture':this['particlesTextures']['nextParticlesSpeed'],'preExecute':function _0x1878fd(){var _0x2bec1=_0x589d0c,_0x5da31d=_0x236556[_0x2bec1(0x296)]['currentParticlesSpeed'];_0x236556['particlesTextures']['currentParticlesSpeed']=_0x236556['particlesTextures'][_0x2bec1(0x1e4)],_0x236556[_0x2bec1(0x296)][_0x2bec1(0x1e4)]=_0x5da31d,_0x236556['primitives'][_0x2bec1(0x2e5)][_0x2bec1(0x28f)]['outputTexture']=_0x236556['particlesTextures']['nextParticlesSpeed'];}}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':function _0x984485(){return _0x236556['particlesTextures']['currentParticlesPosition'];},'currentParticlesSpeed':function _0x40c85c(){return _0x236556['particlesTextures']['currentParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[updatePosition_frag]}),'outputTexture':this['particlesTextures'][_0x589d0c(0x24a)],'preExecute':function _0x23dc20(){var _0xd946ed=_0x589d0c,_0x2edf67=_0x236556['particlesTextures']['currentParticlesPosition'];_0x236556['particlesTextures']['currentParticlesPosition']=_0x236556['particlesTextures']['postProcessingPosition'],_0x236556[_0xd946ed(0x296)]['postProcessingPosition']=_0x2edf67,_0x236556['primitives']['updatePosition'][_0xd946ed(0x28f)]['outputTexture']=_0x236556['particlesTextures'][_0xd946ed(0x24a)];}}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':function _0x10e5ba(){return _0x236556['particlesTextures']['nextParticlesPosition'];},'nextParticlesSpeed':function _0x2fcfda(){var _0x4304f7=_0x589d0c;return _0x236556[_0x4304f7(0x296)]['nextParticlesSpeed'];},'lonRange':function _0x595672(){return _0x58535b['lonRange'];},'latRange':function _0x230506(){return _0x58535b['latRange'];},'randomCoefficient':function _0x219af0(){var _0x2c2b8e=Math['random']();return _0x2c2b8e;},'dropRate':function _0x1e0c7a(){return _0x395318['dropRate'];},'dropRateBump':function _0x622ab3(){return _0x395318['dropRateBump'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[postProcessingPosition_frag]}),'outputTexture':this['particlesTextures']['postProcessingPosition'],'preExecute':function _0x55b4b1(){var _0x5e2846=_0x589d0c;_0x236556['primitives']['postProcessingPosition']['commandToExecute']['outputTexture']=_0x236556[_0x5e2846(0x296)][_0x5e2846(0x2c5)];}}),'postProcessingSpeed':new CustomPrimitive({'commandType':_0x589d0c(0x21b),'uniformMap':{'postProcessingPosition':function _0x40bd23(){var _0x53dcab=_0x589d0c;return _0x236556[_0x53dcab(0x296)][_0x53dcab(0x2c5)];},'nextParticlesSpeed':function _0x156cc7(){var _0x5bbf26=_0x589d0c;return _0x236556[_0x5bbf26(0x296)]['nextParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3[(_0x589d0c(0x1ef))]({'sources':[postProcessingSpeed_frag]}),'outputTexture':this['particlesTextures']['postProcessingSpeed'],'preExecute':function _0x1fab70(){var _0x33f2ba=_0x589d0c;_0x236556['primitives'][_0x33f2ba(0x1e4)][_0x33f2ba(0x28f)][_0x33f2ba(0x218)]=_0x236556['particlesTextures'][_0x33f2ba(0x1e4)];}})};}}]),_0x18a8f8;}()),Cesium$2=mars3d__namespace[_0x1a8bc1(0x20b)],ParticleSystem=(function(){var _0x451942=_0x1a8bc1;function _0x975ed8(_0x200dd6,_0x57f713,_0x392332,_0x55c89e){var _0x2c67b0=_0x265e;_classCallCheck(this,_0x975ed8),this['context']=_0x200dd6,_0x57f713=_objectSpread2({},_0x57f713);if(_0x57f713['udata']&&_0x57f713[_0x2c67b0(0x269)]){var _0x2ffb55,_0x25018a,_0x39e2f6,_0x1eb4ac,_0x3dff69,_0x4b90fb;_0x57f713['dimensions']={},_0x57f713[_0x2c67b0(0x212)][_0x2c67b0(0x1fa)]=_0x57f713['cols'],_0x57f713['dimensions']['lat']=_0x57f713['rows'],_0x57f713['dimensions']['lev']=_0x57f713['lev']||0x1,_0x57f713[_0x2c67b0(0x1fa)]={},_0x57f713['lon']['min']=_0x57f713['xmin'],_0x57f713[_0x2c67b0(0x1fa)][_0x2c67b0(0x276)]=_0x57f713['xmax'],_0x57f713['lat']={},_0x57f713['lat']['min']=_0x57f713['ymin'],_0x57f713['lat']['max']=_0x57f713[_0x2c67b0(0x1e0)],_0x57f713['lev']={},_0x57f713[_0x2c67b0(0x231)][_0x2c67b0(0x2d6)]=(_0x2ffb55=_0x57f713['levmin'])!==null&&_0x2ffb55!==void 0x0?_0x2ffb55:0x1,_0x57f713[_0x2c67b0(0x231)]['max']=(_0x25018a=_0x57f713[_0x2c67b0(0x27a)])!==null&&_0x25018a!==void 0x0?_0x25018a:0x1,_0x57f713['U']={},_0x57f713['U']['array']=new Float32Array(_0x57f713['udata']),_0x57f713['U']['min']=(_0x39e2f6=_0x57f713[_0x2c67b0(0x2df)])!==null&&_0x39e2f6!==void 0x0?_0x39e2f6:Math[_0x2c67b0(0x2d6)]['apply'](Math,_toConsumableArray(_0x57f713['udata'])),_0x57f713['U'][_0x2c67b0(0x276)]=(_0x1eb4ac=_0x57f713['umax'])!==null&&_0x1eb4ac!==void 0x0?_0x1eb4ac:Math[_0x2c67b0(0x276)]['apply'](Math,_toConsumableArray(_0x57f713[_0x2c67b0(0x28a)])),_0x57f713['V']={},_0x57f713['V'][_0x2c67b0(0x263)]=new Float32Array(_0x57f713['vdata']),_0x57f713['V']['min']=(_0x3dff69=_0x57f713['vmin'])!==null&&_0x3dff69!==void 0x0?_0x3dff69:Math['min']['apply'](Math,_toConsumableArray(_0x57f713['vdata'])),_0x57f713['V']['max']=(_0x4b90fb=_0x57f713['vmax'])!==null&&_0x4b90fb!==void 0x0?_0x4b90fb:Math[_0x2c67b0(0x276)]['apply'](Math,_toConsumableArray(_0x57f713['vdata']));}this['data']=_0x57f713,this[_0x2c67b0(0x2c0)]=_0x392332,this[_0x2c67b0(0x1db)]=_0x55c89e,this['particlesComputing']=new ParticlesComputing(this[_0x2c67b0(0x2b9)],this['data'],this['options'],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this[_0x2c67b0(0x2b9)],this['data'],this['options'],this[_0x2c67b0(0x1db)],this['particlesComputing']);}return _createClass(_0x975ed8,[{'key':'canvasResize','value':function _0x1ee5c0(_0x35fd3c){var _0x223425=_0x265e,_0x1e5935=this;this['particlesComputing']['destroyParticlesTextures'](),Object['keys'](this[_0x223425(0x223)][_0x223425(0x2d0)])['forEach'](function(_0x54ab08){_0x1e5935['particlesComputing']['windTextures'][_0x54ab08]['destroy']();}),this[_0x223425(0x2bb)]['textures'][_0x223425(0x215)][_0x223425(0x20d)](),Object['keys'](this[_0x223425(0x2bb)][_0x223425(0x2b8)])['forEach'](function(_0x103273){var _0x47f202=_0x223425;_0x1e5935[_0x47f202(0x2bb)]['framebuffers'][_0x103273]['destroy']();}),this['context']=_0x35fd3c,this['particlesComputing']=new ParticlesComputing(this[_0x223425(0x2b9)],this[_0x223425(0x1ff)],this['options'],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this['context'],this[_0x223425(0x1ff)],this['options'],this[_0x223425(0x1db)],this[_0x223425(0x223)]);}},{'key':_0x451942(0x280),'value':function _0x14dc6a(){var _0x5fc20f=_0x451942,_0x2777b1=this,_0x41c2b9=new Cesium$2['ClearCommand']({'color':new Cesium$2['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2[_0x5fc20f(0x248)]['OPAQUE']});Object['keys'](this['particlesRendering']['framebuffers'])['forEach'](function(_0x816c25){var _0x40f892=_0x5fc20f;_0x41c2b9['framebuffer']=_0x2777b1['particlesRendering']['framebuffers'][_0x816c25],_0x41c2b9[_0x40f892(0x1e9)](_0x2777b1['context']);});}},{'key':_0x451942(0x284),'value':function _0x35db96(_0x17823f){var _0x37c94a=_0x451942;this[_0x37c94a(0x280)](),this['particlesComputing']['destroyParticlesTextures'](),this['particlesComputing']['createParticlesTextures'](this['context'],this[_0x37c94a(0x2c0)],this['viewerParameters']);if(_0x17823f){var _0x5138b9=this[_0x37c94a(0x2bb)]['createSegmentsGeometry'](this[_0x37c94a(0x2c0)]);this['particlesRendering']['primitives']['segments']['geometry']=_0x5138b9;var _0xb8e478=Cesium$2['VertexArray']['fromGeometry']({'context':this['context'],'geometry':_0x5138b9,'attributeLocations':this[_0x37c94a(0x2bb)]['primitives']['segments']['attributeLocations'],'bufferUsage':Cesium$2['BufferUsage']['STATIC_DRAW']});this[_0x37c94a(0x2bb)][_0x37c94a(0x220)][_0x37c94a(0x254)]['commandToExecute']['vertexArray']=_0xb8e478;}}},{'key':_0x451942(0x267),'value':function _0x1a5ba7(_0x9af1d4){var _0x1d2da9=_0x451942,_0xeae328=this,_0x32c1ec=![];this['options'][_0x1d2da9(0x1f4)]!==_0x9af1d4['maxParticles']&&(_0x32c1ec=!![]),Object[_0x1d2da9(0x2af)](_0x9af1d4)[_0x1d2da9(0x203)](function(_0x339740){_0xeae328['options'][_0x339740]=_0x9af1d4[_0x339740];}),this['refreshParticles'](_0x32c1ec);}},{'key':'applyViewerParameters','value':function _0x4686be(_0x29823c){var _0x165acd=_0x451942,_0x18ae96=this;Object[_0x165acd(0x2af)](_0x29823c)[_0x165acd(0x203)](function(_0x3a5846){var _0x9609bc=_0x165acd;_0x18ae96[_0x9609bc(0x1db)][_0x3a5846]=_0x29823c[_0x3a5846];}),this[_0x165acd(0x284)](![]);}},{'key':_0x451942(0x20d),'value':function _0x48f556(){var _0x21706c=_0x451942,_0x428e65=this;clearTimeout(this['canrefresh']),this['particlesComputing']['destroyParticlesTextures'](),Object[_0x21706c(0x2af)](this[_0x21706c(0x223)]['windTextures'])[_0x21706c(0x203)](function(_0x4a7724){var _0x508a09=_0x21706c;_0x428e65[_0x508a09(0x223)]['windTextures'][_0x4a7724]['destroy']();}),this[_0x21706c(0x2bb)][_0x21706c(0x255)][_0x21706c(0x215)]['destroy'](),Object['keys'](this['particlesRendering'][_0x21706c(0x2b8)])[_0x21706c(0x203)](function(_0x2a6d84){_0x428e65['particlesRendering']['framebuffers'][_0x2a6d84]['destroy']();});for(var _0x309d98 in this){delete this[_0x309d98];}}}]),_0x975ed8;}()),Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],DEF_OPTIONS={'particlesNumber':0x1000,'fixedHeight':0x0,'fadeOpacity':0.996,'dropRate':0.003,'dropRateBump':0.01,'speedFactor':0.5,'lineWidth':0x2,'colors':['rgb(206,255,255)']},WindLayer=function(_0x47600b){var _0x516740=_0x1a8bc1;_inherits(_0x43bb20,_0x47600b);var _0x344019=_createSuper(_0x43bb20);function _0x43bb20(){var _0x1e41ab=_0x265e,_0x21fac9,_0x347346=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x43bb20),_0x347346=_objectSpread2(_objectSpread2({},DEF_OPTIONS),_0x347346),_0x21fac9=_0x344019['call'](this,_0x347346),_0x21fac9[_0x1e41ab(0x246)](_0x347346),_0x21fac9;}return _createClass(_0x43bb20,[{'key':'layer','get':function _0x22a4db(){var _0x1518fb=_0x265e;return this[_0x1518fb(0x220)];}},{'key':_0x516740(0x1ff),'get':function _0x417f4f(){var _0x5c2395=_0x516740;return this[_0x5c2395(0x224)];},'set':function _0x1a3735(_0x7c5cd4){this['setData'](_0x7c5cd4);}},{'key':'colors','get':function _0x57578c(){var _0x2ff41a=_0x516740;return this['options'][_0x2ff41a(0x233)];},'set':function _0x3ae0b1(_0x55f0c1){var _0x4e58b4=_0x516740;this['options'][_0x4e58b4(0x233)]=_0x55f0c1,this['particleSystem']&&this['particleSystem']['setOptions']({'colors':_0x55f0c1}),this[_0x4e58b4(0x2d2)]();}},{'key':'_mountedHook','value':function _0x3ba8a9(){}},{'key':_0x516740(0x232),'value':function _0x571e7b(){var _0xe90f4f=_0x516740;this['scene']=this['_map']['scene'],this['camera']=this[_0xe90f4f(0x24c)]['camera'],this['primitives']=new Cesium$1['PrimitiveCollection'](),this['_map']['scene'][_0xe90f4f(0x220)][_0xe90f4f(0x1fe)](this[_0xe90f4f(0x220)]),this['viewerParameters']={'lonRange':new Cesium$1[(_0xe90f4f(0x2a1))](),'latRange':new Cesium$1['Cartesian2'](),'pixelSize':0x0},this[_0xe90f4f(0x283)]=new Cesium$1[(_0xe90f4f(0x20f))](Cesium$1['Cartesian3']['ZERO'],0.99*0x615299),this[_0xe90f4f(0x1ec)](),window[_0xe90f4f(0x27d)]('resize',this['resize']['bind'](this),![]),this['mouse_down']=![],this[_0xe90f4f(0x2ba)]=![],this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0xe90f4f(0x1de)],this['_onMouseDownEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0xe90f4f(0x2b5)],this['_onMouseUpEvent'],this),this[_0xe90f4f(0x24c)]['on'](mars3d__namespace['EventType'][_0xe90f4f(0x282)],this['_onMouseMoveEvent'],this),this['_data']&&this['setData'](this['_data']);}},{'key':'_removedHook','value':function _0x365e34(){var _0x1d195a=_0x516740;window['removeEventListener']('resize',this['resize']),this['_map'][_0x1d195a(0x2a3)](mars3d__namespace['EventType'][_0x1d195a(0x292)],this[_0x1d195a(0x25b)],this),this['_map']['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map'][_0x1d195a(0x2a3)](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this),this['_map'][_0x1d195a(0x2a3)](mars3d__namespace['EventType'][_0x1d195a(0x282)],this['_onMouseMoveEvent'],this),this[_0x1d195a(0x220)]['removeAll'](),this[_0x1d195a(0x24c)][_0x1d195a(0x2d7)][_0x1d195a(0x220)][_0x1d195a(0x2de)](this[_0x1d195a(0x220)]);}},{'key':'resize','value':function _0x5aadc2(){var _0x4723ae=_0x516740;if(!this['show']||!this['particleSystem'])return;this['primitives']['show']=![],this['primitives']['removeAll'](),this['_map']['once'](mars3d__namespace['EventType'][_0x4723ae(0x292)],this['_onMap_preRenderEvent'],this);}},{'key':_0x516740(0x25b),'value':function _0x4e44f4(_0x5b3995){var _0x263341=_0x516740;this['particleSystem']['canvasResize'](this['scene']['context']),this['addPrimitives'](),this[_0x263341(0x220)]['show']=!![];}},{'key':_0x516740(0x1dd),'value':function _0x4478a0(_0x43fd09){var _0x5c567e=_0x516740,_0x317216=this;clearTimeout(this['refreshTimer']);if(!this[_0x5c567e(0x24d)]||!this['particleSystem'])return;this['primitives']['show']=![],this['refreshTimer']=setTimeout(function(){var _0xd30eef=_0x5c567e;if(!_0x317216[_0xd30eef(0x24d)])return;_0x317216['redraw']();},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x401ca2(_0xf959c7){this['mouse_down']=!![];}},{'key':'_onMouseMoveEvent','value':function _0x49cb66(_0x563fcb){var _0x1049ca=_0x516740;if(!this[_0x1049ca(0x24d)]||!this['particleSystem'])return;this[_0x1049ca(0x2c4)]&&(this['primitives']['show']=![],this['mouse_move']=!![]);}},{'key':'_onMouseUpEvent','value':function _0x25f439(_0x43d78f){var _0x4919e5=_0x516740;if(!this['show']||!this['particleSystem'])return;this['mouse_down']&&this['mouse_move']&&this['redraw'](),this['primitives'][_0x4919e5(0x24d)]=!![],this[_0x4919e5(0x2c4)]=![],this['mouse_move']=![];}},{'key':'redraw','value':function _0x470e79(){var _0x15569b=_0x516740;if(!this['_map']||!this[_0x15569b(0x24d)])return;this['updateViewerParameters'](),this['particleSystem']['applyViewerParameters'](this['viewerParameters']),this[_0x15569b(0x220)]['show']=!![];}},{'key':'setData','value':function _0x1ff0b7(_0x2607eb){var _0x3295fd=_0x516740;this['_data']=_0x2607eb,this[_0x3295fd(0x214)]&&this['particleSystem']['destroy'](),this[_0x3295fd(0x214)]=new ParticleSystem(this['scene'][_0x3295fd(0x2b9)],_0x2607eb,this[_0x3295fd(0x26a)](),this['viewerParameters']),this['addPrimitives']();}},{'key':_0x516740(0x246),'value':function _0xec2a06(_0x4ceb1d,_0x419354){var _0xa692b4=_0x516740;if(_0x4ceb1d)for(var _0x26b732 in _0x4ceb1d){this[_0x26b732]=_0x4ceb1d[_0x26b732];}this[_0xa692b4(0x214)]&&this['particleSystem']['setOptions'](this['getOptions']());}},{'key':_0x516740(0x26a),'value':function _0x407a5c(){var _0x2cd422=_0x516740,_0x307438=Math['ceil'](Math['sqrt'](this['particlesNumber']));return this['particlesNumber']=_0x307438*_0x307438,{'particlesTextureSize':_0x307438,'maxParticles':this[_0x2cd422(0x299)],'particleHeight':this['fixedHeight'],'fadeOpacity':this['fadeOpacity'],'dropRate':this[_0x2cd422(0x2cf)],'dropRateBump':this['dropRateBump'],'speedFactor':this['speedFactor'],'lineWidth':this['lineWidth'],'colors':this['colors']};}},{'key':'addPrimitives','value':function _0x596edf(){var _0x412aef=_0x516740;this['primitives']['add'](this['particleSystem']['particlesComputing']['primitives']['getWind']),this['primitives'][_0x412aef(0x1fe)](this[_0x412aef(0x214)][_0x412aef(0x223)]['primitives']['updateSpeed']),this['primitives'][_0x412aef(0x1fe)](this[_0x412aef(0x214)]['particlesComputing']['primitives'][_0x412aef(0x1f5)]),this['primitives']['add'](this[_0x412aef(0x214)]['particlesComputing']['primitives']['postProcessingPosition']),this[_0x412aef(0x220)]['add'](this['particleSystem']['particlesComputing'][_0x412aef(0x220)]['postProcessingSpeed']),this['primitives']['add'](this['particleSystem']['particlesRendering']['primitives']['segments']),this['primitives']['add'](this['particleSystem']['particlesRendering']['primitives']['trails']),this[_0x412aef(0x220)]['add'](this['particleSystem'][_0x412aef(0x2bb)]['primitives'][_0x412aef(0x2dc)]);}},{'key':_0x516740(0x1ec),'value':function _0x2ed123(){var _0xb59db8=_0x516740,_0x4c5d3f=this['camera']['computeViewRectangle'](this['scene'][_0xb59db8(0x2e0)]['ellipsoid']);if(!_0x4c5d3f){var _0x4b3f3f=this[_0xb59db8(0x24c)]['getExtent']();_0x4c5d3f=Cesium$1['Rectangle'][_0xb59db8(0x2a9)](_0x4b3f3f['xmin'],_0x4b3f3f['ymin'],_0x4b3f3f['xmax'],_0x4b3f3f['ymax']);}var _0x5aef5a=Util['viewRectangleToLonLatRange'](_0x4c5d3f);this[_0xb59db8(0x1db)][_0xb59db8(0x243)]['x']=_0x5aef5a[_0xb59db8(0x1fa)]['min'],this['viewerParameters'][_0xb59db8(0x243)]['y']=_0x5aef5a['lon'][_0xb59db8(0x276)],this['viewerParameters']['latRange']['x']=_0x5aef5a['lat']['min'],this['viewerParameters']['latRange']['y']=_0x5aef5a[_0xb59db8(0x25c)]['max'];var _0x10cd16=this['camera'][_0xb59db8(0x2bf)](this['globeBoundingSphere'],this['scene'][_0xb59db8(0x252)],this['scene']['drawingBufferHeight']);_0x10cd16>0x0&&(this[_0xb59db8(0x1db)]['pixelSize']=_0x10cd16);}}]),_0x43bb20;}(BaseLayer$1);mars3d__namespace[_0x1a8bc1(0x221)]['register']('wind',WindLayer),mars3d__namespace['layer'][_0x1a8bc1(0x1fb)]=WindLayer;var CanvasParticle=(function(){var _0x2a065f=_0x1a8bc1;function _0x28f84e(){var _0x551f8d=_0x265e;_classCallCheck(this,_0x28f84e),this[_0x551f8d(0x28d)]=null,this['lat']=null,this['tlng']=null,this['tlat']=null,this[_0x551f8d(0x21d)]=null;}return _createClass(_0x28f84e,[{'key':_0x2a065f(0x20d),'value':function _0x230178(){for(var _0x179b34 in this){delete this[_0x179b34];}}}]),_0x28f84e;}()),CanvasWindField=(function(){var _0x3464a1=_0x1a8bc1;function _0x5180d6(_0x4a30a9){var _0x299d25=_0x265e;_classCallCheck(this,_0x5180d6),this[_0x299d25(0x267)](_0x4a30a9);}return _createClass(_0x5180d6,[{'key':'speedRate','get':function _0xd08766(){var _0x4a2728=_0x265e;return this[_0x4a2728(0x20c)];},'set':function _0x5b96b1(_0x47f851){var _0x3afa45=_0x265e;this['_speedRate']=(0x64-(_0x47f851>0x63?0x63:_0x47f851))*0x64,this['_calc_speedRate']=[(this[_0x3afa45(0x2d5)]-this['xmin'])/this['_speedRate'],(this['ymax']-this['ymin'])/this['_speedRate']];}},{'key':'maxAge','get':function _0x1fe62a(){return this['_maxAge'];},'set':function _0x10e6ac(_0x5b7437){this['_maxAge']=_0x5b7437;}},{'key':'setOptions','value':function _0x234c9e(_0x49133a){var _0x1247e1=_0x265e;this['options']=_0x49133a,this[_0x1247e1(0x1e5)]=_0x49133a['maxAge']||0x78,this['speedRate']=_0x49133a[_0x1247e1(0x27b)]||0x32,this[_0x1247e1(0x2b7)]=[];var _0x6821d5=_0x49133a['particlesNumber']||0x1000;for(var _0x3f3da1=0x0;_0x3f3da1<_0x6821d5;_0x3f3da1++){var _0x47fb80=this['_randomParticle'](new CanvasParticle());this[_0x1247e1(0x2b7)]['push'](_0x47fb80);}}},{'key':'setDate','value':function _0x560d52(_0x2eab5c){var _0x3f8a0e=_0x265e;this['rows']=_0x2eab5c['rows'],this['cols']=_0x2eab5c[_0x3f8a0e(0x256)],this['xmin']=_0x2eab5c[_0x3f8a0e(0x23d)],this['xmax']=_0x2eab5c[_0x3f8a0e(0x2d5)],this[_0x3f8a0e(0x277)]=_0x2eab5c['ymin'],this[_0x3f8a0e(0x1e0)]=_0x2eab5c[_0x3f8a0e(0x1e0)],this[_0x3f8a0e(0x1da)]=[];var _0x1334e3=_0x2eab5c['udata'],_0x44cdc0=_0x2eab5c['vdata'],_0x4dbb6f=![];_0x1334e3['length']===this['rows']&&_0x1334e3[0x0]['length']===this[_0x3f8a0e(0x256)]&&(_0x4dbb6f=!![]);var _0x434b94=0x0,_0x2b2f40=null,_0x2c2861=null;for(var _0x5a0dd9=0x0;_0x5a0dd9<this[_0x3f8a0e(0x2a7)];_0x5a0dd9++){_0x2b2f40=[];for(var _0x41e445=0x0;_0x41e445<this['cols'];_0x41e445++,_0x434b94++){_0x4dbb6f?_0x2c2861=this['_calcUV'](_0x1334e3[_0x5a0dd9][_0x41e445],_0x44cdc0[_0x5a0dd9][_0x41e445]):_0x2c2861=this['_calcUV'](_0x1334e3[_0x434b94],_0x44cdc0[_0x434b94]),_0x2b2f40['push'](_0x2c2861);}this[_0x3f8a0e(0x1da)][_0x3f8a0e(0x205)](_0x2b2f40);}this['options']['reverseY']&&this['grid'][_0x3f8a0e(0x23b)]();}},{'key':'clear','value':function _0x20b4a3(){var _0x3a34c6=_0x265e;delete this['rows'],delete this['cols'],delete this[_0x3a34c6(0x23d)],delete this['xmax'],delete this['ymin'],delete this['ymax'],delete this['grid'],delete this['particles'];}},{'key':'toGridXY','value':function _0x5da0df(_0x14c087,_0x2ae79f){var _0x1aa454=_0x265e,_0x19acb7=(_0x14c087-this[_0x1aa454(0x23d)])/(this['xmax']-this[_0x1aa454(0x23d)])*(this['cols']-0x1),_0x2dca8c=(this['ymax']-_0x2ae79f)/(this[_0x1aa454(0x1e0)]-this[_0x1aa454(0x277)])*(this['rows']-0x1);return[_0x19acb7,_0x2dca8c];}},{'key':_0x3464a1(0x2d4),'value':function _0x58bb5c(_0x208ebb,_0x1a2d9f){var _0x3117ef=_0x3464a1;if(_0x208ebb<0x0||_0x208ebb>=this['cols']||_0x1a2d9f>=this['rows'])return[0x0,0x0,0x0];var _0x468d42=Math[_0x3117ef(0x1f2)](_0x208ebb),_0x2d3d0c=Math['floor'](_0x1a2d9f);if(_0x468d42===_0x208ebb&&_0x2d3d0c===_0x1a2d9f)return this['grid'][_0x1a2d9f][_0x208ebb];var _0xb89cef=_0x468d42+0x1,_0x42faad=_0x2d3d0c+0x1,_0x3844ab=this['getUVByXY'](_0x468d42,_0x2d3d0c),_0x35d391=this['getUVByXY'](_0xb89cef,_0x2d3d0c),_0x50ec1d=this['getUVByXY'](_0x468d42,_0x42faad),_0x24249f=this['getUVByXY'](_0xb89cef,_0x42faad),_0x3fe551=null;try{_0x3fe551=this['_bilinearInterpolation'](_0x208ebb-_0x468d42,_0x1a2d9f-_0x2d3d0c,_0x3844ab,_0x35d391,_0x50ec1d,_0x24249f);}catch(_0x23a638){console[_0x3117ef(0x23a)](_0x208ebb,_0x1a2d9f);}return _0x3fe551;}},{'key':'_bilinearInterpolation','value':function _0x3e1b91(_0x2ea546,_0x32d2b5,_0x2213cd,_0x3f8eed,_0x3de39b,_0x33c2f2){var _0x531d85=0x1-_0x2ea546,_0x1bda14=0x1-_0x32d2b5,_0x42eb65=_0x531d85*_0x1bda14,_0x31ea26=_0x2ea546*_0x1bda14,_0x36a4a3=_0x531d85*_0x32d2b5,_0x5267a0=_0x2ea546*_0x32d2b5,_0x5366e8=_0x2213cd[0x0]*_0x42eb65+_0x3f8eed[0x0]*_0x31ea26+_0x3de39b[0x0]*_0x36a4a3+_0x33c2f2[0x0]*_0x5267a0,_0x1dfdb7=_0x2213cd[0x1]*_0x42eb65+_0x3f8eed[0x1]*_0x31ea26+_0x3de39b[0x1]*_0x36a4a3+_0x33c2f2[0x1]*_0x5267a0;return this['_calcUV'](_0x5366e8,_0x1dfdb7);}},{'key':_0x3464a1(0x262),'value':function _0x306668(_0x2c5464,_0x551734){return[+_0x2c5464,+_0x551734,Math['sqrt'](_0x2c5464*_0x2c5464+_0x551734*_0x551734)];}},{'key':'getUVByPoint','value':function _0x293105(_0x53bd58,_0x11ce81){var _0x4db8e8=_0x3464a1;if(!this['isInExtent'](_0x53bd58,_0x11ce81))return null;var _0x25e65a=this[_0x4db8e8(0x25a)](_0x53bd58,_0x11ce81),_0x2b3b13=this['getUVByXY'](_0x25e65a[0x0],_0x25e65a[0x1]);return _0x2b3b13;}},{'key':_0x3464a1(0x207),'value':function _0x4ce0f5(_0x10e41e,_0x104b77){var _0x4b06c7=_0x3464a1;return _0x10e41e>=this['xmin']&&_0x10e41e<=this['xmax']&&_0x104b77>=this['ymin']&&_0x104b77<=this[_0x4b06c7(0x1e0)]?!![]:![];}},{'key':'getRandomLatLng','value':function _0x2e6603(){var _0x29a938=_0x3464a1,_0x5b18dd=fRandomByfloat(this[_0x29a938(0x23d)],this['xmax']),_0x5ea11e=fRandomByfloat(this['ymin'],this['ymax']);return{'lat':_0x5ea11e,'lng':_0x5b18dd};}},{'key':'getParticles','value':function _0x5be894(){var _0x4831c7=_0x3464a1,_0x27129f,_0x309327,_0x3080f1;for(var _0x292786=0x0,_0xe0bd1e=this['particles'][_0x4831c7(0x24f)];_0x292786<_0xe0bd1e;_0x292786++){var _0x214c78=this['particles'][_0x292786];_0x214c78[_0x4831c7(0x21d)]<=0x0&&(_0x214c78=this['_randomParticle'](_0x214c78));if(_0x214c78[_0x4831c7(0x21d)]>0x0){var _0x5652e2=_0x214c78['tlng'],_0x23691e=_0x214c78[_0x4831c7(0x259)];_0x3080f1=this[_0x4831c7(0x211)](_0x5652e2,_0x23691e),_0x3080f1?(_0x27129f=_0x5652e2+this['_calc_speedRate'][0x0]*_0x3080f1[0x0],_0x309327=_0x23691e+this['_calc_speedRate'][0x1]*_0x3080f1[0x1],_0x214c78[_0x4831c7(0x28d)]=_0x5652e2,_0x214c78['lat']=_0x23691e,_0x214c78['tlng']=_0x27129f,_0x214c78['tlat']=_0x309327,_0x214c78[_0x4831c7(0x21d)]--):_0x214c78['age']=0x0;}}return this['particles'];}},{'key':_0x3464a1(0x25d),'value':function _0x1649c8(_0xf6ce09){var _0xa3e2f=_0x3464a1,_0x3a7551,_0x1cfbc8;for(var _0x520aa1=0x0;_0x520aa1<0x1e;_0x520aa1++){_0x3a7551=this['getRandomLatLng'](),_0x1cfbc8=this[_0xa3e2f(0x211)](_0x3a7551['lng'],_0x3a7551[_0xa3e2f(0x25c)]);if(_0x1cfbc8&&_0x1cfbc8[0x2]>0x0)break;}if(!_0x1cfbc8)return _0xf6ce09;var _0x571c73=_0x3a7551['lng']+this['_calc_speedRate'][0x0]*_0x1cfbc8[0x0],_0x2e3209=_0x3a7551[_0xa3e2f(0x25c)]+this[_0xa3e2f(0x1df)][0x1]*_0x1cfbc8[0x1];return _0xf6ce09['lng']=_0x3a7551[_0xa3e2f(0x28d)],_0xf6ce09['lat']=_0x3a7551[_0xa3e2f(0x25c)],_0xf6ce09[_0xa3e2f(0x228)]=_0x571c73,_0xf6ce09['tlat']=_0x2e3209,_0xf6ce09['age']=Math[_0xa3e2f(0x206)](Math['random']()*this[_0xa3e2f(0x1e5)]),_0xf6ce09;}},{'key':'destroy','value':function _0x25c70(){for(var _0x2a0096 in this){delete this[_0x2a0096];}}}]),_0x5180d6;}());function fRandomByfloat(_0x345773,_0xb63934){var _0x3c60b2=_0x1a8bc1;return _0x345773+Math[_0x3c60b2(0x1eb)]()*(_0xb63934-_0x345773);}var Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],CanvasWindLayer=function(_0x4646fa){var _0x2fa349=_0x1a8bc1;_inherits(_0x2337e8,_0x4646fa);var _0x29faed=_createSuper(_0x2337e8);function _0x2337e8(){var _0x39f547=_0x265e,_0x50ebcc,_0x17e40b=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x2337e8),_0x50ebcc=_0x29faed['call'](this,_0x17e40b),_0x50ebcc[_0x39f547(0x246)](_0x17e40b),_0x50ebcc['canvas']=null,_0x50ebcc;}return _createClass(_0x2337e8,[{'key':'_setOptionsHook','value':function _0x5219e8(_0x628a44,_0x58d2fe){var _0x85c39c=_0x265e,_0x3fed59,_0x164654,_0x4bccb9;this['frameTime']=0x3e8/(_0x628a44['frameRate']||0xa),this[_0x85c39c(0x2c9)]=(_0x3fed59=this[_0x85c39c(0x2c0)]['pointerEvents'])!==null&&_0x3fed59!==void 0x0?_0x3fed59:![],this[_0x85c39c(0x2be)]=_0x628a44[_0x85c39c(0x2be)]||'#ffffff',this['lineWidth']=_0x628a44[_0x85c39c(0x29e)]||0x1,this['fixedHeight']=(_0x164654=_0x628a44[_0x85c39c(0x268)])!==null&&_0x164654!==void 0x0?_0x164654:0x0,this[_0x85c39c(0x264)]=(_0x4bccb9=_0x628a44[_0x85c39c(0x264)])!==null&&_0x4bccb9!==void 0x0?_0x4bccb9:![],this['windField']&&this[_0x85c39c(0x22c)]['setOptions'](_0x628a44);}},{'key':_0x2fa349(0x273),'get':function _0x20939b(){return this['canvas'];}},{'key':_0x2fa349(0x1e8),'get':function _0x482446(){var _0x425d31=_0x2fa349;return this['_map']['scene']['canvas'][_0x425d31(0x227)];}},{'key':_0x2fa349(0x225),'get':function _0x313c30(){var _0x2d581d=_0x2fa349;return this['_map']['scene']['canvas'][_0x2d581d(0x235)];}},{'key':_0x2fa349(0x25e),'get':function _0x50598a(){return this['_pointerEvents'];},'set':function _0x328634(_0x2ed887){var _0x2183c6=_0x2fa349;this['_pointerEvents']=_0x2ed887;if(!this['canvas'])return;_0x2ed887?this[_0x2183c6(0x1e1)]['style']['pointer-events']='all':this['canvas']['style']['pointer-events']='none';}},{'key':'particlesNumber','get':function _0x43e114(){return this['options']['particlesNumber'];},'set':function _0x477dd3(_0x3df4c3){var _0x272be2=_0x2fa349,_0x539bdc=this;this[_0x272be2(0x2c0)]['particlesNumber']=_0x3df4c3,clearTimeout(this['_canrefresh']),this['_canrefresh']=setTimeout(function(){_0x539bdc['redraw']();},0x1f4);}},{'key':'speedRate','get':function _0x57c359(){var _0x21007a=_0x2fa349;return this[_0x21007a(0x2c0)]['speedRate'];},'set':function _0x54e5b6(_0x108e87){this['options']['speedRate']=_0x108e87,this['windField']&&(this['windField']['speedRate']=_0x108e87);}},{'key':'maxAge','get':function _0x48ce75(){var _0x563d68=_0x2fa349;return this['options'][_0x563d68(0x1e5)];},'set':function _0x3605ab(_0xd7dbbe){var _0x43dd85=_0x2fa349;this['options']['maxAge']=_0xd7dbbe,this[_0x43dd85(0x22c)]&&(this['windField']['maxAge']=_0xd7dbbe);}},{'key':'data','get':function _0x44c079(){return this['windData'];},'set':function _0x4935e7(_0x53f152){this['setData'](_0x53f152);}},{'key':'_showHook','value':function _0x5c3486(_0x278f91){var _0x987925=_0x2fa349;_0x278f91?this['_addedHook']():(this[_0x987925(0x1f3)]&&(this['options']['data']=this['windData']),this['_removedHook']());}},{'key':'_mountedHook','value':function _0x5d1317(){var _0x3146a4=_0x2fa349;this['options']['worker']?this[_0x3146a4(0x275)]():this[_0x3146a4(0x22c)]=new CanvasWindField(this['options']);}},{'key':'_addedHook','value':function _0x162722(){var _0x59045b=_0x2fa349;this[_0x59045b(0x1e1)]=this['_createCanvas'](),this['canvasContext']=this['canvas'][_0x59045b(0x2ce)]('2d',{'willReadFrequently':!![]}),this['bindEvent'](),this['options']['data']&&this['setData'](this['options']['data']);}},{'key':'_removedHook','value':function _0x1b3a1b(){var _0xab0193=_0x2fa349;this['clear'](),this['unbindEvent'](),this[_0xab0193(0x1e1)]&&(this[_0xab0193(0x24c)][_0xab0193(0x2ab)]['removeChild'](this['canvas']),delete this[_0xab0193(0x1e1)]);}},{'key':'_createCanvas','value':function _0x1f04a4(){var _0x88aab0=_0x2fa349,_0x325918=document['createElement']('canvas');_0x325918['style']['position']='absolute',_0x325918['style']['top']='0px',_0x325918['style']['left']=_0x88aab0(0x217),_0x325918['style']['width']=_0x88aab0(0x270),_0x325918['style'][_0x88aab0(0x2e4)]='100%',_0x325918['style']['pointerEvents']=this['_pointerEvents']?_0x88aab0(0x1ed):_0x88aab0(0x240),_0x325918[_0x88aab0(0x253)]['zIndex']=0xa,_0x325918['setAttribute']('id','canvasWindy'),_0x325918['setAttribute']('class','canvasWindy'),this['_map']['container']['appendChild'](_0x325918);var _0x587fae=this[_0x88aab0(0x24c)]['scene'];return _0x325918['width']=_0x587fae['canvas']['clientWidth'],_0x325918['height']=_0x587fae['canvas']['clientHeight'],_0x325918;}},{'key':_0x2fa349(0x2d2),'value':function _0x3aaab3(){var _0x2ac16e=_0x2fa349;this['canvas']&&(this['canvas']['width']=this[_0x2ac16e(0x1e8)],this['canvas']['height']=this['canvasHeight']);}},{'key':'bindEvent','value':function _0x162e4c(){var _0x1a73e5=_0x2fa349,_0x198b71=this,_0x156dd5=Date['now']();(function _0x583419(){var _0xc7e10e=_0x265e;_0x198b71['animateFrame']=window[_0xc7e10e(0x286)](_0x583419);if(_0x198b71[_0xc7e10e(0x24d)]&&_0x198b71[_0xc7e10e(0x22c)]){var _0x3f40d1=Date[_0xc7e10e(0x23f)](),_0x2357f1=_0x3f40d1-_0x156dd5;_0x2357f1>_0x198b71[_0xc7e10e(0x22d)]&&(_0x156dd5=_0x3f40d1-_0x2357f1%_0x198b71['frameTime'],_0x198b71['update']());}}(),window[_0x1a73e5(0x27d)]('resize',this['resize']['bind'](this),![]),this['mouse_down']=![],this['mouse_move']=![],this['options']['mouseHidden']&&(this['_map']['on'](mars3d__namespace[_0x1a73e5(0x24b)]['wheel'],this[_0x1a73e5(0x1dd)],this),this[_0x1a73e5(0x24c)]['on'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseUp'],this[_0x1a73e5(0x274)],this)));}},{'key':'unbindEvent','value':function _0x5da8c8(){var _0x295f20=_0x2fa349;window['cancelAnimationFrame'](this['animateFrame']),delete this[_0x295f20(0x2d8)],window['removeEventListener'](_0x295f20(0x2d2),this['resize']),this['options'][_0x295f20(0x1e3)]&&(this['_map']['off'](mars3d__namespace['EventType']['wheel'],this[_0x295f20(0x1dd)],this),this['_map'][_0x295f20(0x2a3)](mars3d__namespace['EventType'][_0x295f20(0x1de)],this[_0x295f20(0x293)],this),this['_map']['off'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x295f20(0x1ee)],this));}},{'key':'_onMapWhellEvent','value':function _0x31255d(_0x55199f){var _0x35ba8d=_0x2fa349,_0x669fce=this;clearTimeout(this[_0x35ba8d(0x27c)]);if(!this['show']||!this[_0x35ba8d(0x1e1)])return;this['canvas']['style']['visibility']=_0x35ba8d(0x202),this['refreshTimer']=setTimeout(function(){var _0x496af0=_0x35ba8d;if(!_0x669fce['show'])return;_0x669fce['redraw'](),_0x669fce[_0x496af0(0x1e1)]['style'][_0x496af0(0x2a6)]=_0x496af0(0x2e2);},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x4413f8(_0x150ddb){var _0x15be0e=_0x2fa349;this['mouse_down']=!![],this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x15be0e(0x1ee)],this),this['_map']['on'](mars3d__namespace[_0x15be0e(0x24b)]['mouseMove'],this[_0x15be0e(0x1ee)],this);}},{'key':_0x2fa349(0x1ee),'value':function _0x3c098f(_0x35439a){var _0x2bdaf7=_0x2fa349;if(!this[_0x2bdaf7(0x24d)]||!this['canvas'])return;this['mouse_down']&&(this['canvas']['style']['visibility']=_0x2bdaf7(0x202),this['mouse_move']=!![]);}},{'key':'_onMouseUpEvent','value':function _0x1d8f63(_0x3e653e){var _0x18f602=_0x2fa349;if(!this['show']||!this['canvas'])return;this[_0x18f602(0x24c)]['off'](mars3d__namespace[_0x18f602(0x24b)]['mouseMove'],this['_onMouseMoveEvent'],this),this[_0x18f602(0x2c4)]&&this['mouse_move']&&this[_0x18f602(0x2a2)](),this['canvas']['style']['visibility']='visible',this[_0x18f602(0x2c4)]=![],this[_0x18f602(0x2ba)]=![];}},{'key':_0x2fa349(0x2d1),'value':function _0x5488b5(_0x12250f){var _0x2e8cbb=_0x2fa349;this[_0x2e8cbb(0x285)](),this[_0x2e8cbb(0x1f3)]=_0x12250f,this[_0x2e8cbb(0x22c)]['setDate'](_0x12250f),this[_0x2e8cbb(0x2a2)]();}},{'key':'redraw','value':function _0x3ddda8(){var _0x452871=_0x2fa349;if(!this[_0x452871(0x24d)])return;this['windField'][_0x452871(0x267)](this['options']),this['update']();}},{'key':_0x2fa349(0x1fd),'value':function _0x36ce05(){var _0x27120d=_0x2fa349;if(this['_updateIng'])return;this[_0x27120d(0x226)]=!![];if(this[_0x27120d(0x2ad)])this['windField'][_0x27120d(0x1fd)]();else{var _0xf84767=this['windField'][_0x27120d(0x213)]();this['_drawLines'](_0xf84767);}this[_0x27120d(0x226)]=![];}},{'key':_0x2fa349(0x21a),'value':function _0x4d14d0(_0x5457dc){var _0x3fa5a1=_0x2fa349;this[_0x3fa5a1(0x2ae)]['globalCompositeOperation']='destination-in',this['canvasContext'][_0x3fa5a1(0x239)](0x0,0x0,this['canvasWidth'],this[_0x3fa5a1(0x225)]),this['canvasContext'][_0x3fa5a1(0x257)]='lighter',this['canvasContext']['globalAlpha']=0.9,this[_0x3fa5a1(0x2ae)]['beginPath'](),this[_0x3fa5a1(0x2ae)]['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this['color'];var _0x707c22=this['_map'][_0x3fa5a1(0x2d7)]['mode']!==Cesium['SceneMode']['SCENE3D'];for(var _0x38b9a4=0x0,_0xa3e9a7=_0x5457dc['length'];_0x38b9a4<_0xa3e9a7;_0x38b9a4++){var _0x44181f=_0x5457dc[_0x38b9a4],_0x4b02dd=this[_0x3fa5a1(0x26b)](_0x44181f['lng'],_0x44181f['lat'],_0x44181f),_0x2dca0a=this[_0x3fa5a1(0x26b)](_0x44181f['tlng'],_0x44181f['tlat'],_0x44181f);if(!_0x4b02dd||!_0x2dca0a)continue;if(_0x707c22&&Math[_0x3fa5a1(0x2cd)](_0x4b02dd[0x0]-_0x2dca0a[0x0])>=this['canvasWidth'])continue;this['canvasContext']['moveTo'](_0x4b02dd[0x0],_0x4b02dd[0x1]),this['canvasContext']['lineTo'](_0x2dca0a[0x0],_0x2dca0a[0x1]);}this['canvasContext']['stroke']();}},{'key':_0x2fa349(0x26b),'value':function _0x2ede13(_0x572b05,_0x5eab11,_0x3aa264){var _0x566979=_0x2fa349,_0x1c9877=Cesium['Cartesian3'][_0x566979(0x2a9)](_0x572b05,_0x5eab11,this['fixedHeight']),_0x1b9671=this['_map']['scene'];if(_0x1b9671['mode']===Cesium['SceneMode']['SCENE3D']){var _0x80df97=new Cesium[(_0x566979(0x2db))](_0x1b9671[_0x566979(0x2e0)]['ellipsoid'],_0x1b9671[_0x566979(0x1e7)]['positionWC']),_0x3483b6=_0x80df97[_0x566979(0x200)](_0x1c9877);if(!_0x3483b6)return _0x3aa264['age']=0x0,null;}var _0x15625a=Cesium['SceneTransforms']['wgs84ToWindowCoordinates'](this['_map'][_0x566979(0x2d7)],_0x1c9877);return _0x15625a?[_0x15625a['x'],_0x15625a['y']]:null;}},{'key':'clear','value':function _0x5b8754(){var _0xc64240=_0x2fa349;this['windField'][_0xc64240(0x285)](),delete this[_0xc64240(0x1f3)];}},{'key':'initWorker','value':function _0x55a8e6(){var _0x415e07=_0x2fa349,_0x10e0ef=this;this[_0x415e07(0x2ad)]=new Worker(this['options']['worker']),this['worker']['onmessage']=function(_0x233b92){var _0x2a14c7=_0x415e07;_0x10e0ef['_drawLines'](_0x233b92['data']['particles']),_0x10e0ef[_0x2a14c7(0x2e6)]=![];},this['windField']={'init':function _0x2b9450(_0x9cd284){var _0x2b8d8e=_0x415e07;_0x10e0ef['worker'][_0x2b8d8e(0x2a8)]({'type':'init','options':_0x9cd284});},'setOptions':function _0x5c7463(_0x13c4eb){var _0x2ce28a=_0x415e07;_0x10e0ef['worker'][_0x2ce28a(0x2a8)]({'type':'setOptions','options':_0x13c4eb});},'setDate':function _0x263e12(_0x4a5065){var _0x3b7d60=_0x415e07;_0x10e0ef['worker']['postMessage']({'type':_0x3b7d60(0x297),'data':_0x4a5065});},'update':function _0x8ba70e(){var _0x412111=_0x415e07;if(_0x10e0ef['_updateIng2'])return;_0x10e0ef['_updateIng2']=!![],_0x10e0ef['worker'][_0x412111(0x2a8)]({'type':_0x412111(0x1fd)});},'clear':function _0x400ceb(){var _0x2bdab9=_0x415e07;_0x10e0ef['worker']['postMessage']({'type':_0x2bdab9(0x285)});}},this[_0x415e07(0x22c)]['init'](this[_0x415e07(0x2c0)]);}}]),_0x2337e8;}(BaseLayer);mars3d__namespace['LayerUtil'][_0x1a8bc1(0x242)]('canvasWind',CanvasWindLayer),mars3d__namespace[_0x1a8bc1(0x273)][_0x1a8bc1(0x288)]=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace['WindUtil']=WindUtil,exports['CanvasWindField']=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports[_0x1a8bc1(0x1fb)]=WindLayer,exports['WindUtil']=WindUtil,Object[_0x1a8bc1(0x2b6)](exports,'__esModule',{'value':!![]});
}));
