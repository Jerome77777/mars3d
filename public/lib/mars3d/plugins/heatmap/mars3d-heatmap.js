/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.13
 * 编译日期：2023-11-20 21:18:04
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x200d61=_0x1d05;(function(_0xf7e4b7,_0x3f5ca5){const _0x31d8e7={_0x27b7e0:0xfa,_0x404584:0xe7,_0x8097ae:0xda},_0xe73705=_0x1d05,_0x292288=_0xf7e4b7();while(!![]){try{const _0x5e3493=parseInt(_0xe73705(0xf1))/0x1*(parseInt(_0xe73705(0xdc))/0x2)+-parseInt(_0xe73705(0xd6))/0x3*(parseInt(_0xe73705(0xd0))/0x4)+-parseInt(_0xe73705(0xfe))/0x5*(parseInt(_0xe73705(0xbf))/0x6)+parseInt(_0xe73705(0xc5))/0x7*(parseInt(_0xe73705(_0x31d8e7._0x27b7e0))/0x8)+parseInt(_0xe73705(_0x31d8e7._0x404584))/0x9*(-parseInt(_0xe73705(0xc1))/0xa)+-parseInt(_0xe73705(_0x31d8e7._0x8097ae))/0xb+-parseInt(_0xe73705(0xd7))/0xc*(-parseInt(_0xe73705(0xf3))/0xd);if(_0x5e3493===_0x3f5ca5)break;else _0x292288['push'](_0x292288['shift']());}catch(_0x3e45a1){_0x292288['push'](_0x292288['shift']());}}}(_0xcec7,0xd6cd2));function _0xcec7(){const _0x5e5d15=['KEEP','rgb(140,140,140)','abs','clear','_scale','_updatePositionsHook','_rectangle','uniforms','9DrDmIF','parse','_container','value','isFormat','_graphic','rgb(216,216,216)','LngLatPoint','GraphicLayer','copyCanvas','2KYhEFn','_renderer','13Dwdohj','formatRectangle','_getHeatCanvas','__esModule','options','Util','rectangle','528oTiBAY','_getArcHeatCanvas','get','PointTrans','2815XZZBql','red','heatStyle','lonlat2mercator','_positions','_layer','arcBlurScale','min','_mBoundsMax','style','ymin','_createGraphic','ALPHA_BLEND','floor','forEach','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','_last_mBounds','ImageLayer','create','DomUtil','lat','_graphic2','addGraphic','minCanvasSize','StencilFunction','opacity','_map','2682ImayKV','RectanglePrimitive','1230280IMdriO','xmax','clientWidth','max','88221LmZShW','maxCanvasSize','lng','radius','merge','xmin','setPositions','toDataURL','toArray','remove','gradientArc','396djcmfV','_createArcGraphic','EllipsoidSurfaceAppearance','granularity','default','ymax','48894kTWfer','29274612ybXuVC','type','_heat','16058482vNUsQG','positions','1056530OmrSAo','Rectangle','push'];_0xcec7=function(){return _0x5e5d15;};return _0xcec7();}function _0x1d05(_0x1b704b,_0x4e40e9){const _0xcec746=_0xcec7();return _0x1d05=function(_0x1d0537,_0x5318c7){_0x1d0537=_0x1d0537-0xa8;let _0x3c7cbc=_0xcec746[_0x1d0537];return _0x3c7cbc;},_0x1d05(_0x1b704b,_0x4e40e9);}function _interopNamespace(_0x3ccab5){const _0x356855={_0x1675b3:0xf6},_0x2c45d4={_0x255d06:0xd4,_0x505256:0xfc},_0x496498=_0x1d05;if(_0x3ccab5&&_0x3ccab5[_0x496498(_0x356855._0x1675b3)])return _0x3ccab5;var _0x1971d0=Object['create'](null);return _0x3ccab5&&Object['keys'](_0x3ccab5)['forEach'](function(_0x1f3154){const _0xed3b4f=_0x496498;if(_0x1f3154!==_0xed3b4f(_0x2c45d4._0x255d06)){var _0x3bddc9=Object['getOwnPropertyDescriptor'](_0x3ccab5,_0x1f3154);Object['defineProperty'](_0x1971d0,_0x1f3154,_0x3bddc9[_0xed3b4f(_0x2c45d4._0x505256)]?_0x3bddc9:{'enumerable':!![],'get':function(){return _0x3ccab5[_0x1f3154];}});}}),_0x1971d0['default']=_0x3ccab5,_0x1971d0;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace[_0x200d61(0xb6)])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:_0x200d61(0xff)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x2bb528={}){const _0x140460={_0x702c2c:0xc6,_0x1ab3c1:0xf7,_0x49d123:0xf7},_0x5af0c3=_0x200d61;super(_0x2bb528),this[_0x5af0c3(0xf7)]['maxCanvasSize']=this['options'][_0x5af0c3(_0x140460._0x702c2c)]??document['body'][_0x5af0c3(0xc3)],this['options']['maxCanvasSize']=Math['min'](this['options']['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this[_0x5af0c3(_0x140460._0x1ab3c1)]['minCanvasSize']??document['body']['clientHeight'],this[_0x5af0c3(_0x140460._0x1ab3c1)]['minCanvasSize']=Math[_0x5af0c3(0xc4)](this[_0x5af0c3(_0x140460._0x1ab3c1)][_0x5af0c3(0xbb)],0x2bc),this[_0x5af0c3(_0x140460._0x49d123)]['heatStyle']={...DEF_HEATSTYLE,...this[_0x5af0c3(0xf7)]['heatStyle']},this['options']['style']={...DEF_STYLE,...this[_0x5af0c3(0xf7)]['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set[_0x200d61(0x100)](_0x3c6b44){const _0x1d4c4e={_0x43df14:0xf8,_0x3a8532:0xf7,_0x4bfb0e:0xe4},_0x4c8ee2=_0x200d61;this[_0x4c8ee2(0xf7)][_0x4c8ee2(0x100)]=mars3d__namespace[_0x4c8ee2(_0x1d4c4e._0x43df14)][_0x4c8ee2(0xc9)](this[_0x4c8ee2(_0x1d4c4e._0x3a8532)][_0x4c8ee2(0x100)],_0x3c6b44),this['_heat']&&(this['_heat']['configure'](this['options']['heatStyle']),this[_0x4c8ee2(_0x1d4c4e._0x4bfb0e)](!![]));}get[_0x200d61(0xad)](){const _0x5e3625=_0x200d61;return this['options'][_0x5e3625(0xad)];}set['style'](_0x3a10a8){const _0xce84b6=_0x200d61;this['options']['style']=mars3d__namespace['Util'][_0xce84b6(0xc9)](this['options']['style'],_0x3a10a8);}get[_0x200d61(0xdb)](){return this['_positions'];}set['positions'](_0xc80d34){this['setPositions'](_0xc80d34);}get['coordinates'](){const _0x5d1efd=_0x200d61,_0x3d791f=[];return this['points'][_0x5d1efd(0xb2)](_0x1dd192=>{const _0x177510=_0x5d1efd;_0x3d791f['push'](_0x1dd192[_0x177510(0xcd)]());}),_0x3d791f;}get['rectangle'](){const _0x42df5a={_0x176cab:0xe5},_0x1e4eea=_0x200d61;return this[_0x1e4eea(_0x42df5a._0x176cab)];}['_setOptionsHook'](_0x58b798,_0x1c08dc){const _0x115d94={_0x3789d8:0xdb},_0x40a36c=_0x200d61;_0x58b798['positions']&&(this[_0x40a36c(_0x115d94._0x3789d8)]=_0x58b798['positions']);}['_mountedHook'](){const _0x4f6ee4={_0x428ee8:0xd8},_0x13ecb7=_0x200d61;this['style'][_0x13ecb7(_0x4f6ee4._0x428ee8)]==='image'?this['_layer']=new mars3d__namespace['layer'][(_0x13ecb7(0xb5))]({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer'][(_0x13ecb7(0xef))]({'private':!![]});}['_addedHook'](){const _0x4fda5f={_0xce6b5a:0xe9,_0x5c8c90:0xdb},_0x1e7dea=_0x200d61;this['_map']['addLayer'](this['_layer']),this[_0x1e7dea(_0x4fda5f._0xce6b5a)]=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options'][_0x1e7dea(_0x4fda5f._0x5c8c90)]),this['options']['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x196f24={_0x4abe8b:0xce,_0x9aaee3:0xbe},_0x5ecfa5=_0x200d61;this['_container']&&(mars3d__namespace['DomUtil'][_0x5ecfa5(_0x196f24._0x4abe8b)](this['_container']),delete this['_container']),this[_0x5ecfa5(0xe2)](),this[_0x5ecfa5(_0x196f24._0x9aaee3)]['removeLayer'](this[_0x5ecfa5(0xa9)]);}['addPosition'](_0xe22abf,_0x1c5089){const _0x40f2d9={_0x13fe5a:0xa8},_0x423538=_0x200d61;this[_0x423538(_0x40f2d9._0x13fe5a)]=this['_positions']||[],this['_positions']['push'](_0xe22abf),this['_updatePositionsHook'](_0x1c5089);}[_0x200d61(0xcb)](_0x3b65bb,_0x4490a8){this['_positions']=_0x3b65bb,this['_updatePositionsHook'](_0x4490a8);}['clear'](){const _0x25fa4f={_0x503c08:0xb9},_0x52e4ae=_0x200d61;this['_graphic']&&(this[_0x52e4ae(0xa9)]['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this[_0x52e4ae(0xb9)]&&(this[_0x52e4ae(0xa9)]['removeGraphic'](this['_graphic2'],!![]),delete this[_0x52e4ae(_0x25fa4f._0x503c08)]);}['_updatePositionsHook'](_0x374a17){const _0x3818bf={_0x27063d:0xf5,_0x31fca9:0xad,_0x2541ee:0xfb,_0x488ffe:0xe6},_0x5aae62=_0x200d61;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x586107=this[_0x5aae62(_0x3818bf._0x27063d)]();if(this[_0x5aae62(_0x3818bf._0x31fca9)][_0x5aae62(0xd8)]==='image')this['_layer']['setOptions']({'url':_0x586107[_0x5aae62(0xcc)]('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0x5aae62(0xbd)]});else this['style']['arc']?this['_graphic']&&_0x374a17?(this['_graphic']['uniforms']['image']=_0x586107,this['_graphic']['uniforms']['bumpMap']=this[_0x5aae62(_0x3818bf._0x2541ee)](),this['_graphic2']&&(this[_0x5aae62(0xb9)][_0x5aae62(_0x3818bf._0x488ffe)]['image']=_0x586107,this['_graphic2']['uniforms']['bumpMap']=this['_graphic'][_0x5aae62(0xe6)]['bumpMap'])):this['_createArcGraphic'](_0x586107):this['_graphic']&&_0x374a17?this['_graphic']['uniforms']['image']=_0x586107:this['_createGraphic'](_0x586107);return this;}[_0x200d61(0xaf)](_0x5ed2da){const _0x10685d={_0x55917b:0xc0},_0x674331=_0x200d61;this['clear'](),this['_graphic']=new mars3d__namespace['graphic'][(_0x674331(_0x10685d._0x55917b))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x674331(0xd2))]({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x5ed2da},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x674331(0xa9)][_0x674331(0xba)](this[_0x674331(0xec)]);}[_0x200d61(0xd1)](_0x1b7bd3){const _0x4ada0b={_0x11c756:0xe2,_0xe5d7aa:0xdf,_0x2cbc53:0xb1,_0x1d4f5b:0xad,_0xec9085:0xe5,_0x479730:0xd3,_0x487378:0xc0,_0x2ce634:0xd2,_0x2764be:0xa9,_0x6d9344:0xec,_0x3f6b64:0xb9,_0x5e0be0:0xf7},_0x59870e=_0x200d61;this[_0x59870e(_0x4ada0b._0x11c756)]();const _0x47c454=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x59870e(0xdf)],'zFail':Cesium['StencilOperation'][_0x59870e(0xdf)],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x59870e(0xbc)]['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation'][_0x59870e(_0x4ada0b._0xe5d7aa)],'zFail':Cesium['StencilOperation'][_0x59870e(0xdf)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x59870e(0xb0)]}),_0x5d8c5c=Math[_0x59870e(_0x4ada0b._0x2cbc53)](this['style']['diffHeight']??this[_0x59870e(0xac)]*0.02)+0.1;this['style']['diffHeight']&&delete this['style']['diffHeight'];const _0x2f3d96=(this[_0x59870e(_0x4ada0b._0x1d4f5b)]['splitNum'],0x64);let _0x1244cb=Math['max'](this[_0x59870e(0xe5)]['height'],this[_0x59870e(_0x4ada0b._0xec9085)]['width']);this['style'][_0x59870e(_0x4ada0b._0x479730)]=_0x1244cb/=_0x2f3d96;const _0x1587d3=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1b7bd3,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x4f8595=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x59870e(_0x4ada0b._0x487378))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x59870e(_0x4ada0b._0x2ce634))]({'flat':!![],'aboveGround':!![],'renderState':_0x47c454,'material':_0x1587d3,'vertexShaderSource':getVertexShaderSource(_0x5d8c5c*_0x4f8595)})}),this[_0x59870e(_0x4ada0b._0x2764be)]['addGraphic'](this[_0x59870e(_0x4ada0b._0x6d9344)]),this['style']['arcDirection']===0x0&&(this[_0x59870e(_0x4ada0b._0x3f6b64)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x59870e(_0x4ada0b._0x5e0be0)],'rectangle':this[_0x59870e(0xe5)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x47c454,'material':_0x1587d3,'vertexShaderSource':getVertexShaderSource(-_0x5d8c5c)})}),this['_layer']['addGraphic'](this['_graphic2']));}['getRectangle'](_0x1e45bc){const _0x26d648={_0x5f4154:0xeb,_0xe77d37:0xf4,_0x17e508:0xe5},_0x1682b0=_0x200d61;return _0x1e45bc!==null&&_0x1e45bc!==void 0x0&&_0x1e45bc[_0x1682b0(_0x26d648._0x5f4154)]&&this['_rectangle']?mars3d__namespace['PolyUtil'][_0x1682b0(_0x26d648._0xe77d37)](this['_rectangle']):this[_0x1682b0(_0x26d648._0x17e508)];}['_getHeatCanvas'](){const _0x52e1fc={_0x1b5cc4:0xc2,_0x2aa44d:0xca,_0x5404a2:0xe1,_0x48e3e1:0xc6,_0x3d6b84:0xe5,_0x3c0f14:0xdd,_0x44a24c:0xea,_0x5bbdc1:0xf7,_0x408681:0xb4,_0x533fa5:0xb6,_0x4f5c24:0xb7},_0x15e138={_0x346fa9:0x101,_0x25b0aa:0xd5,_0x53af8f:0xc4},_0x23aae4={_0x14820f:0xe8,_0x47ef02:0xea,_0x3f0d3c:0xc7,_0x1a6dc8:0xc7,_0x3ec88a:0xb8},_0x5015b7=_0x200d61,_0x1fc7e5=this['_positions'],_0x2fcfc7=[];let _0xa093a3,_0x1784ec,_0x3b643c,_0x274f18;_0x1fc7e5['forEach'](_0x30de36=>{const _0x396a29=_0x1d05,_0x4f3ba1=mars3d__namespace[_0x396a29(0xee)][_0x396a29(_0x23aae4._0x14820f)](_0x30de36);if(!_0x4f3ba1)return;_0x4f3ba1['value']=_0x30de36[_0x396a29(_0x23aae4._0x47ef02)]||0x1,!this['options']['rectangle']&&(_0xa093a3===undefined?(_0xa093a3=_0x4f3ba1[_0x396a29(_0x23aae4._0x3f0d3c)],_0x1784ec=_0x4f3ba1[_0x396a29(_0x23aae4._0x1a6dc8)],_0x3b643c=_0x4f3ba1['lat'],_0x274f18=_0x4f3ba1['lat']):(_0xa093a3=Math[_0x396a29(0xab)](_0xa093a3,_0x4f3ba1['lng']),_0x1784ec=Math['max'](_0x1784ec,_0x4f3ba1['lng']),_0x3b643c=Math['min'](_0x3b643c,_0x4f3ba1['lat']),_0x274f18=Math['max'](_0x274f18,_0x4f3ba1[_0x396a29(_0x23aae4._0x3ec88a)]))),_0x2fcfc7[_0x396a29(0xde)](_0x4f3ba1);});_0xa093a3===_0x1784ec&&(_0xa093a3-=0.000001,_0x1784ec+=0.000001);_0x3b643c===_0x274f18&&(_0x3b643c-=0.000001,_0x274f18+=0.000001);let _0x285ebd=this['options'][_0x5015b7(0xf9)]||{'xmin':_0xa093a3,'xmax':_0x1784ec,'ymin':_0x3b643c,'ymax':_0x274f18};const _0x56c653=getMercatorBounds(_0x285ebd),_0x412fb2=Math['abs'](_0x56c653[_0x5015b7(_0x52e1fc._0x1b5cc4)]-_0x56c653[_0x5015b7(_0x52e1fc._0x2aa44d)]),_0x10000a=Math[_0x5015b7(_0x52e1fc._0x5404a2)](_0x56c653['ymax']-_0x56c653['ymin']),_0x18baee=Math['max'](_0x412fb2,_0x10000a),_0x467e33=Math['min'](_0x412fb2,_0x10000a);this['_mBoundsMax']=_0x18baee;let _0xe84be4=0x1;if(_0x18baee>this['options'][_0x5015b7(0xc6)])_0xe84be4=_0x18baee/this['options'][_0x5015b7(_0x52e1fc._0x48e3e1)],_0x467e33/_0xe84be4<this[_0x5015b7(0xf7)]['minCanvasSize']&&(_0xe84be4=_0x467e33/this['options']['minCanvasSize']);else _0x467e33<this['options']['minCanvasSize']&&(_0xe84be4=_0x467e33/this['options']['minCanvasSize'],_0x18baee/_0xe84be4>this['options']['maxCanvasSize']&&(_0xe84be4=_0x18baee/this['options'][_0x5015b7(0xc6)]));const _0x3741fc=this[_0x5015b7(0x100)]['radius']*1.5,_0x3a1488=_0x412fb2/_0xe84be4+_0x3741fc*0x2,_0x2bd8e2=_0x10000a/_0xe84be4+_0x3741fc*0x2,_0x32313b=_0x3741fc*_0xe84be4;_0x56c653[_0x5015b7(_0x52e1fc._0x2aa44d)]-=_0x32313b,_0x56c653['ymin']-=_0x32313b,_0x56c653['xmax']+=_0x32313b,_0x56c653['ymax']+=_0x32313b,this['_scale']=_0xe84be4,_0x285ebd=geLatLngBounds(_0x56c653),this[_0x5015b7(_0x52e1fc._0x3d6b84)]=Cesium[_0x5015b7(_0x52e1fc._0x3c0f14)]['fromDegrees'](_0x285ebd['xmin'],_0x285ebd['ymin'],_0x285ebd['xmax'],_0x285ebd['ymax']);let _0x36fd90=_0x2fcfc7[0x0][_0x5015b7(_0x52e1fc._0x44a24c)]??0x1,_0x2f73c6=_0x2fcfc7[0x0]['value']??0x0;const _0x109477=[];_0x2fcfc7['forEach'](_0x14e885=>{const _0x32488b=_0x5015b7,_0x1e739f=mars3d__namespace['PointTrans'][_0x32488b(_0x15e138._0x346fa9)]([_0x14e885['lng'],_0x14e885[_0x32488b(0xb8)]]),_0x220292=_0x14e885['value']||0x1,_0x491098=Math['round']((_0x1e739f[0x0]-_0x56c653['xmin'])/_0xe84be4),_0x42731e=Math['round']((_0x56c653[_0x32488b(_0x15e138._0x25b0aa)]-_0x1e739f[0x1])/_0xe84be4);_0x36fd90=Math[_0x32488b(_0x15e138._0x53af8f)](_0x36fd90,_0x220292),_0x2f73c6=Math['min'](_0x2f73c6,_0x220292),_0x109477['push']({'x':_0x491098,'y':_0x42731e,'value':_0x220292});});const _0x5c528a={'min':this[_0x5015b7(_0x52e1fc._0x5bbdc1)]['min']??_0x2f73c6,'max':this['options']['max']??_0x36fd90,'data':_0x109477};this['_last_heatData']=_0x5c528a;if(!this[_0x5015b7(_0x52e1fc._0x408681)]||_0x56c653['xmin']!==this['_last_mBounds'][_0x5015b7(_0x52e1fc._0x2aa44d)]||_0x56c653[_0x5015b7(0xae)]!==this[_0x5015b7(0xb4)]['ymin']||_0x56c653['xmax']!==this['_last_mBounds'][_0x5015b7(0xc2)]||_0x56c653['ymax']!==this[_0x5015b7(_0x52e1fc._0x408681)]['ymax']){this['_last_mBounds']=_0x56c653,this[_0x5015b7(0xe9)]['style']['cssText']='width:'+_0x3a1488+'px;height:'+_0x2bd8e2+'px;';const _0x5928e8={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace[_0x5015b7(_0x52e1fc._0x533fa5)](_0x5928e8):this['_heat']['configure'](_0x5928e8);}this[_0x5015b7(0xd9)]['setData'](_0x5c528a);const _0x12f580=mars3d__namespace[_0x5015b7(_0x52e1fc._0x4f5c24)][_0x5015b7(0xf0)](this['_heat'][_0x5015b7(0xf2)]['canvas']);return _0x12f580;}['_getArcHeatCanvas'](){const _0x17e991={_0x3d70c9:0x100,_0x1ccbbc:0xcf,_0x235fa9:0xed},_0x5e7dd3=_0x200d61;this['_heat']['configure']({'radius':this[_0x5e7dd3(_0x17e991._0x3d70c9)][_0x5e7dd3(0xc8)]*this['style']['arcRadiusScale'],'blur':this[_0x5e7dd3(0x100)]['blur']*this[_0x5e7dd3(0xad)][_0x5e7dd3(0xaa)],'gradient':this['heatStyle'][_0x5e7dd3(_0x17e991._0x1ccbbc)]||{0.25:'rgb(0,0,0)',0.55:_0x5e7dd3(0xe0),0.85:_0x5e7dd3(_0x17e991._0x235fa9),0x1:'rgb(255,255,255)'}});const _0x49a8d6=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this['options']['heatStyle']),_0x49a8d6;}['getPointData'](_0x25db8b){const _0x162f13={_0x3afea5:0xe3},_0x3e7de9=_0x200d61,_0x5a73dc=mars3d__namespace['LngLatPoint']['parse'](_0x25db8b);if(!_0x5a73dc)return{};const _0x367800=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x5a73dc[_0x3e7de9(0xc7)],_0x5a73dc[_0x3e7de9(0xb8)]]),_0x3516f6=this['_last_mBounds'],_0x503863=Math['round']((_0x367800[0x0]-_0x3516f6['xmin'])/this[_0x3e7de9(_0x162f13._0x3afea5)]),_0x3759f4=Math['round']((_0x3516f6['ymax']-_0x367800[0x1])/this[_0x3e7de9(0xe3)]),_0xabe752=this['_heat']['getValueAt']({'x':_0x503863,'y':_0x3759f4}),_0x28f7a1=this[_0x3e7de9(0xd9)]['_renderer']['ctx']['getImageData'](_0x503863-0x1,_0x3759f4-0x1,0x1,0x1)['data'];return{'x':_0x503863,'y':_0x3759f4,'value':_0xabe752,'color':'rgba('+_0x28f7a1[0x0]+','+_0x28f7a1[0x1]+','+_0x28f7a1[0x2]+','+_0x28f7a1[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x336584){const _0x374bac={_0x18844a:0xfd},_0x521ef9=_0x200d61,_0x7e3ecd=mars3d__namespace[_0x521ef9(_0x374bac._0x18844a)]['lonlat2mercator']([_0x336584['xmin'],_0x336584[_0x521ef9(0xae)]]),_0x479839=mars3d__namespace[_0x521ef9(0xfd)]['lonlat2mercator']([_0x336584[_0x521ef9(0xc2)],_0x336584['ymax']]);return{'xmin':_0x7e3ecd[0x0],'ymin':_0x7e3ecd[0x1],'xmax':_0x479839[0x0],'ymax':_0x479839[0x1]};}function geLatLngBounds(_0xf3f50c){const _0x17c90f={_0x5b8640:0xca,_0x55110f:0xd5},_0x451907=_0x200d61,_0x1a872d=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xf3f50c[_0x451907(_0x17c90f._0x5b8640)],_0xf3f50c['ymin']]),_0x502bc0=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xf3f50c['xmax'],_0xf3f50c[_0x451907(_0x17c90f._0x55110f)]]);return{'xmin':_0x1a872d[0x0],'ymin':_0x1a872d[0x1],'xmax':_0x502bc0[0x0],'ymax':_0x502bc0[0x1]};}function getVertexShaderSource(_0x307fac){const _0x6d9490=_0x200d61;return _0x6d9490(0xb3)+_0x307fac+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
