/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.9
 * 编译日期：2023-10-17 20:06:19
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x28bc17=_0x49e8;(function(_0x105377,_0x3116e5){const _0x23c754={_0x4be9d9:0x202,_0x259318:0x218,_0x4cbf63:0x21e,_0x31d4bd:0x1db},_0x10541c=_0x49e8,_0x4af63b=_0x105377();while(!![]){try{const _0x3ac24b=parseInt(_0x10541c(0x21c))/0x1*(-parseInt(_0x10541c(0x227))/0x2)+-parseInt(_0x10541c(0x20e))/0x3+parseInt(_0x10541c(0x22c))/0x4*(parseInt(_0x10541c(_0x23c754._0x4be9d9))/0x5)+-parseInt(_0x10541c(0x1e8))/0x6+-parseInt(_0x10541c(_0x23c754._0x259318))/0x7+-parseInt(_0x10541c(_0x23c754._0x4cbf63))/0x8*(-parseInt(_0x10541c(_0x23c754._0x31d4bd))/0x9)+-parseInt(_0x10541c(0x217))/0xa*(-parseInt(_0x10541c(0x1f3))/0xb);if(_0x3ac24b===_0x3116e5)break;else _0x4af63b['push'](_0x4af63b['shift']());}catch(_0xc5a795){_0x4af63b['push'](_0x4af63b['shift']());}}}(_0x93e7,0x23f49));function _interopNamespace(_0xc7559b){const _0x4b5607={_0x452b82:0x1da,_0x208d4e:0x1f4},_0x21fa71={_0xc58867:0x231,_0x269f22:0x22a},_0x29ed6=_0x49e8;if(_0xc7559b&&_0xc7559b['__esModule'])return _0xc7559b;var _0x19989e=Object[_0x29ed6(_0x4b5607._0x452b82)](null);return _0xc7559b&&Object[_0x29ed6(_0x4b5607._0x208d4e)](_0xc7559b)['forEach'](function(_0x4a6f78){const _0x2a6b25=_0x29ed6;if(_0x4a6f78!==_0x2a6b25(_0x21fa71._0xc58867)){var _0x2b3b0c=Object['getOwnPropertyDescriptor'](_0xc7559b,_0x4a6f78);Object['defineProperty'](_0x19989e,_0x4a6f78,_0x2b3b0c[_0x2a6b25(_0x21fa71._0x269f22)]?_0x2b3b0c:{'enumerable':!![],'get':function(){return _0xc7559b[_0x4a6f78];}});}}),_0x19989e[_0x29ed6(0x231)]=_0xc7559b,_0x19989e;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x28bc17(0x1ff);function _0x49e8(_0x2988f1,_0x34f052){const _0x93e7c1=_0x93e7();return _0x49e8=function(_0x49e84d,_0x5686c8){_0x49e84d=_0x49e84d-0x1d5;let _0x119272=_0x93e7c1[_0x49e84d];return _0x119272;},_0x49e8(_0x2988f1,_0x34f052);}if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x28bc17(0x1ec),0.6:_0x28bc17(0x219),0.8:_0x28bc17(0x1f7),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance'][_0x28bc17(0x1e2)]};class HeatLayer extends BaseLayer{constructor(_0x30e03a={}){const _0x455047={_0x346c8d:0x1e3,_0x1bfd24:0x21f,_0x3433db:0x20d},_0x37a767=_0x28bc17;super(_0x30e03a),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document['body']['clientWidth'],this[_0x37a767(0x1e3)][_0x37a767(0x1f5)]=Math['min'](this['options']['maxCanvasSize'],0x1388),this['options'][_0x37a767(0x20d)]=this[_0x37a767(_0x455047._0x346c8d)]['minCanvasSize']??document[_0x37a767(_0x455047._0x1bfd24)]['clientHeight'],this['options'][_0x37a767(_0x455047._0x3433db)]=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this[_0x37a767(0x1e3)]['heatStyle']},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){const _0xc2519b={_0x4d933a:0x20c},_0x59b971=_0x28bc17;return this[_0x59b971(_0xc2519b._0x4d933a)];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x18d661){const _0x24dabb={_0x29ea1d:0x20b,_0x4f2fc0:0x20a},_0x5611b5=_0x28bc17;this['options']['heatStyle']=mars3d__namespace['Util'][_0x5611b5(_0x24dabb._0x29ea1d)](this['options']['heatStyle'],_0x18d661),this[_0x5611b5(_0x24dabb._0x4f2fc0)]&&(this['_heat']['configure'](this[_0x5611b5(0x1e3)]['heatStyle']),this[_0x5611b5(0x1e6)](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x551531){const _0x1dc79e={_0x2b8500:0x22e},_0x48c31c=_0x28bc17;this['options'][_0x48c31c(_0x1dc79e._0x2b8500)]=mars3d__namespace['Util']['merge'](this['options'][_0x48c31c(0x22e)],_0x551531);}get[_0x28bc17(0x21d)](){return this['_positions'];}set[_0x28bc17(0x21d)](_0x115017){this['setPositions'](_0x115017);}get['coordinates'](){const _0x22b0a2={_0x3280fb:0x1ed,_0x1e29e4:0x22d},_0x461479=_0x28bc17,_0x3b27e1=[];return this['points'][_0x461479(0x226)](_0x35178a=>{const _0x3e9728=_0x461479;_0x3b27e1[_0x3e9728(_0x22b0a2._0x3280fb)](_0x35178a[_0x3e9728(_0x22b0a2._0x1e29e4)]());}),_0x3b27e1;}get['rectangle'](){return this['_rectangle'];}[_0x28bc17(0x1f2)](_0x2db107,_0x518db2){const _0x388492=_0x28bc17;_0x2db107['positions']&&(this['positions']=_0x2db107[_0x388492(0x21d)]);}['_mountedHook'](){const _0xc42bd={_0x187321:0x1d5,_0x15e42c:0x1f6,_0x4d4a6e:0x20c},_0x3d880b=_0x28bc17;this[_0x3d880b(0x22e)][_0x3d880b(0x223)]===_0x3d880b(_0xc42bd._0x187321)?this['_layer']=new mars3d__namespace['layer'][(_0x3d880b(0x222))]({'crs':_0x3d880b(_0xc42bd._0x15e42c),'private':!![]}):this[_0x3d880b(_0xc42bd._0x4d4a6e)]=new mars3d__namespace['layer'][(_0x3d880b(0x208))]({'private':!![]});}[_0x28bc17(0x205)](){const _0x4f149c={_0x368bea:0x20c,_0x39c97c:0x1da,_0x1a983a:0x215,_0x403ad2:0x1e3,_0x1f4566:0x1d6},_0x47bbf4=_0x28bc17;this['_map']['addLayer'](this[_0x47bbf4(_0x4f149c._0x368bea)]),this['_container']=mars3d__namespace['DomUtil'][_0x47bbf4(_0x4f149c._0x39c97c)](_0x47bbf4(_0x4f149c._0x1a983a),'mars3d-heatmap\x20mars3d-hideDiv',this['_map'][_0x47bbf4(0x1e7)]),this['options']['positions']&&(this['positions']=this['options']['positions']),this[_0x47bbf4(_0x4f149c._0x403ad2)]['flyTo']&&this[_0x47bbf4(_0x4f149c._0x1f4566)]();}['_removedHook'](){const _0x5b0a2e={_0x4e43eb:0x1d7},_0x47dc08=_0x28bc17;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this[_0x47dc08(0x1e0)][_0x47dc08(_0x5b0a2e._0x4e43eb)](this['_layer']);}['addPosition'](_0x1eb5b4,_0x588c59){this['_positions']=this['_positions']||[],this['_positions']['push'](_0x1eb5b4),this['_updatePositionsHook'](_0x588c59);}[_0x28bc17(0x1de)](_0x5a46c6,_0x47d89c){this['_positions']=_0x5a46c6,this['_updatePositionsHook'](_0x47d89c);}['clear'](){const _0x3613bf=_0x28bc17;this['_graphic']&&(this['_layer']['removeGraphic'](this[_0x3613bf(0x1fb)],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x28bc17(0x1e6)](_0x42bba1){const _0x3d8937={_0x4c90f0:0x1ef,_0x3cf875:0x21b},_0x3c0067=_0x28bc17;if(!this[_0x3c0067(0x228)]||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x410026=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer']['setOptions']({'url':_0x410026['toDataURL']('image/png'),'rectangle':this[_0x3c0067(0x204)],'opacity':this['style']['opacity']});else this['style']['arc']?this[_0x3c0067(0x1fb)]&&_0x42bba1?(this['_graphic']['uniforms']['image']=_0x410026,this['_graphic']['uniforms'][_0x3c0067(_0x3d8937._0x4c90f0)]=this[_0x3c0067(0x1fd)](),this['_graphic2']&&(this[_0x3c0067(0x210)][_0x3c0067(_0x3d8937._0x3cf875)]['image']=_0x410026,this[_0x3c0067(0x210)][_0x3c0067(0x21b)]['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x410026):this[_0x3c0067(0x1fb)]&&_0x42bba1?this[_0x3c0067(0x1fb)]['uniforms']['image']=_0x410026:this[_0x3c0067(0x206)](_0x410026);return this;}[_0x28bc17(0x206)](_0x497bcd){const _0x413d78={_0x42e513:0x204},_0x468bd0=_0x28bc17;this['clear'](),this[_0x468bd0(0x1fb)]=new mars3d__namespace[(_0x468bd0(0x22b))]['RectanglePrimitive']({...this['options'],'rectangle':this[_0x468bd0(_0x413d78._0x42e513)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x497bcd},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x3004ee){const _0x3248ed={_0x29f2c1:0x201,_0x444cef:0x1eb,_0x548b61:0x22e,_0x44218a:0x204,_0x1e28d6:0x203,_0x152ffb:0x1fb,_0x37c441:0x225,_0x4ba07b:0x203,_0x372bc7:0x22b},_0x4dca96=_0x28bc17;this[_0x4dca96(0x220)]();const _0x3e48d5=Cesium['RenderState'][_0x4dca96(0x1dc)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction'][_0x4dca96(_0x3248ed._0x29f2c1)],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x4dca96(0x1f1)],'zPass':Cesium['StencilOperation'][_0x4dca96(_0x3248ed._0x444cef)]},'backFunction':Cesium['StencilFunction'][_0x4dca96(0x201)],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x5c6a29=Math['floor'](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this[_0x4dca96(_0x3248ed._0x548b61)]['diffHeight']&&delete this['style'][_0x4dca96(0x230)];const _0x4c488c=(this[_0x4dca96(0x22e)]['splitNum'],0x64);let _0x4afd62=Math[_0x4dca96(0x21a)](this['_rectangle']['height'],this[_0x4dca96(_0x3248ed._0x44218a)][_0x4dca96(0x1e9)]);this['style'][_0x4dca96(0x22f)]=_0x4afd62/=_0x4c488c;const _0x399917=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x3004ee,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x4dca96(0x221))](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x55e102=this['style'][_0x4dca96(_0x3248ed._0x1e28d6)]||0x1;this[_0x4dca96(_0x3248ed._0x152ffb)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x3e48d5,'material':_0x399917,'vertexShaderSource':getVertexShaderSource(_0x5c6a29*_0x55e102)})}),this['_layer'][_0x4dca96(_0x3248ed._0x37c441)](this['_graphic']),this[_0x4dca96(0x22e)][_0x4dca96(_0x3248ed._0x4ba07b)]===0x0&&(this['_graphic2']=new mars3d__namespace[(_0x4dca96(_0x3248ed._0x372bc7))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x3e48d5,'material':_0x399917,'vertexShaderSource':getVertexShaderSource(-_0x5c6a29)})}),this[_0x4dca96(0x20c)][_0x4dca96(0x225)](this['_graphic2']));}[_0x28bc17(0x207)](_0x11d2f0){const _0x2c8672=_0x28bc17;return _0x11d2f0!==null&&_0x11d2f0!==void 0x0&&_0x11d2f0['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this[_0x2c8672(0x204)];}['_getHeatCanvas'](){const _0x4d8223={_0x47a866:0x229,_0x2af607:0x1e3,_0x536fd6:0x1f9,_0x5954a8:0x200,_0x51d042:0x224,_0x22590b:0x1f0,_0x387439:0x1f9,_0x4c75b8:0x1d8,_0x4f3f26:0x1df,_0x1242f6:0x20a},_0x9a5fd6={_0x4a7355:0x1fa},_0x22062a={_0x17b45b:0x1e3,_0x1de0fe:0x1f8,_0x3b6414:0x1ee,_0x2a5522:0x21a},_0x477fac=_0x28bc17,_0x2a4053=this['_positions'],_0x232ed3=[];let _0x4d0445,_0x321ce2,_0x56876a,_0x1e5927;_0x2a4053['forEach'](_0x3bc275=>{const _0x46c137=_0x49e8,_0x1b807d=mars3d__namespace['LngLatPoint']['parse'](_0x3bc275);if(!_0x1b807d)return;_0x1b807d['value']=_0x3bc275['value']||0x1,!this[_0x46c137(_0x22062a._0x17b45b)][_0x46c137(_0x22062a._0x1de0fe)]&&(_0x4d0445===undefined?(_0x4d0445=_0x1b807d['lng'],_0x321ce2=_0x1b807d['lng'],_0x56876a=_0x1b807d['lat'],_0x1e5927=_0x1b807d['lat']):(_0x4d0445=Math[_0x46c137(_0x22062a._0x3b6414)](_0x4d0445,_0x1b807d['lng']),_0x321ce2=Math[_0x46c137(_0x22062a._0x2a5522)](_0x321ce2,_0x1b807d['lng']),_0x56876a=Math['min'](_0x56876a,_0x1b807d['lat']),_0x1e5927=Math['max'](_0x1e5927,_0x1b807d['lat']))),_0x232ed3['push'](_0x1b807d);});_0x4d0445===_0x321ce2&&(_0x4d0445-=0.000001,_0x321ce2+=0.000001);_0x56876a===_0x1e5927&&(_0x56876a-=0.000001,_0x1e5927+=0.000001);let _0x50bfb8=this['options']['rectangle']||{'xmin':_0x4d0445,'xmax':_0x321ce2,'ymin':_0x56876a,'ymax':_0x1e5927};const _0xb0b58b=getMercatorBounds(_0x50bfb8),_0x5e53de=Math['abs'](_0xb0b58b[_0x477fac(_0x4d8223._0x47a866)]-_0xb0b58b['xmin']),_0x2ea47a=Math['abs'](_0xb0b58b['ymax']-_0xb0b58b['ymin']),_0x1190e8=Math[_0x477fac(0x21a)](_0x5e53de,_0x2ea47a),_0x3f8e18=Math['min'](_0x5e53de,_0x2ea47a);this['_mBoundsMax']=_0x1190e8;let _0x226268=0x1;if(_0x1190e8>this['options']['maxCanvasSize'])_0x226268=_0x1190e8/this['options']['maxCanvasSize'],_0x3f8e18/_0x226268<this[_0x477fac(_0x4d8223._0x2af607)]['minCanvasSize']&&(_0x226268=_0x3f8e18/this['options']['minCanvasSize']);else _0x3f8e18<this['options']['minCanvasSize']&&(_0x226268=_0x3f8e18/this[_0x477fac(0x1e3)][_0x477fac(0x20d)],_0x1190e8/_0x226268>this['options']['maxCanvasSize']&&(_0x226268=_0x1190e8/this['options']['maxCanvasSize']));const _0xa70280=this[_0x477fac(0x1ea)]['radius']*1.5,_0x561ac2=_0x5e53de/_0x226268+_0xa70280*0x2,_0x2026f3=_0x2ea47a/_0x226268+_0xa70280*0x2,_0x1d1b60=_0xa70280*_0x226268;_0xb0b58b['xmin']-=_0x1d1b60,_0xb0b58b[_0x477fac(_0x4d8223._0x536fd6)]-=_0x1d1b60,_0xb0b58b['xmax']+=_0x1d1b60,_0xb0b58b['ymax']+=_0x1d1b60,this[_0x477fac(_0x4d8223._0x5954a8)]=_0x226268,_0x50bfb8=geLatLngBounds(_0xb0b58b),this['_rectangle']=Cesium['Rectangle'][_0x477fac(0x1e5)](_0x50bfb8['xmin'],_0x50bfb8[_0x477fac(0x1f9)],_0x50bfb8['xmax'],_0x50bfb8[_0x477fac(_0x4d8223._0x51d042)]);let _0x474a8a=_0x232ed3[0x0][_0x477fac(0x1f0)]??0x1,_0x586ed9=_0x232ed3[0x0][_0x477fac(_0x4d8223._0x22590b)]??0x0;const _0xe945f9=[];_0x232ed3['forEach'](_0x44fcaf=>{const _0x31d00a=_0x477fac,_0x112f2a=mars3d__namespace[_0x31d00a(0x213)]['lonlat2mercator']([_0x44fcaf['lng'],_0x44fcaf[_0x31d00a(0x1e4)]]),_0x4f75dd=_0x44fcaf['value']||0x1,_0x4e254d=Math['round']((_0x112f2a[0x0]-_0xb0b58b[_0x31d00a(_0x9a5fd6._0x4a7355)])/_0x226268),_0x271e24=Math['round']((_0xb0b58b[_0x31d00a(0x224)]-_0x112f2a[0x1])/_0x226268);_0x474a8a=Math['max'](_0x474a8a,_0x4f75dd),_0x586ed9=Math['min'](_0x586ed9,_0x4f75dd),_0xe945f9[_0x31d00a(0x1ed)]({'x':_0x4e254d,'y':_0x271e24,'value':_0x4f75dd});});const _0x2ed665={'min':this['options']['min']??_0x586ed9,'max':this['options']['max']??_0x474a8a,'data':_0xe945f9};this[_0x477fac(0x214)]=_0x2ed665;if(!this[_0x477fac(0x1d8)]||_0xb0b58b['xmin']!==this['_last_mBounds']['xmin']||_0xb0b58b['ymin']!==this['_last_mBounds'][_0x477fac(_0x4d8223._0x387439)]||_0xb0b58b[_0x477fac(0x229)]!==this[_0x477fac(0x1d8)]['xmax']||_0xb0b58b['ymax']!==this[_0x477fac(_0x4d8223._0x4c75b8)]['ymax']){this['_last_mBounds']=_0xb0b58b,this['_container']['style']['cssText']='width:'+_0x561ac2+_0x477fac(_0x4d8223._0x4f3f26)+_0x2026f3+'px;';const _0x15a68e={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x15a68e):this[_0x477fac(_0x4d8223._0x1242f6)]['configure'](_0x15a68e);}this['_heat']['setData'](_0x2ed665);const _0x525493=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat'][_0x477fac(0x1e1)][_0x477fac(0x1dd)]);return _0x525493;}['_getArcHeatCanvas'](){const _0xb24864={_0x412eb9:0x1ea,_0x1c53f2:0x216,_0x26d9e4:0x1d9,_0x1e357c:0x211,_0x5b8a1e:0x1ea},_0x30c38b=_0x28bc17;this['_heat']['configure']({'radius':this[_0x30c38b(_0xb24864._0x412eb9)]['radius']*this[_0x30c38b(0x22e)][_0x30c38b(0x1fc)],'blur':this[_0x30c38b(0x1ea)]['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:_0x30c38b(0x1fe),0.85:_0x30c38b(_0xb24864._0x1c53f2),0x1:'rgb(255,255,255)'}});const _0x5b5296=mars3d__namespace[_0x30c38b(_0xb24864._0x26d9e4)]['copyCanvas'](this['_heat']['_renderer'][_0x30c38b(0x1dd)]);return this['_heat'][_0x30c38b(_0xb24864._0x1e357c)](this['options'][_0x30c38b(_0xb24864._0x5b8a1e)]),_0x5b5296;}['getPointData'](_0x342457){const _0x18d253={_0x13f727:0x200},_0x3d7f66=_0x28bc17,_0x5060f7=mars3d__namespace['LngLatPoint']['parse'](_0x342457);if(!_0x5060f7)return{};const _0xb10593=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x5060f7['lng'],_0x5060f7['lat']]),_0x21930a=this['_last_mBounds'],_0x5c5d10=Math['round']((_0xb10593[0x0]-_0x21930a['xmin'])/this[_0x3d7f66(_0x18d253._0x13f727)]),_0x11fb78=Math['round']((_0x21930a['ymax']-_0xb10593[0x1])/this[_0x3d7f66(_0x18d253._0x13f727)]),_0x1c16ec=this['_heat']['getValueAt']({'x':_0x5c5d10,'y':_0x11fb78}),_0xe2b956=this['_heat']['_renderer']['ctx']['getImageData'](_0x5c5d10-0x1,_0x11fb78-0x1,0x1,0x1)['data'];return{'x':_0x5c5d10,'y':_0x11fb78,'value':_0x1c16ec,'color':'rgba('+_0xe2b956[0x0]+','+_0xe2b956[0x1]+','+_0xe2b956[0x2]+','+_0xe2b956[0x3]+')'};}}mars3d__namespace['LayerUtil']['register'](_0x28bc17(0x212),HeatLayer),mars3d__namespace[_0x28bc17(0x20f)]['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function _0x93e7(){const _0xb3715f=['show','xmax','get','graphic','188xDurAM','toArray','style','granularity','diffHeight','default','image','flyToByAnimationEnd','removeLayer','_last_mBounds','DomUtil','create','2088AyJcXY','fromCache','canvas','setPositions','px;height:','_map','_renderer','VERTEX_FORMAT','options','lat','fromDegrees','_updatePositionsHook','container','865494ttwlKS','width','heatStyle','REPLACE','blue','push','min','bumpMap','value','KEEP','_setOptionsHook','2563xLeHNt','keys','maxCanvasSize','EPSG:3857','yellow','rectangle','ymin','xmin','_graphic','arcRadiusScale','_getArcHeatCanvas','rgb(140,140,140)','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','_scale','ALWAYS','1955OjSbvu','arcDirection','_rectangle','_addedHook','_createGraphic','getRectangle','GraphicLayer','mercator2lonlat','_heat','merge','_layer','minCanvasSize','840060JkPKgE','layer','_graphic2','configure','heat','PointTrans','_last_heatData','div','rgb(216,216,216)','22070QHAGfC','312956YvjKZP','green','max','uniforms','4426BVRbKy','positions','5784yHIJmM','body','clear','Color','ImageLayer','type','ymax','addGraphic','forEach','38WmYDUL'];_0x93e7=function(){return _0xb3715f;};return _0x93e7();}function getMercatorBounds(_0x2f1f74){const _0x646da5=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2f1f74['xmin'],_0x2f1f74['ymin']]),_0x17f385=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2f1f74['xmax'],_0x2f1f74['ymax']]);return{'xmin':_0x646da5[0x0],'ymin':_0x646da5[0x1],'xmax':_0x17f385[0x0],'ymax':_0x17f385[0x1]};}function geLatLngBounds(_0x29720d){const _0x537385={_0x187a8d:0x213},_0x55d009=_0x28bc17,_0x8722fa=mars3d__namespace[_0x55d009(_0x537385._0x187a8d)][_0x55d009(0x209)]([_0x29720d['xmin'],_0x29720d['ymin']]),_0x2c4574=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x29720d['xmax'],_0x29720d['ymax']]);return{'xmin':_0x8722fa[0x0],'ymin':_0x8722fa[0x1],'xmax':_0x2c4574[0x0],'ymax':_0x2c4574[0x1]};}function getVertexShaderSource(_0x5fc033){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x5fc033+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
