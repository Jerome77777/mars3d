/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.11
 * 编译日期：2023-11-04 00:08:20
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x327a46=_0x3526;(function(_0x14baf1,_0x573277){const _0x292ea0={_0x2c4b0d:0x125,_0x879108:0x12f},_0x15c514=_0x3526,_0x4e1664=_0x14baf1();while(!![]){try{const _0x5b5535=parseInt(_0x15c514(0x150))/0x1*(-parseInt(_0x15c514(0x158))/0x2)+parseInt(_0x15c514(0x13b))/0x3+-parseInt(_0x15c514(0x160))/0x4*(parseInt(_0x15c514(0x145))/0x5)+parseInt(_0x15c514(0x10b))/0x6*(parseInt(_0x15c514(_0x292ea0._0x2c4b0d))/0x7)+-parseInt(_0x15c514(0x14c))/0x8*(parseInt(_0x15c514(0x14b))/0x9)+-parseInt(_0x15c514(0x121))/0xa*(parseInt(_0x15c514(_0x292ea0._0x879108))/0xb)+parseInt(_0x15c514(0x109))/0xc;if(_0x5b5535===_0x573277)break;else _0x4e1664['push'](_0x4e1664['shift']());}catch(_0x161c8c){_0x4e1664['push'](_0x4e1664['shift']());}}}(_0x3b5f,0x8d1e5));function _interopNamespace(_0x225404){const _0x578b40={_0x4cf71e:0x134,_0x1e2d6f:0x146},_0x529bf0=_0x3526;if(_0x225404&&_0x225404['__esModule'])return _0x225404;var _0x3d6810=Object['create'](null);return _0x225404&&Object[_0x529bf0(_0x578b40._0x4cf71e)](_0x225404)[_0x529bf0(_0x578b40._0x1e2d6f)](function(_0x554d3f){if(_0x554d3f!=='default'){var _0x324532=Object['getOwnPropertyDescriptor'](_0x225404,_0x554d3f);Object['defineProperty'](_0x3d6810,_0x554d3f,_0x324532['get']?_0x324532:{'enumerable':!![],'get':function(){return _0x225404[_0x554d3f];}});}}),_0x3d6810['default']=_0x225404,_0x3d6810;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x327a46(0x116);if(!h337__namespace['create'])throw new Error(_0x327a46(0x132));const Cesium=mars3d__namespace[_0x327a46(0x111)],BaseLayer=mars3d__namespace['layer'][_0x327a46(0x130)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};function _0x3b5f(){const _0x193c3e=[';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','toDataURL','Color','removeLayer','272720HMnQkY','coordinates','diffHeight','flyTo','7UoMRnH','image/png','StencilFunction','lonlat2mercator','_rectangle','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','_scale','div','positions','_last_mBounds','418wQfouu','BaseLayer','fromCache','请引入\x20heatmap.js\x20库\x20','max','keys','_updatePositionsHook','heatStyle','fromDegrees','StencilOperation','xmin','_graphic','2173728EuOcUy','_map','addPosition','width','xmax','_last_heatData','setData','KEEP','length','parse','336465AOkvmJ','forEach','granularity','Material','uniforms','_heat','348633FCFOAU','216LPjYyG','lng','body','image','2BWYtyr','_graphic2','arc','ymax','maxCanvasSize','graphic','create','EllipsoidSurfaceAppearance','901916RQmyEr','style','layer','getPointData','options','lat','PolyUtil','canvas','4UnsIrb','_createArcGraphic','_positions','setOptions','REPLACE','Util','28445556jlDJUL','clientWidth','3206556uuqbVv','_mountedHook','addGraphic','_container','h337','abs','Cesium','_getArcHeatCanvas','rgba(','_layer','copyCanvas','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','merge','_renderer','clear','push','configure','DomUtil'];_0x3b5f=function(){return _0x193c3e;};return _0x3b5f();}class HeatLayer extends BaseLayer{constructor(_0xacfa53={}){const _0x54b877={_0x837c5d:0x154,_0x27c65e:0x15c,_0x2c6abc:0x136,_0x3c1bba:0x15c},_0x1812c8=_0x327a46;super(_0xacfa53),this['options']['maxCanvasSize']=this[_0x1812c8(0x15c)]['maxCanvasSize']??document[_0x1812c8(0x14e)][_0x1812c8(0x10a)],this['options'][_0x1812c8(_0x54b877._0x837c5d)]=Math['min'](this['options']['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this[_0x1812c8(_0x54b877._0x27c65e)]['minCanvasSize']??document['body']['clientHeight'],this[_0x1812c8(0x15c)]['minCanvasSize']=Math['max'](this[_0x1812c8(0x15c)]['minCanvasSize'],0x2bc),this['options'][_0x1812c8(0x136)]={...DEF_HEATSTYLE,...this['options'][_0x1812c8(_0x54b877._0x2c6abc)]},this[_0x1812c8(_0x54b877._0x3c1bba)]['style']={...DEF_STYLE,...this['options']['style']};}get[_0x327a46(0x15a)](){const _0x178272=_0x327a46;return this[_0x178272(0x114)];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x593050){const _0xb9d776={_0xdf2c07:0x108,_0x1b8ea7:0x15c,_0x46f5a2:0x15c},_0x143491=_0x327a46;this['options'][_0x143491(0x136)]=mars3d__namespace[_0x143491(_0xb9d776._0xdf2c07)]['merge'](this[_0x143491(_0xb9d776._0x1b8ea7)][_0x143491(0x136)],_0x593050),this['_heat']&&(this['_heat']['configure'](this[_0x143491(_0xb9d776._0x46f5a2)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set[_0x327a46(0x159)](_0x25ae2b){const _0x454bb6={_0x5d1ad1:0x117,_0x5394b0:0x15c},_0x43e5f0=_0x327a46;this['options']['style']=mars3d__namespace['Util'][_0x43e5f0(_0x454bb6._0x5d1ad1)](this[_0x43e5f0(_0x454bb6._0x5394b0)]['style'],_0x25ae2b);}get['positions'](){return this['_positions'];}set[_0x327a46(0x12d)](_0x38e565){this['setPositions'](_0x38e565);}get[_0x327a46(0x122)](){const _0xb99635={_0x1595aa:0x11a},_0x541cde=[];return this['points']['forEach'](_0x1e30e1=>{const _0x2b463b=_0x3526;_0x541cde[_0x2b463b(_0xb99635._0x1595aa)](_0x1e30e1['toArray']());}),_0x541cde;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x1be140,_0x20a8c2){const _0x5e1a57=_0x327a46;_0x1be140['positions']&&(this['positions']=_0x1be140[_0x5e1a57(0x12d)]);}[_0x327a46(0x10c)](){const _0x3baff4={_0x272a12:0x14f,_0x724e60:0x114},_0x589d4a=_0x327a46;this['style']['type']===_0x589d4a(_0x3baff4._0x272a12)?this[_0x589d4a(_0x3baff4._0x724e60)]=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x38a057={_0x2bf63e:0x114,_0x5d2915:0x12c},_0x444f8c=_0x327a46;this[_0x444f8c(0x13c)]['addLayer'](this[_0x444f8c(_0x38a057._0x2bf63e)]),this['_container']=mars3d__namespace['DomUtil']['create'](_0x444f8c(_0x38a057._0x5d2915),'mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this[_0x444f8c(0x12d)]=this['options']['positions']),this['options'][_0x444f8c(0x124)]&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x48e661=_0x327a46;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this[_0x48e661(0x10e)]),delete this['_container']),this['clear'](),this[_0x48e661(0x13c)][_0x48e661(0x120)](this[_0x48e661(0x114)]);}[_0x327a46(0x13d)](_0x3a2074,_0x560f1e){const _0x867a46={_0x20d419:0x162},_0x3fc791=_0x327a46;this['_positions']=this[_0x3fc791(_0x867a46._0x20d419)]||[],this['_positions']['push'](_0x3a2074),this['_updatePositionsHook'](_0x560f1e);}['setPositions'](_0x5e38b9,_0x4dfbdd){this['_positions']=_0x5e38b9,this['_updatePositionsHook'](_0x4dfbdd);}['clear'](){const _0x5a4597={_0x33e511:0x13a},_0x1199c7=_0x327a46;this[_0x1199c7(_0x5a4597._0x33e511)]&&(this[_0x1199c7(0x114)]['removeGraphic'](this['_graphic'],!![]),delete this[_0x1199c7(0x13a)]),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x327a46(0x135)](_0x5ce874){const _0x4b6cce={_0x2db74a:0x12d,_0x3ca885:0x106,_0x4b38c6:0x126,_0x92871c:0x159,_0x48b899:0x112,_0x4e0c88:0x161,_0x5a56f7:0x13a},_0x378a23=_0x327a46;if(!this['show']||!this['_map']||!this[_0x378a23(_0x4b6cce._0x2db74a)]||this[_0x378a23(_0x4b6cce._0x2db74a)][_0x378a23(0x143)]===0x0)return this;const _0x6797b3=this['_getHeatCanvas']();if(this[_0x378a23(0x159)]['type']==='image')this['_layer'][_0x378a23(_0x4b6cce._0x3ca885)]({'url':_0x6797b3[_0x378a23(0x11e)](_0x378a23(_0x4b6cce._0x4b38c6)),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this[_0x378a23(_0x4b6cce._0x92871c)][_0x378a23(0x152)]?this['_graphic']&&_0x5ce874?(this[_0x378a23(0x13a)]['uniforms']['image']=_0x6797b3,this['_graphic']['uniforms']['bumpMap']=this[_0x378a23(_0x4b6cce._0x48b899)](),this[_0x378a23(0x151)]&&(this['_graphic2']['uniforms']['image']=_0x6797b3,this['_graphic2']['uniforms']['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this[_0x378a23(_0x4b6cce._0x4e0c88)](_0x6797b3):this[_0x378a23(_0x4b6cce._0x5a56f7)]&&_0x5ce874?this['_graphic'][_0x378a23(0x149)][_0x378a23(0x14f)]=_0x6797b3:this['_createGraphic'](_0x6797b3);return this;}['_createGraphic'](_0x19d1a8){const _0x545a11={_0xfbe47f:0x15c,_0x573755:0x129,_0x4b2966:0x148,_0x30521c:0x13a},_0x51a54f=_0x327a46;this[_0x51a54f(0x119)](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x51a54f(_0x545a11._0xfbe47f)],'rectangle':this[_0x51a54f(_0x545a11._0x573755)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x51a54f(_0x545a11._0x4b2966))]({'fabric':{'uniforms':{'image':_0x19d1a8},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this[_0x51a54f(_0x545a11._0x30521c)]);}['_createArcGraphic'](_0x2fe6a6){const _0xc79755={_0x3f80c0:0x131,_0x36d255:0x127,_0x599a53:0x138,_0x1ca796:0x159,_0x1c7f37:0x123,_0x346915:0x13e,_0x19a499:0x147,_0x22ee32:0x148,_0x10f03e:0x129,_0x428b90:0x155,_0x44a5ca:0x157},_0x584db2=_0x327a46;this['clear']();const _0x124a3e=Cesium['RenderState'][_0x584db2(_0xc79755._0x3f80c0)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x584db2(0x138)][_0x584db2(0x142)],'zPass':Cesium['StencilOperation'][_0x584db2(0x107)]},'backFunction':Cesium[_0x584db2(_0xc79755._0x36d255)]['ALWAYS'],'backOperation':{'fail':Cesium[_0x584db2(_0xc79755._0x599a53)]['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0xbcbb6a=Math['floor'](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this[_0x584db2(_0xc79755._0x1ca796)]['diffHeight']&&delete this[_0x584db2(0x159)][_0x584db2(_0xc79755._0x1c7f37)];const _0x33f880=(this['style']['splitNum'],0x64);let _0x14bc5b=Math[_0x584db2(0x133)](this['_rectangle']['height'],this['_rectangle'][_0x584db2(_0xc79755._0x346915)]);this['style'][_0x584db2(_0xc79755._0x19a499)]=_0x14bc5b/=_0x33f880;const _0x30747a=new Cesium[(_0x584db2(_0xc79755._0x22ee32))]({'fabric':{'uniforms':{'image':_0x2fe6a6,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x584db2(0x11f))](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x4c9ff8=this[_0x584db2(0x159)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace[(_0x584db2(0x155))]['RectanglePrimitive']({...this['options'],'rectangle':this[_0x584db2(_0xc79755._0x10f03e)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x124a3e,'material':_0x30747a,'vertexShaderSource':getVertexShaderSource(_0xbcbb6a*_0x4c9ff8)})}),this['_layer'][_0x584db2(0x10d)](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace[(_0x584db2(_0xc79755._0x428b90))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x584db2(_0xc79755._0x44a5ca))]({'flat':!![],'aboveGround':!![],'renderState':_0x124a3e,'material':_0x30747a,'vertexShaderSource':getVertexShaderSource(-_0xbcbb6a)})}),this['_layer']['addGraphic'](this['_graphic2']));}['getRectangle'](_0x2d37da){const _0xc37edd={_0x2839cf:0x129},_0x201ab2=_0x327a46;return _0x2d37da!==null&&_0x2d37da!==void 0x0&&_0x2d37da['isFormat']&&this[_0x201ab2(_0xc37edd._0x2839cf)]?mars3d__namespace[_0x201ab2(0x15e)]['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x41fdaf={_0x285abc:0x139,_0x3a9005:0x15c,_0x3ccbe1:0x153,_0x4fac53:0x140,_0x301889:0x139,_0x369e73:0x12e,_0x5214f6:0x14a,_0x2330aa:0x115},_0x45b0f2={_0x146613:0x15d,_0x5e8198:0x153},_0x4337c1={_0x599e48:0x14d},_0x5d7786=_0x327a46,_0xb3719e=this['_positions'],_0x5d4c20=[];let _0x534ecd,_0x1271b2,_0x1bf097,_0x33198a;_0xb3719e['forEach'](_0x4b1e82=>{const _0x1f2722=_0x3526,_0x58e706=mars3d__namespace['LngLatPoint']['parse'](_0x4b1e82);if(!_0x58e706)return;_0x58e706['value']=_0x4b1e82['value']||0x1,!this['options']['rectangle']&&(_0x534ecd===undefined?(_0x534ecd=_0x58e706['lng'],_0x1271b2=_0x58e706['lng'],_0x1bf097=_0x58e706[_0x1f2722(0x15d)],_0x33198a=_0x58e706[_0x1f2722(0x15d)]):(_0x534ecd=Math['min'](_0x534ecd,_0x58e706['lng']),_0x1271b2=Math[_0x1f2722(0x133)](_0x1271b2,_0x58e706[_0x1f2722(_0x4337c1._0x599e48)]),_0x1bf097=Math['min'](_0x1bf097,_0x58e706['lat']),_0x33198a=Math['max'](_0x33198a,_0x58e706['lat']))),_0x5d4c20[_0x1f2722(0x11a)](_0x58e706);});_0x534ecd===_0x1271b2&&(_0x534ecd-=0.000001,_0x1271b2+=0.000001);_0x1bf097===_0x33198a&&(_0x1bf097-=0.000001,_0x33198a+=0.000001);let _0x55451d=this[_0x5d7786(0x15c)]['rectangle']||{'xmin':_0x534ecd,'xmax':_0x1271b2,'ymin':_0x1bf097,'ymax':_0x33198a};const _0xd14b39=getMercatorBounds(_0x55451d),_0x22422d=Math[_0x5d7786(0x110)](_0xd14b39[_0x5d7786(0x13f)]-_0xd14b39[_0x5d7786(_0x41fdaf._0x285abc)]),_0x132f29=Math['abs'](_0xd14b39['ymax']-_0xd14b39['ymin']),_0x28f914=Math[_0x5d7786(0x133)](_0x22422d,_0x132f29),_0x59bcb5=Math['min'](_0x22422d,_0x132f29);this['_mBoundsMax']=_0x28f914;let _0x33be4e=0x1;if(_0x28f914>this['options'][_0x5d7786(0x154)])_0x33be4e=_0x28f914/this[_0x5d7786(_0x41fdaf._0x3a9005)]['maxCanvasSize'],_0x59bcb5/_0x33be4e<this['options']['minCanvasSize']&&(_0x33be4e=_0x59bcb5/this['options']['minCanvasSize']);else _0x59bcb5<this['options']['minCanvasSize']&&(_0x33be4e=_0x59bcb5/this[_0x5d7786(0x15c)]['minCanvasSize'],_0x28f914/_0x33be4e>this['options']['maxCanvasSize']&&(_0x33be4e=_0x28f914/this[_0x5d7786(0x15c)]['maxCanvasSize']));const _0x1ce3d7=this['heatStyle']['radius']*1.5,_0x508b00=_0x22422d/_0x33be4e+_0x1ce3d7*0x2,_0x40a003=_0x132f29/_0x33be4e+_0x1ce3d7*0x2,_0x2cc2c9=_0x1ce3d7*_0x33be4e;_0xd14b39['xmin']-=_0x2cc2c9,_0xd14b39['ymin']-=_0x2cc2c9,_0xd14b39[_0x5d7786(0x13f)]+=_0x2cc2c9,_0xd14b39['ymax']+=_0x2cc2c9,this[_0x5d7786(0x12b)]=_0x33be4e,_0x55451d=geLatLngBounds(_0xd14b39),this['_rectangle']=Cesium['Rectangle'][_0x5d7786(0x137)](_0x55451d[_0x5d7786(_0x41fdaf._0x285abc)],_0x55451d['ymin'],_0x55451d['xmax'],_0x55451d[_0x5d7786(_0x41fdaf._0x3ccbe1)]);let _0xbd5e88=_0x5d4c20[0x0]['value']??0x1,_0x58b309=_0x5d4c20[0x0]['value']??0x0;const _0x1f1e50=[];_0x5d4c20['forEach'](_0x551a8b=>{const _0x496394=_0x5d7786,_0x500383=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x551a8b['lng'],_0x551a8b[_0x496394(_0x45b0f2._0x146613)]]),_0x3d9e9c=_0x551a8b['value']||0x1,_0x16b66b=Math['round']((_0x500383[0x0]-_0xd14b39[_0x496394(0x139)])/_0x33be4e),_0x5d9442=Math['round']((_0xd14b39[_0x496394(_0x45b0f2._0x5e8198)]-_0x500383[0x1])/_0x33be4e);_0xbd5e88=Math['max'](_0xbd5e88,_0x3d9e9c),_0x58b309=Math['min'](_0x58b309,_0x3d9e9c),_0x1f1e50[_0x496394(0x11a)]({'x':_0x16b66b,'y':_0x5d9442,'value':_0x3d9e9c});});const _0x4a8b44={'min':this['options']['min']??_0x58b309,'max':this[_0x5d7786(0x15c)]['max']??_0xbd5e88,'data':_0x1f1e50};this[_0x5d7786(_0x41fdaf._0x4fac53)]=_0x4a8b44;if(!this[_0x5d7786(0x12e)]||_0xd14b39['xmin']!==this['_last_mBounds'][_0x5d7786(_0x41fdaf._0x301889)]||_0xd14b39['ymin']!==this['_last_mBounds']['ymin']||_0xd14b39['xmax']!==this['_last_mBounds'][_0x5d7786(0x13f)]||_0xd14b39['ymax']!==this[_0x5d7786(0x12e)]['ymax']){this[_0x5d7786(_0x41fdaf._0x369e73)]=_0xd14b39,this[_0x5d7786(0x10e)]['style']['cssText']='width:'+_0x508b00+'px;height:'+_0x40a003+'px;';const _0x1f66cc={...this['heatStyle'],'container':this[_0x5d7786(0x10e)]};!this[_0x5d7786(0x14a)]?this[_0x5d7786(_0x41fdaf._0x5214f6)]=h337__namespace[_0x5d7786(0x156)](_0x1f66cc):this['_heat']['configure'](_0x1f66cc);}this['_heat'][_0x5d7786(0x141)](_0x4a8b44);const _0x39b2e4=mars3d__namespace[_0x5d7786(0x11c)][_0x5d7786(_0x41fdaf._0x2330aa)](this[_0x5d7786(0x14a)]['_renderer']['canvas']);return _0x39b2e4;}['_getArcHeatCanvas'](){const _0x5a8ff9={_0x15d7d6:0x136,_0x2d5347:0x15f},_0x41ee82=_0x327a46;this['_heat']['configure']({'radius':this[_0x41ee82(_0x5a8ff9._0x15d7d6)]['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle']['blur']*this[_0x41ee82(0x159)]['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x16d808=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat'][_0x41ee82(0x118)][_0x41ee82(_0x5a8ff9._0x2d5347)]);return this[_0x41ee82(0x14a)][_0x41ee82(0x11b)](this[_0x41ee82(0x15c)]['heatStyle']),_0x16d808;}[_0x327a46(0x15b)](_0xd91cf2){const _0x20a92d={_0xb83d26:0x144,_0x45f172:0x12e,_0x491cec:0x12b,_0x351c2d:0x14a,_0x1d354b:0x118},_0x3cae78=_0x327a46,_0x5c5c95=mars3d__namespace['LngLatPoint'][_0x3cae78(_0x20a92d._0xb83d26)](_0xd91cf2);if(!_0x5c5c95)return{};const _0x323de3=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x5c5c95['lng'],_0x5c5c95['lat']]),_0x32b136=this[_0x3cae78(_0x20a92d._0x45f172)],_0x43aa9b=Math['round']((_0x323de3[0x0]-_0x32b136[_0x3cae78(0x139)])/this[_0x3cae78(0x12b)]),_0x4189e9=Math['round']((_0x32b136['ymax']-_0x323de3[0x1])/this[_0x3cae78(_0x20a92d._0x491cec)]),_0x5c653e=this['_heat']['getValueAt']({'x':_0x43aa9b,'y':_0x4189e9}),_0x526060=this[_0x3cae78(_0x20a92d._0x351c2d)][_0x3cae78(_0x20a92d._0x1d354b)]['ctx']['getImageData'](_0x43aa9b-0x1,_0x4189e9-0x1,0x1,0x1)['data'];return{'x':_0x43aa9b,'y':_0x4189e9,'value':_0x5c653e,'color':_0x3cae78(0x113)+_0x526060[0x0]+','+_0x526060[0x1]+','+_0x526060[0x2]+','+_0x526060[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace[_0x327a46(0x10f)]=h337__namespace;function getMercatorBounds(_0x25b68d){const _0x162fa8=_0x327a46,_0x301680=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x25b68d[_0x162fa8(0x139)],_0x25b68d['ymin']]),_0x5c8b69=mars3d__namespace['PointTrans'][_0x162fa8(0x128)]([_0x25b68d['xmax'],_0x25b68d['ymax']]);return{'xmin':_0x301680[0x0],'ymin':_0x301680[0x1],'xmax':_0x5c8b69[0x0],'ymax':_0x5c8b69[0x1]};}function geLatLngBounds(_0x4a6dae){const _0x3103c6=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4a6dae['xmin'],_0x4a6dae['ymin']]),_0xd1bfa7=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4a6dae['xmax'],_0x4a6dae['ymax']]);return{'xmin':_0x3103c6[0x0],'ymin':_0x3103c6[0x1],'xmax':_0xd1bfa7[0x0],'ymax':_0xd1bfa7[0x1]};}function _0x3526(_0x65299e,_0xd466ca){const _0x3b5fe8=_0x3b5f();return _0x3526=function(_0x35265b,_0x42cbb4){_0x35265b=_0x35265b-0x106;let _0x59dc87=_0x3b5fe8[_0x35265b];return _0x59dc87;},_0x3526(_0x65299e,_0xd466ca);}function getVertexShaderSource(_0x31545c){const _0x1deeb0={_0x37a961:0x12a,_0x3b9c17:0x11d},_0x366a03=_0x327a46;return _0x366a03(_0x1deeb0._0x37a961)+_0x31545c+_0x366a03(_0x1deeb0._0x3b9c17);}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
