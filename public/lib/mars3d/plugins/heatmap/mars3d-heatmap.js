/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.15
 * 编译日期：2023-12-05 11:26:18
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x214be1=_0x5262;(function(_0x48dcdc,_0x30ec68){const _0x35c937={_0x364479:0x1eb,_0x476f75:0x228,_0x276640:0x22e,_0x544e1a:0x201,_0x3f896e:0x21c,_0x30eabf:0x20c,_0x5e011b:0x210},_0x9c25f2=_0x5262,_0x33c884=_0x48dcdc();while(!![]){try{const _0x4702d5=-parseInt(_0x9c25f2(_0x35c937._0x364479))/0x1+-parseInt(_0x9c25f2(_0x35c937._0x476f75))/0x2*(parseInt(_0x9c25f2(_0x35c937._0x276640))/0x3)+-parseInt(_0x9c25f2(0x230))/0x4*(parseInt(_0x9c25f2(0x21b))/0x5)+parseInt(_0x9c25f2(_0x35c937._0x544e1a))/0x6*(-parseInt(_0x9c25f2(_0x35c937._0x3f896e))/0x7)+parseInt(_0x9c25f2(0x235))/0x8+-parseInt(_0x9c25f2(_0x35c937._0x30eabf))/0x9*(parseInt(_0x9c25f2(0x1ef))/0xa)+-parseInt(_0x9c25f2(_0x35c937._0x5e011b))/0xb*(-parseInt(_0x9c25f2(0x21f))/0xc);if(_0x4702d5===_0x30ec68)break;else _0x33c884['push'](_0x33c884['shift']());}catch(_0x4997f9){_0x33c884['push'](_0x33c884['shift']());}}}(_0x222e,0x7de96));function _interopNamespace(_0x30756b){const _0x5a281c={_0xbb667b:0x23d},_0x4ac40e={_0x4c9559:0x1f7},_0x3db8c4=_0x5262;if(_0x30756b&&_0x30756b['__esModule'])return _0x30756b;var _0x8314fe=Object['create'](null);return _0x30756b&&Object[_0x3db8c4(_0x5a281c._0xbb667b)](_0x30756b)[_0x3db8c4(0x223)](function(_0x3873af){const _0x5ca2c7=_0x3db8c4;if(_0x3873af!==_0x5ca2c7(0x1f5)){var _0xb1e00e=Object[_0x5ca2c7(0x211)](_0x30756b,_0x3873af);Object[_0x5ca2c7(0x1e7)](_0x8314fe,_0x3873af,_0xb1e00e[_0x5ca2c7(_0x4ac40e._0x4c9559)]?_0xb1e00e:{'enumerable':!![],'get':function(){return _0x30756b[_0x3873af];}});}}),_0x8314fe['default']=_0x30756b,_0x8314fe;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x214be1(0x240);if(!h337__namespace[_0x214be1(0x20a)])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace[_0x214be1(0x225)],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x214be1(0x23b),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x214be1(0x229)][_0x214be1(0x234)]};class HeatLayer extends BaseLayer{constructor(_0x375a81={}){const _0x3802c1={_0x162fe8:0x1f8,_0x16bdd9:0x233,_0x4da1fa:0x237,_0x16622b:0x205,_0x2e5fa3:0x242,_0x2cf4b7:0x205,_0x36b583:0x241},_0x8947ff=_0x214be1;super(_0x375a81),this['options']['maxCanvasSize']=this['options'][_0x8947ff(_0x3802c1._0x162fe8)]??document[_0x8947ff(_0x3802c1._0x16bdd9)][_0x8947ff(_0x3802c1._0x4da1fa)],this['options'][_0x8947ff(0x1f8)]=Math['min'](this[_0x8947ff(0x205)]['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this['options']['minCanvasSize']??document['body']['clientHeight'],this[_0x8947ff(_0x3802c1._0x16622b)]['minCanvasSize']=Math[_0x8947ff(0x22c)](this['options'][_0x8947ff(_0x3802c1._0x2e5fa3)],0x2bc),this[_0x8947ff(_0x3802c1._0x2cf4b7)]['heatStyle']={...DEF_HEATSTYLE,...this[_0x8947ff(_0x3802c1._0x2cf4b7)]['heatStyle']},this['options'][_0x8947ff(_0x3802c1._0x36b583)]={...DEF_STYLE,...this['options'][_0x8947ff(_0x3802c1._0x36b583)]};}get['layer'](){const _0x43deff={_0x247472:0x1ed},_0x57fa1e=_0x214be1;return this[_0x57fa1e(_0x43deff._0x247472)];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x12b697){const _0x2fc8e8=_0x214be1;this['options'][_0x2fc8e8(0x218)]=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x12b697),this['_heat']&&(this[_0x2fc8e8(0x1f9)]['configure'](this[_0x2fc8e8(0x205)]['heatStyle']),this[_0x2fc8e8(0x220)](!![]));}get['style'](){const _0x186bbb={_0xa4dc8a:0x205},_0x6aa44d=_0x214be1;return this[_0x6aa44d(_0x186bbb._0xa4dc8a)]['style'];}set['style'](_0x2b4cf5){const _0x711828={_0x2c3eee:0x23e},_0x4e907c=_0x214be1;this['options']['style']=mars3d__namespace['Util'][_0x4e907c(_0x711828._0x2c3eee)](this['options']['style'],_0x2b4cf5);}get['positions'](){return this['_positions'];}set['positions'](_0x30c1eb){this['setPositions'](_0x30c1eb);}get[_0x214be1(0x23f)](){const _0xc5d57a=[];return this['points']['forEach'](_0x249fbf=>{const _0x4af1ea=_0x5262;_0xc5d57a[_0x4af1ea(0x21a)](_0x249fbf['toArray']());}),_0xc5d57a;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x5d2b6e,_0xa642da){const _0x39a0a9=_0x214be1;_0x5d2b6e[_0x39a0a9(0x1fc)]&&(this['positions']=_0x5d2b6e['positions']);}['_mountedHook'](){const _0x3ad37d={_0x4e689d:0x241,_0x38e470:0x1f0,_0x604cf7:0x1ed},_0xa0cf60=_0x214be1;this[_0xa0cf60(_0x3ad37d._0x4e689d)]['type']==='image'?this['_layer']=new mars3d__namespace[(_0xa0cf60(_0x3ad37d._0x38e470))]['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this[_0xa0cf60(_0x3ad37d._0x604cf7)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}[_0x214be1(0x21d)](){const _0x26d252={_0x11b0e5:0x200,_0x328d6e:0x206},_0xd7b4da=_0x214be1;this[_0xd7b4da(0x232)][_0xd7b4da(0x212)](this['_layer']),this[_0xd7b4da(_0x26d252._0x11b0e5)]=mars3d__namespace[_0xd7b4da(0x224)]['create'](_0xd7b4da(_0x26d252._0x328d6e),'mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options'][_0xd7b4da(0x1fc)]&&(this['positions']=this['options']['positions']),this[_0xd7b4da(0x205)]['flyTo']&&this[_0xd7b4da(0x23c)]();}['_removedHook'](){const _0x293dfd={_0x2e7c13:0x224},_0x83f3f3=_0x214be1;this[_0x83f3f3(0x200)]&&(mars3d__namespace[_0x83f3f3(_0x293dfd._0x2e7c13)]['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map'][_0x83f3f3(0x214)](this['_layer']);}['addPosition'](_0x218010,_0x3d3eba){this['_positions']=this['_positions']||[],this['_positions']['push'](_0x218010),this['_updatePositionsHook'](_0x3d3eba);}['setPositions'](_0x255d9d,_0x4e9bad){this['_positions']=_0x255d9d,this['_updatePositionsHook'](_0x4e9bad);}['clear'](){const _0x304e9b={_0xec5131:0x1ed,_0x3799b3:0x1ee,_0x4ddb0d:0x226},_0xf1d95f=_0x214be1;this['_graphic']&&(this[_0xf1d95f(_0x304e9b._0xec5131)]['removeGraphic'](this['_graphic'],!![]),delete this[_0xf1d95f(_0x304e9b._0x3799b3)]),this[_0xf1d95f(_0x304e9b._0x4ddb0d)]&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x2ea8a1){const _0x32ef0f={_0x3d6769:0x1fc,_0x3da0bf:0x241,_0x20be11:0x215,_0x2eb411:0x22a,_0x3e3faa:0x209,_0x11afbc:0x213},_0x6a0b18=_0x214be1;if(!this['show']||!this['_map']||!this['positions']||this[_0x6a0b18(_0x32ef0f._0x3d6769)]['length']===0x0)return this;const _0x9edcb3=this['_getHeatCanvas']();if(this['style']['type']===_0x6a0b18(0x213))this['_layer'][_0x6a0b18(0x21e)]({'url':_0x9edcb3[_0x6a0b18(0x216)]('image/png'),'rectangle':this['_rectangle'],'opacity':this[_0x6a0b18(_0x32ef0f._0x3da0bf)][_0x6a0b18(_0x32ef0f._0x20be11)]});else this['style']['arc']?this['_graphic']&&_0x2ea8a1?(this[_0x6a0b18(0x1ee)]['uniforms'][_0x6a0b18(0x213)]=_0x9edcb3,this[_0x6a0b18(0x1ee)][_0x6a0b18(_0x32ef0f._0x2eb411)]['bumpMap']=this[_0x6a0b18(_0x32ef0f._0x3e3faa)](),this['_graphic2']&&(this['_graphic2']['uniforms'][_0x6a0b18(_0x32ef0f._0x11afbc)]=_0x9edcb3,this['_graphic2']['uniforms'][_0x6a0b18(0x1f2)]=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x9edcb3):this['_graphic']&&_0x2ea8a1?this['_graphic']['uniforms']['image']=_0x9edcb3:this['_createGraphic'](_0x9edcb3);return this;}[_0x214be1(0x20e)](_0x5168a0){const _0x572f9d={_0x9ed310:0x1e8,_0x53af3e:0x222},_0x25353c=_0x214be1;this[_0x25353c(_0x572f9d._0x9ed310)](),this['_graphic']=new mars3d__namespace[(_0x25353c(0x1ea))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x25353c(_0x572f9d._0x53af3e))]({'fabric':{'uniforms':{'image':_0x5168a0},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x25353c(0x1ed)]['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x5827da){const _0x5a029d={_0x59e0ef:0x1fd,_0x57d49f:0x231,_0x40ab86:0x202,_0x5a4884:0x23a,_0x5249d6:0x204,_0x381566:0x226},_0xa62dbe=_0x214be1;this['clear']();const _0x5aa98d=Cesium[_0xa62dbe(_0x5a029d._0x59e0ef)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction'][_0xa62dbe(_0x5a029d._0x57d49f)],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0xa62dbe(_0x5a029d._0x40ab86)]},'backFunction':Cesium[_0xa62dbe(0x203)]['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0xa62dbe(_0x5a029d._0x5a4884)]['KEEP'],'zPass':Cesium[_0xa62dbe(0x23a)]['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x2991bd=Math['floor'](this['style'][_0xa62dbe(0x204)]??this['_mBoundsMax']*0.02)+0.1;this['style'][_0xa62dbe(_0x5a029d._0x5249d6)]&&delete this['style'][_0xa62dbe(0x204)];const _0x148a07=(this[_0xa62dbe(0x241)]['splitNum'],0x64);let _0x2287ce=Math['max'](this['_rectangle']['height'],this[_0xa62dbe(0x1e9)]['width']);this[_0xa62dbe(0x241)]['granularity']=_0x2287ce/=_0x148a07;const _0x1f1532=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x5827da,'repeat':new Cesium[(_0xa62dbe(0x244))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0xa62dbe(0x209)]()},'source':HeatMaterial},'translucent':!![]}),_0x3f9f60=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0xa62dbe(0x205)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x5aa98d,'material':_0x1f1532,'vertexShaderSource':getVertexShaderSource(_0x2991bd*_0x3f9f60)})}),this['_layer'][_0xa62dbe(0x1e6)](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic'][(_0xa62dbe(0x1fa))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x5aa98d,'material':_0x1f1532,'vertexShaderSource':getVertexShaderSource(-_0x2991bd)})}),this['_layer']['addGraphic'](this[_0xa62dbe(_0x5a029d._0x381566)]));}[_0x214be1(0x1f6)](_0x38e19d){const _0x5d18e2={_0x31e8f6:0x1e9},_0x5108c8=_0x214be1;return _0x38e19d!==null&&_0x38e19d!==void 0x0&&_0x38e19d['isFormat']&&this[_0x5108c8(0x1e9)]?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this[_0x5108c8(_0x5d18e2._0x31e8f6)];}[_0x214be1(0x22f)](){const _0x74dfed={_0x1fb412:0x1fe,_0x846305:0x217,_0x1ea3ae:0x1f8,_0x2ab28f:0x242,_0x1f0ca7:0x205,_0x2d6ffb:0x217,_0x234cd4:0x1ff,_0x22b482:0x1f3,_0x2af6da:0x236},_0x37903e={_0x56500d:0x1fb,_0x26b741:0x22c},_0x212fda={_0x220014:0x245,_0x5d9e67:0x243,_0x47ffbb:0x22b,_0x2129eb:0x243},_0x5424a9=_0x214be1,_0x3ca956=this['_positions'],_0x4e274b=[];let _0x58e2a6,_0x1020c1,_0x27812f,_0x55dd75;_0x3ca956['forEach'](_0x5be1f7=>{const _0x4045c9=_0x5262,_0x136e53=mars3d__namespace['LngLatPoint'][_0x4045c9(_0x212fda._0x220014)](_0x5be1f7);if(!_0x136e53)return;_0x136e53[_0x4045c9(0x1f3)]=_0x5be1f7['value']||0x1,!this['options']['rectangle']&&(_0x58e2a6===undefined?(_0x58e2a6=_0x136e53[_0x4045c9(_0x212fda._0x5d9e67)],_0x1020c1=_0x136e53['lng'],_0x27812f=_0x136e53['lat'],_0x55dd75=_0x136e53[_0x4045c9(_0x212fda._0x47ffbb)]):(_0x58e2a6=Math['min'](_0x58e2a6,_0x136e53[_0x4045c9(_0x212fda._0x2129eb)]),_0x1020c1=Math[_0x4045c9(0x22c)](_0x1020c1,_0x136e53['lng']),_0x27812f=Math[_0x4045c9(0x1f1)](_0x27812f,_0x136e53[_0x4045c9(0x22b)]),_0x55dd75=Math['max'](_0x55dd75,_0x136e53['lat']))),_0x4e274b['push'](_0x136e53);});_0x58e2a6===_0x1020c1&&(_0x58e2a6-=0.000001,_0x1020c1+=0.000001);_0x27812f===_0x55dd75&&(_0x27812f-=0.000001,_0x55dd75+=0.000001);let _0x4ce65b=this['options']['rectangle']||{'xmin':_0x58e2a6,'xmax':_0x1020c1,'ymin':_0x27812f,'ymax':_0x55dd75};const _0x3619a0=getMercatorBounds(_0x4ce65b),_0x4bdf82=Math[_0x5424a9(_0x74dfed._0x1fb412)](_0x3619a0['xmax']-_0x3619a0['xmin']),_0x50ab4e=Math[_0x5424a9(0x1fe)](_0x3619a0['ymax']-_0x3619a0[_0x5424a9(_0x74dfed._0x846305)]),_0xc48add=Math['max'](_0x4bdf82,_0x50ab4e),_0x482ce5=Math['min'](_0x4bdf82,_0x50ab4e);this['_mBoundsMax']=_0xc48add;let _0x386f71=0x1;if(_0xc48add>this['options']['maxCanvasSize'])_0x386f71=_0xc48add/this['options'][_0x5424a9(_0x74dfed._0x1ea3ae)],_0x482ce5/_0x386f71<this['options'][_0x5424a9(_0x74dfed._0x2ab28f)]&&(_0x386f71=_0x482ce5/this['options'][_0x5424a9(0x242)]);else _0x482ce5<this[_0x5424a9(0x205)][_0x5424a9(0x242)]&&(_0x386f71=_0x482ce5/this['options']['minCanvasSize'],_0xc48add/_0x386f71>this[_0x5424a9(_0x74dfed._0x1f0ca7)]['maxCanvasSize']&&(_0x386f71=_0xc48add/this[_0x5424a9(0x205)]['maxCanvasSize']));const _0x4399f9=this['heatStyle']['radius']*1.5,_0x24b1e5=_0x4bdf82/_0x386f71+_0x4399f9*0x2,_0x996fcc=_0x50ab4e/_0x386f71+_0x4399f9*0x2,_0x43ca1d=_0x4399f9*_0x386f71;_0x3619a0['xmin']-=_0x43ca1d,_0x3619a0[_0x5424a9(_0x74dfed._0x2d6ffb)]-=_0x43ca1d,_0x3619a0['xmax']+=_0x43ca1d,_0x3619a0['ymax']+=_0x43ca1d,this[_0x5424a9(0x227)]=_0x386f71,_0x4ce65b=geLatLngBounds(_0x3619a0),this[_0x5424a9(0x1e9)]=Cesium['Rectangle']['fromDegrees'](_0x4ce65b[_0x5424a9(_0x74dfed._0x234cd4)],_0x4ce65b['ymin'],_0x4ce65b[_0x5424a9(0x236)],_0x4ce65b['ymax']);let _0x129a00=_0x4e274b[0x0]['value']??0x1,_0x4dbf17=_0x4e274b[0x0][_0x5424a9(_0x74dfed._0x22b482)]??0x0;const _0x28b6a7=[];_0x4e274b['forEach'](_0x4ed5ef=>{const _0x52f9e4=_0x5424a9,_0x52be74=mars3d__namespace[_0x52f9e4(_0x37903e._0x56500d)]['lonlat2mercator']([_0x4ed5ef['lng'],_0x4ed5ef[_0x52f9e4(0x22b)]]),_0x4c932b=_0x4ed5ef[_0x52f9e4(0x1f3)]||0x1,_0x12e8fd=Math['round']((_0x52be74[0x0]-_0x3619a0['xmin'])/_0x386f71),_0x14d8b2=Math['round']((_0x3619a0[_0x52f9e4(0x20f)]-_0x52be74[0x1])/_0x386f71);_0x129a00=Math[_0x52f9e4(_0x37903e._0x26b741)](_0x129a00,_0x4c932b),_0x4dbf17=Math['min'](_0x4dbf17,_0x4c932b),_0x28b6a7[_0x52f9e4(0x21a)]({'x':_0x12e8fd,'y':_0x14d8b2,'value':_0x4c932b});});const _0x294701={'min':this['options']['min']??_0x4dbf17,'max':this['options']['max']??_0x129a00,'data':_0x28b6a7};this['_last_heatData']=_0x294701;if(!this['_last_mBounds']||_0x3619a0['xmin']!==this['_last_mBounds']['xmin']||_0x3619a0['ymin']!==this['_last_mBounds']['ymin']||_0x3619a0[_0x5424a9(0x236)]!==this['_last_mBounds'][_0x5424a9(_0x74dfed._0x2af6da)]||_0x3619a0['ymax']!==this[_0x5424a9(0x22d)]['ymax']){this['_last_mBounds']=_0x3619a0,this[_0x5424a9(0x200)][_0x5424a9(0x241)]['cssText']='width:'+_0x24b1e5+'px;height:'+_0x996fcc+'px;';const _0x29d6f1={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x29d6f1):this['_heat']['configure'](_0x29d6f1);}this[_0x5424a9(0x1f9)]['setData'](_0x294701);const _0x4ad79a=mars3d__namespace['DomUtil'][_0x5424a9(0x219)](this['_heat']['_renderer']['canvas']);return _0x4ad79a;}['_getArcHeatCanvas'](){const _0xab94b0={_0x43b5ec:0x20d,_0x25c8e1:0x238,_0x3a53fd:0x218},_0x6ed3=_0x214be1;this['_heat'][_0x6ed3(0x1f4)]({'radius':this['heatStyle']['radius']*this[_0x6ed3(0x241)]['arcRadiusScale'],'blur':this['heatStyle'][_0x6ed3(_0xab94b0._0x43b5ec)]*this['style'][_0x6ed3(_0xab94b0._0x25c8e1)],'gradient':this[_0x6ed3(_0xab94b0._0x3a53fd)]['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:_0x6ed3(0x221)}});const _0x5b2556=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this['options']['heatStyle']),_0x5b2556;}[_0x214be1(0x239)](_0x242f69){const _0x550005={_0x2b2065:0x1fb,_0x423dcd:0x1e5,_0x4cde60:0x207},_0x1714cb=_0x214be1,_0xe81176=mars3d__namespace['LngLatPoint']['parse'](_0x242f69);if(!_0xe81176)return{};const _0x242ac2=mars3d__namespace[_0x1714cb(_0x550005._0x2b2065)][_0x1714cb(_0x550005._0x423dcd)]([_0xe81176['lng'],_0xe81176[_0x1714cb(0x22b)]]),_0x21da2c=this['_last_mBounds'],_0x3bac9f=Math['round']((_0x242ac2[0x0]-_0x21da2c['xmin'])/this['_scale']),_0x13fe17=Math['round']((_0x21da2c['ymax']-_0x242ac2[0x1])/this['_scale']),_0x3a1b97=this['_heat']['getValueAt']({'x':_0x3bac9f,'y':_0x13fe17}),_0x123332=this[_0x1714cb(0x1f9)]['_renderer']['ctx'][_0x1714cb(0x20b)](_0x3bac9f-0x1,_0x13fe17-0x1,0x1,0x1)['data'];return{'x':_0x3bac9f,'y':_0x13fe17,'value':_0x3a1b97,'color':_0x1714cb(_0x550005._0x4cde60)+_0x123332[0x0]+','+_0x123332[0x1]+','+_0x123332[0x2]+','+_0x123332[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function _0x5262(_0x508634,_0x31ea65){const _0x222e9=_0x222e();return _0x5262=function(_0x52629e,_0x3b3c12){_0x52629e=_0x52629e-0x1e5;let _0x293785=_0x222e9[_0x52629e];return _0x293785;},_0x5262(_0x508634,_0x31ea65);}function getMercatorBounds(_0x54b495){const _0x1f98fe={_0x34b9c2:0x1fb},_0x1172ba=_0x214be1,_0x5227f3=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x54b495['xmin'],_0x54b495['ymin']]),_0x5755a3=mars3d__namespace[_0x1172ba(_0x1f98fe._0x34b9c2)]['lonlat2mercator']([_0x54b495['xmax'],_0x54b495['ymax']]);return{'xmin':_0x5227f3[0x0],'ymin':_0x5227f3[0x1],'xmax':_0x5755a3[0x0],'ymax':_0x5755a3[0x1]};}function geLatLngBounds(_0x1cea1f){const _0x987c7e=_0x214be1,_0x418e3d=mars3d__namespace['PointTrans'][_0x987c7e(0x1ec)]([_0x1cea1f['xmin'],_0x1cea1f['ymin']]),_0x53cd89=mars3d__namespace[_0x987c7e(0x1fb)]['mercator2lonlat']([_0x1cea1f['xmax'],_0x1cea1f['ymax']]);return{'xmin':_0x418e3d[0x0],'ymin':_0x418e3d[0x1],'xmax':_0x53cd89[0x0],'ymax':_0x53cd89[0x1]};}function _0x222e(){const _0x168547=['_scale','108WFfCLt','EllipsoidSurfaceAppearance','uniforms','lat','max','_last_mBounds','23193DCeFlg','_getHeatCanvas','4KFiRDv','ALWAYS','_map','body','VERTEX_FORMAT','6114568vnEftF','xmax','clientWidth','arcBlurScale','getPointData','StencilOperation','green','flyToByAnimationEnd','keys','merge','coordinates','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','style','minCanvasSize','lng','Cartesian2','parse','lonlat2mercator','addGraphic','defineProperty','clear','_rectangle','graphic','454993TiNZIv','mercator2lonlat','_layer','_graphic','10iKZwSH','layer','min','bumpMap','value','configure','default','getRectangle','get','maxCanvasSize','_heat','RectanglePrimitive','PointTrans','positions','RenderState','abs','xmin','_container','5803962pJJQAM','REPLACE','StencilFunction','diffHeight','options','div','rgba(',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','_getArcHeatCanvas','create','getImageData','6621759HQsNGx','blur','_createGraphic','ymax','122441wykPUh','getOwnPropertyDescriptor','addLayer','image','removeLayer','opacity','toDataURL','ymin','heatStyle','copyCanvas','push','3113785xrvUlH','7ilfPFC','_addedHook','setOptions','3180xWpjZO','_updatePositionsHook','rgb(255,255,255)','Material','forEach','DomUtil','Cesium','_graphic2'];_0x222e=function(){return _0x168547;};return _0x222e();}function getVertexShaderSource(_0x24a491){const _0x5c6d5f=_0x214be1;return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x24a491+_0x5c6d5f(0x208);}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
